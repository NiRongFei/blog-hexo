<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.2.0"><link rel="apple-touch-icon" sizes="180x180" href="/blog-hexo/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/blog-hexo/images/favicon-32x32.ico"><link rel="icon" type="image/png" sizes="16x16" href="/blog-hexo/images/favicon-16x16.ico"><link rel="mask-icon" href="/blog-hexo/images/logo.svg" color="#222"><link rel="stylesheet" href="/blog-hexo/css/main.css"><link rel="stylesheet" href="/blog-hexo/lib/font-awesome/css/all.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"www.nirongfei.site",root:"/blog-hexo/",scheme:"Gemini",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:"mac"},back2top:{enable:!0,sidebar:!1,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!0,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!1,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}}}</script><meta name="description" content="知之真切笃实处即是行 行之明觉精察处即是知"><meta property="og:type" content="website"><meta property="og:title" content="阳明先生"><meta property="og:url" content="https://www.nirongfei.site/blog-hexo/index.html"><meta property="og:site_name" content="阳明先生"><meta property="og:description" content="知之真切笃实处即是行 行之明觉精察处即是知"><meta property="og:locale" content="zh_CN"><meta property="article:author" content="阳明先生"><meta property="article:tag" content="阳明先生 知行合一 知之真切笃实处即是行 行之明觉精察处即是知"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://www.nirongfei.site/blog-hexo/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!0,isPost:!1,lang:"zh-CN"}</script><title>阳明先生</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/blog-hexo/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">阳明先生</h1><span class="logo-line-after"><i></i></span></a><p class="site-subtitle" itemprop="description">知行合一</p></div><div class="site-nav-right"><div class="toggle popup-trigger"></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-home"><a href="/blog-hexo/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-tags"><a href="/blog-hexo/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/blog-hexo/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/blog-hexo/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li></ul></nav></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div><div class="reading-progress-bar"></div><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content index posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.nirongfei.site/blog-hexo/2017/09/09/frontend/170909/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/blog-hexo/images/avatar.png"><meta itemprop="name" content="阳明先生"><meta itemprop="description" content="知之真切笃实处即是行 行之明觉精察处即是知"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="阳明先生"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><span class="post-sticky-flag" title="置顶"><i class="fa fa-thumbtack"></i> </span><a href="/blog-hexo/2017/09/09/frontend/170909/" class="post-title-link" itemprop="url">算法常用方式汇总(持续更新)</a></h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2017-09-09 00:00:00" itemprop="dateCreated datePublished" datetime="2017-09-09T00:00:00+08:00">2017-09-09</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2020-11-18 15:57:04" itemprop="dateModified" datetime="2020-11-18T15:57:04+08:00">2020-11-18</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/blog-hexo/categories/%E5%89%8D%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">前端</span></a></span></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>2.6k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>2 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><h2 id="位运算"><a href="#位运算" class="headerlink" title="位运算"></a>位运算</h2><h4 id="二进制和十进制转换函数"><a href="#二进制和十进制转换函数" class="headerlink" title="二进制和十进制转换函数"></a>二进制和十进制转换函数</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">tranformBinary</span>(<span class="params">item</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> s = <span class="literal">null</span>,</span><br><span class="line">    array = <span class="literal">null</span>,</span><br><span class="line">    type = <span class="keyword">typeof</span> item,</span><br><span class="line">    symbol = !<span class="regexp">/^-/</span>.test(item + <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">  <span class="keyword">switch</span> (type) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;number&#x27;</span>:</span><br><span class="line">      s = <span class="built_in">Math</span>.abs(item).toString(<span class="number">2</span>)</span><br><span class="line">      <span class="keyword">if</span> (symbol) &#123;</span><br><span class="line">        <span class="keyword">return</span> s</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;string&#x27;</span>:</span><br><span class="line">      <span class="keyword">if</span> (symbol) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">parseInt</span>(item, <span class="number">2</span>)</span><br><span class="line">      &#125;</span><br><span class="line">      s = item.substring(<span class="number">1</span>)</span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//按位取反</span></span><br><span class="line">  array = [].map.call(s, <span class="function"><span class="keyword">function</span>(<span class="params">v</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> v ^ <span class="number">1</span></span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="comment">//+1</span></span><br><span class="line">  array.reduceRight(<span class="function"><span class="keyword">function</span>(<span class="params">previousValue, value, index, array</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> v = previousValue + value == <span class="number">2</span></span><br><span class="line">    array[index] = previousValue ^ value</span><br><span class="line">    <span class="keyword">return</span> +v</span><br><span class="line">  &#125;, <span class="number">1</span>)</span><br><span class="line">  s = array.join(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">  <span class="keyword">return</span> type == <span class="string">&#x27;number&#x27;</span> ? <span class="string">&#x27;-&#x27;</span> + s : -<span class="built_in">parseInt</span>(s, <span class="number">2</span>)</span><br><span class="line">&#125;</span><br><span class="line">tranformBinary(-<span class="number">12</span>) <span class="comment">//&quot;-0100&quot;</span></span><br><span class="line">tranformBinary(<span class="string">&#x27;-0100&#x27;</span>) <span class="comment">//-12</span></span><br></pre></td></tr></table></figure><h4 id="对非整数取整"><a href="#对非整数取整" class="headerlink" title="对非整数取整"></a>对非整数取整</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 按位与</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">5.2</span> &amp; <span class="number">5.2</span>) <span class="comment">//5</span></span><br><span class="line"><span class="built_in">console</span>.log(-<span class="number">5.2</span> &amp; -<span class="number">1</span>) <span class="comment">//-5</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.trunc(-<span class="number">5.2</span>) === (-<span class="number">5.2</span> &amp; -<span class="number">1</span>)) <span class="comment">//true</span></span><br><span class="line"><span class="comment">// 按位或</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">5.2</span> | <span class="number">0</span>) <span class="comment">//5</span></span><br><span class="line"><span class="built_in">console</span>.log(-<span class="number">5.2</span> | <span class="number">0</span>) <span class="comment">//-5</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.trunc(-<span class="number">5.2</span>) === (-<span class="number">5.2</span> | <span class="number">0</span>)) <span class="comment">//true</span></span><br><span class="line"><span class="comment">// 按位非</span></span><br><span class="line"><span class="built_in">console</span>.log(~~<span class="number">5.2</span>) <span class="comment">//5</span></span><br><span class="line"><span class="built_in">console</span>.log(~~-<span class="number">5.2</span>) <span class="comment">//-5</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.trunc(-<span class="number">5.2</span>) === ~~-<span class="number">5.2</span>) <span class="comment">//true</span></span><br></pre></td></tr></table></figure><h4 id="判断奇偶数"><a href="#判断奇偶数" class="headerlink" title="判断奇偶数"></a>判断奇偶数</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ((x &amp; <span class="number">1</span>) === <span class="number">1</span>) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;x为奇数&#x27;</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;x为偶数&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="交换两个数的值"><a href="#交换两个数的值" class="headerlink" title="交换两个数的值"></a>交换两个数的值</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">1</span>,</span><br><span class="line">  b = <span class="number">2</span></span><br><span class="line"><span class="comment">// 常规方法</span></span><br><span class="line"><span class="keyword">var</span> tmp = a</span><br><span class="line">a = b</span><br><span class="line">b = tmp</span><br><span class="line"><span class="built_in">console</span>.log(a, b) <span class="comment">//2 1</span></span><br><span class="line"><span class="comment">// 按位异或方法</span></span><br><span class="line">a = a ^ b <span class="comment">// 假设a,b的原始值分别为a0,b0</span></span><br><span class="line">b = a ^ b <span class="comment">// 等价于 b=a0^b0^b0 ==&gt; b=a0</span></span><br><span class="line">a = a ^ b <span class="comment">// 等价于 a=a0^b0^a0 ==&gt; a=b0</span></span><br><span class="line"><span class="built_in">console</span>.log(a, b) <span class="comment">//2 1</span></span><br><span class="line"><span class="comment">// 以上可简写为</span></span><br><span class="line">a ^= b</span><br><span class="line">b ^= a</span><br><span class="line">a ^= b</span><br></pre></td></tr></table></figure><h4 id="实现加法运算"><a href="#实现加法运算" class="headerlink" title="实现加法运算"></a>实现加法运算</h4><p>同位相加的运算, 完全可由按位异或(^)代替, 即: <code>x^y</code>. 按位与只有在同位都是 1 的情况下才返回 1, 其他情况均返回 0. 如果对其运算结果再做左移一位的运算, 即: <code>(x&amp;y)&lt;&lt;1</code>, 刚好满足了遇 2 进 1 的场景. 最终的加法运算结果应该还要做一次加法. 如下: <code>x + y = x^y + (x&amp;y)&lt;&lt;1</code>.</p><p>这个公式并不完美, 因为它还是使用了加法, 而绕过这个问题有一个前提, 那就是只要 <code>x^y</code> 或 <code>(x&amp;y)&lt;&lt;1</code> 中有一个值为 0 就行了, 这样便不用进行加法运算了. 讲了这么多, 不如看代码.</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">x, y</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> a = x ^ y</span><br><span class="line">  <span class="keyword">const</span> b = (x &amp; y) &lt;&lt; <span class="number">1</span></span><br><span class="line">  <span class="comment">// a=0则返回b,b=0则返回a,否则继续执行函数</span></span><br><span class="line">  <span class="keyword">return</span> (!a &amp;&amp; b) || (!b &amp;&amp; a) || <span class="built_in">arguments</span>.callee(a, b)</span><br><span class="line">&#125;</span><br><span class="line">add(<span class="number">12345678</span>, <span class="number">87654321</span>) <span class="comment">//999999999</span></span><br><span class="line">add(<span class="number">9527</span>, -<span class="number">12</span>) <span class="comment">//9515</span></span><br></pre></td></tr></table></figure><h4 id="计算绝对值"><a href="#计算绝对值" class="headerlink" title="计算绝对值"></a>计算绝对值</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">abs</span>(<span class="params">num</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 保留32二进制中的符号位,根据num的正负性分别返回0或-1</span></span><br><span class="line">  <span class="keyword">const</span> x = num &gt;&gt; <span class="number">31</span></span><br><span class="line">  <span class="comment">// 若num为正数,num^0则返回num本身;若num为负数,则相当于num^-1,此时返回-num-1</span></span><br><span class="line">  <span class="keyword">const</span> y = num ^ x</span><br><span class="line">  <span class="comment">// 若num为正数,则返回num-0即num;若num为负数则返回-num-1-(-1)即|num|</span></span><br><span class="line">  <span class="keyword">return</span> y - x</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="判断两个数符号是否相同"><a href="#判断两个数符号是否相同" class="headerlink" title="判断两个数符号是否相同"></a>判断两个数符号是否相同</h4><p>通常, 比较两个数是否符号相同, 我们使用 <code>x*y&gt;0</code> 来判断即可. 但如果利用按位异或(^), 运算速度将更快.</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log((-<span class="number">17</span> ^ <span class="number">9</span>) &gt; <span class="number">0</span>) <span class="comment">//false</span></span><br></pre></td></tr></table></figure><h4 id="对正整数-2n-取模-n-为正整数"><a href="#对正整数-2n-取模-n-为正整数" class="headerlink" title="对正整数 2n 取模(n 为正整数)"></a>对正整数 2<sup>n</sup> 取模(n 为正整数)</h4><p>比如 <code>123%8</code>, 实际上就是求一个余数, 并且这个余数还不大于 8, 最大为 7. 然后剩下的就是比较二进制值里, 123 与 7 有几成相似了. 便不难推出公式: <code>x%(1&lt;&lt;n)==x&amp;(1&lt;&lt;n)-1</code> .</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="number">123</span> % <span class="number">8</span>) <span class="comment">//3</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">123</span> &amp; ((<span class="number">1</span> &lt;&lt; <span class="number">3</span>) - <span class="number">1</span>)) <span class="comment">//3</span></span><br></pre></td></tr></table></figure><h4 id="统计正整数二进制形式中-1-的个数"><a href="#统计正整数二进制形式中-1-的个数" class="headerlink" title="统计正整数二进制形式中 1 的个数"></a>统计正整数二进制形式中 1 的个数</h4><p>先判断 n 的奇偶性, 为奇数时计数器增加 1, 然后将 n 右移一位, 重复上面步骤, 直到递归退出.</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getCountForOne</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> n ? (n &amp; <span class="number">1</span>) + <span class="built_in">arguments</span>.callee(n &gt;&gt; <span class="number">1</span>) : <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line">getCountForOne(<span class="number">9</span>) <span class="comment">//2</span></span><br></pre></td></tr></table></figure></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.nirongfei.site/blog-hexo/2017/10/01/frontend/171001/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/blog-hexo/images/avatar.png"><meta itemprop="name" content="阳明先生"><meta itemprop="description" content="知之真切笃实处即是行 行之明觉精察处即是知"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="阳明先生"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><span class="post-sticky-flag" title="置顶"><i class="fa fa-thumbtack"></i> </span><a href="/blog-hexo/2017/10/01/frontend/171001/" class="post-title-link" itemprop="url">前端开发问题汇总(持续更新)</a></h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2017-10-01 00:00:00" itemprop="dateCreated datePublished" datetime="2017-10-01T00:00:00+08:00">2017-10-01</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2020-11-18 15:57:04" itemprop="dateModified" datetime="2020-11-18T15:57:04+08:00">2020-11-18</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/blog-hexo/categories/%E5%89%8D%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">前端</span></a></span></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>2.7k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>2 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><p>:::tip<br>总结日常开发中遇到的问题和解决方法<br>:::</p><div class="post-button"><a class="btn" href="/blog-hexo/2017/10/01/frontend/171001/#more" rel="contents">阅读全文 &raquo;</a></div></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.nirongfei.site/blog-hexo/2020/01/02/frontend/200102/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/blog-hexo/images/avatar.png"><meta itemprop="name" content="阳明先生"><meta itemprop="description" content="知之真切笃实处即是行 行之明觉精察处即是知"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="阳明先生"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/blog-hexo/2020/01/02/frontend/200102/" class="post-title-link" itemprop="url">前端安全问题及应对方式</a></h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2020-01-02 00:00:00" itemprop="dateCreated datePublished" datetime="2020-01-02T00:00:00+08:00">2020-01-02</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2020-11-18 15:57:04" itemprop="dateModified" datetime="2020-11-18T15:57:04+08:00">2020-11-18</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/blog-hexo/categories/%E5%89%8D%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">前端</span></a></span></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>5.6k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>5 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><h2 id="跨站脚本攻击-XSS"><a href="#跨站脚本攻击-XSS" class="headerlink" title="跨站脚本攻击-XSS"></a>跨站脚本攻击-XSS</h2><h3 id="存储型（服务端）"><a href="#存储型（服务端）" class="headerlink" title="存储型（服务端）"></a>存储型（服务端）</h3><p>场景：见于带有用户保存数据的网站功能，如论坛发帖、商品评论、用户私信等。</p><p>攻击步骤：</p><ol><li>攻击者将恶意代码提交到目标网站的数据库中；</li><li>用户打开目标网站时，服务端将恶意代码从数据库中取出来，拼接在 HTML 中返回给浏览器；</li><li>用户浏览器在收到响应后解析执行，混在其中的恶意代码也同时被执行；</li><li>恶意代码窃取用户数据，并发送到指定攻击者的网站，或者冒充用户行为，调用目标网站的接口，执行恶意操作。</li></ol><h3 id="反射型（服务端）"><a href="#反射型（服务端）" class="headerlink" title="反射型（服务端）"></a>反射型（服务端）</h3><p>与存储型的区别在于，存储型的恶意代码存储在数据库中，反射型的恶意代码在 URL 上。</p><p>场景：通过 URL 传递参数的功能，如网站搜索、跳转等。</p><p>攻击步骤：</p><ol><li>攻击者构造出特殊的 URL，其中包含恶意代码；</li><li>用户打开带有恶意代码的 URL 时，网站服务端将恶意代码从 URL 中取出，拼接在 HTML 中返回给浏览器；</li><li>用户浏览器接收到响应后解析执行，混在其中的恶意代码也被执行；</li><li>恶意代码窃取用户数据并发送到攻击者的网站，或者冒充用户的行为，调用目标网站接口执行攻击者指定的操作。</li></ol><h3 id="DOM-型（浏览器）"><a href="#DOM-型（浏览器）" class="headerlink" title="DOM 型（浏览器）"></a>DOM 型（浏览器）</h3><p>DOM 型 XSS 攻击中，取出和执行恶意代码由浏览器端完成，属于前端 JavaScript 自身的安全漏洞，而其他两种 XSS 都属于服务端的安全漏洞。</p><p>场景：通过 URL 传递参数的功能，如网站搜索、跳转等。</p><p>攻击步骤：</p><ol><li>攻击者构造出特殊的 URL，其中包含恶意代码；</li><li>用户打开带有恶意代码的 URL；</li><li>用户浏览器接收到响应后解析执行，前端 JavaScript 取出 URL 中的恶意代码并执行；</li><li>恶意代码窃取用户数据并发送到攻击者的网站，或者冒充用户的行为，调用目标网站接口执行攻击者指定的操作。</li></ol><p>应对方案：（防止攻击者提交恶意代码，防止浏览器执行恶意代码）</p><ul><li>对数据进行严格的输出编码：如 HTML 元素的编码，JS 编码，CSS 编码，URL 编码等等</li><li>避免拼接 HTML；Vue/React 技术栈，避免使用 <code>v-html / dangerouslySetInnerHTML</code>；</li><li>CSP HTTP Header，即 <code>Content-Security-Policy</code>、<code>X-XSS-Protection</code>；<ul><li>增加攻击难度，配置 CSP(本质是建立白名单，由浏览器进行拦截)；</li><li><code>Content-Security-Policy: default-src &#39;self&#39;</code> - 所有内容均来自站点的同一个源（不包括其子域名）；</li><li><code>Content-Security-Policy: default-src &#39;self&#39; *.trusted.com</code> - 允许内容来自信任的域名及其子域名（域名不必须与 CSP 设置所在的域名相同）；</li><li><code>Content-Security-Policy: default-src https://yideng.com</code> - 该服务器仅允许通过 HTTPS 方式并仅从 <code>yideng.com</code> 域名来访问文档；</li></ul></li><li>输入验证：比如一些常见的数字、URL、电话号码、邮箱地址等等做校验判断；</li><li>开启浏览器 XSS 防御：Http Only cookie，禁止 JavaScript 读取某些敏感 Cookie，攻击者完成 XSS 注入后也无法窃取此 Cookie；</li><li>验证码。</li></ul><h2 id="跨站请求伪造-CSRF"><a href="#跨站请求伪造-CSRF" class="headerlink" title="跨站请求伪造-CSRF"></a>跨站请求伪造-CSRF</h2><p>场景：攻击者诱导受害者进入第三方网站，在第三方网站中，向被攻击网站发送跨站请求。利用受害者在被攻击网站已经获取的注册凭证，绕过后台的用户验证，达到冒充用户对被攻击的网站执行某项操作的目的。</p><p>攻击流程：</p><ol><li>受害者登录 a.com，并保留了登录凭证（Cookie）；</li><li>攻击者引诱受害者访问了 b.com；</li><li>b.com 向 a.com 发送了一个请求：a.com/act=xx 浏览器会默认携带 a.com 的 Cookie；</li><li>a.com 接收到请求后，对请求进行验证，并确认是受害者的凭证，误以为是受害者自己发送的请求；</li><li>a.com 以受害者的名义执行了 act=xx；</li><li>攻击完成，攻击者在受害者不知情的情况下，冒充受害者，让 a.com 执行了自己定义的操作。</li></ol><p>攻击类型：</p><ul><li>GET：如在页面的某个 img 中发起一个 get 请求；</li><li>POST：通过自动提交表单到恶意网站；</li><li>链接型：需要诱导用户点击链接；</li></ul><p>应对方案：</p><p>CSRF 通常从第三方网站发起，被攻击的网站无法防止攻击发生，只能通过增强自己网站针对 CSRF 的防护能力来提升安全性。</p><ul><li><p>同源检测：通过 Header 中的 Origin Header 、Referer Header 确定，但不同浏览器可能会有不一样的实现，不能完全保证</p></li><li><p>CSRF Token 校验：将 CSRF Token 输出到页面中（通常保存在 Session 中），页面提交的请求携带这个 Token，服务器验证 Token 是否正确</p></li><li><p>双重 cookie 验证：</p><ul><li><p>流程：</p><ul><li>在用户访问网站页面时，向请求域名注入一个 Cookie，内容为随机字符串（例如 csrfcookie=v8g9e4ksfhw）；</li><li>在前端向后端发起请求时，取出 Cookie，并添加到 URL 的参数中（接上例 POST <a target="_blank" rel="noopener" href="https://www.a.com/comment?csrfcookie=v8g9e4ksfhw%EF%BC%89%EF%BC%9B">https://www.a.com/comment?csrfcookie=v8g9e4ksfhw）；</a></li><li>后端接口验证 Cookie 中的字段与 URL 参数中的字段是否一致，不一致则拒绝。</li></ul></li><li><p>优点：</p><ul><li>无需使用 Session，适用面更广，易于实施；</li><li>Token 储存于客户端中，不会给服务器带来压力；</li><li>相对于 Token，实施成本更低，可以在前后端统一拦截校验，而不需要一个个接口和页面添加。</li></ul></li><li><p>缺点：</p><ul><li>Cookie 中增加了额外的字段；</li><li>如果有其他漏洞（例如 XSS），攻击者可以注入 Cookie，那么该防御方式失效，难以做到子域名的隔离；</li><li>为了确保 Cookie 传输安全，采用这种防御方式的最好确保用整站 HTTPS 的方式，如果还没切 HTTPS 的使用这种方式也会有风险。</li></ul></li></ul></li><li><p>Samesite 属性：Google 起草了一份草案来改进 HTTP 协议，那就是为 Set-Cookie 响应头新增 Samesite 属性，它用来标明这个 Cookie 是个“同站 Cookie”，同站 Cookie 只能作为第一方 Cookie，不能作为第三方 Cookie，Samesite 有两个属性值，Strict 为任何情况下都不可以作为第三方 Cookie ，Lax 为可以作为第三方 Cookie , 但必须是 Get 请求</p></li></ul><h2 id="iframe-安全"><a href="#iframe-安全" class="headerlink" title="iframe 安全"></a>iframe 安全</h2><p>场景：</p><ol><li>嵌入第三方 iframe 会有很多不可控的问题，同时当第三方 iframe 出现问题或是被劫持之后，也会诱发安全性问题；</li><li>点击劫持-攻击者将目标网站通过 iframe 嵌套的方式嵌入自己的网页中，并将 iframe 设置为透明，诱导用户点击；</li><li>禁止自己的 iframe 中的链接外部网站的 JS。</li></ol><p>应对方案：</p><ul><li>为 iframe 设置 sandbox 属性，通过它可以对 iframe 的行为进行各种限制，充分实现“最小权限“原则；</li><li>服务端设置 X-Frame-Options Header 头，拒绝页面被嵌套，X-Frame-Options 是 HTTP 响应头中用来告诉浏览器一个页面是否可以嵌入 <code>&lt;iframe&gt;&lt;/iframe&gt;</code> 中；<ul><li><code>sameorigin</code>: <code>iframe</code> 页面的地址只能为同源域名下的页面；</li><li><code>allow-from</code>: 可以嵌套在指定来源的 <code>iframe</code> 里；</li><li><code>deny</code>: 当前页面不能被嵌套在 <code>iframe</code> 里；</li></ul></li><li>设置 CSP 即 Content-Security-Policy 请求头；</li><li>减少对 iframe 的使用；</li></ul><h2 id="错误的内容推断"><a href="#错误的内容推断" class="headerlink" title="错误的内容推断"></a>错误的内容推断</h2><p>场景：文件上传类型校验失败后，导致恶意的 JS 文件上传后，浏览器 Content-Type Header 的默认解析为可执行的 JS 文件。</p><p>应对方案：设置 X-Content-Type-Options 头。</p><h2 id="第三方依赖包"><a href="#第三方依赖包" class="headerlink" title="第三方依赖包"></a>第三方依赖包</h2><p>减少对第三方依赖包的使用，如之前 npm 的包如：event-stream 被爆出恶意攻击数字货币；</p><h2 id="HTTPS"><a href="#HTTPS" class="headerlink" title="HTTPS"></a>HTTPS</h2><p>场景：黑客可以利用 SSL Stripping 这种攻击手段，强制让 HTTPS 降级回 HTTP，从而继续进行中间人攻击。</p><p>应对方案：使用 HSTS（HTTP Strict Transport Security），它通过下面这个 HTTP Header 以及一个预加载的清单，来告知浏览器和网站进行通信的时候强制性的使用 HTTPS，而不是通过明文的 HTTP 进行通信。这里的“强制性”表现为浏览器无论在何种情况下都直接向务器端发起 HTTPS 请求，而不再像以往那样从 HTTP 跳转到 HTTPS。另外，当遇到证书或者链接不安全的时候，则首先警告用户，并且不再用户选择是否继续进行不安全的通信。</p><h2 id="本地存储数据"><a href="#本地存储数据" class="headerlink" title="本地存储数据"></a>本地存储数据</h2><p>避免重要的用户信息存在浏览器缓存中。</p><h2 id="静态资源完整性校验"><a href="#静态资源完整性校验" class="headerlink" title="静态资源完整性校验"></a>静态资源完整性校验</h2><p>使用 内容分发网络 (CDNs) 在多个站点之间共享脚本和样式表等文件可以提高站点性能并节省带宽。然而，使用 CDN 也存在风险，如果攻击者获得对 CDN 的控制权，则可以将任意恶意内容注入到 CDN 上的文件中 （或完全替换掉文件），因此可能潜在地攻击所有从该 CDN 获取文件的站点。</p><p>应对方案：将使用 base64 编码过后的文件哈希值写入你所引用的 <code>&lt;script&gt;</code> 或 标签的 <code>integrity</code> 属性值中即可启用子资源完整性能。</p><h2 id="网络劫持"><a href="#网络劫持" class="headerlink" title="网络劫持"></a>网络劫持</h2><ul><li>DNS 劫持（涉嫌违法）：修改运行商的 DNS 记录，重定向到其他网站。DNS 劫持是违法的行为，目前 DNS 劫持已被监管，现在很少见 DNS 劫持</li><li>HTTP 劫持：前提有 HTTP 请求。因 HTTP 是明文传输，运营商便可借机修改 HTTP 响应内容（如加广告）。</li></ul><p>应对方案：全站 HTTPS。</p><h2 id="中间人攻击"><a href="#中间人攻击" class="headerlink" title="中间人攻击"></a>中间人攻击</h2><p>中间人攻击（Man-in-the-middle attack, MITM），指攻击者与通讯的两端分别创建独立的联系，并交换其所收到的数据，使通讯的两端认为他们正在通过一个私密的连接与对方直接对话，但事实上整个会话都被攻击者窃听、篡改甚至完全控制。没有进行严格的证书校验是中间人攻击着手点。目前大多数加密协议都提供了一些特殊认证方法以阻止中间人攻击。如 SSL （安全套接字层）协议可以验证参与通讯的用户的证书是否有权威、受信任的数字证书认证机构颁发，并且能执行双向身份认证。攻击场景如用户在一个未加密的 WiFi 下访问网站。在中间人攻击中，攻击者可以拦截通讯双方的通话并插入新的内容。</p><p>场景：</p><ol><li>在一个未加密的 Wi-Fi 无线接入点的接受范围内的中间人攻击者，可以将自己作为一个中间人插入这个网络</li><li>Fiddler / Charles （花瓶）代理工具</li><li>12306 之前的自己证书</li></ol><p>攻击步骤：</p><ol><li>客户端发送请求到服务端，请求被中间人截获；</li><li>服务器向客户端发送公钥；</li><li>中间人截获公钥，保留在自己手上。然后自己生成一个【伪造的】公钥，发给客户端；</li><li>客户端收到伪造的公钥后，生成加密 hash 值发给服务器；</li><li>中间人获得加密 hash 值，用自己的私钥解密获得真秘钥,同时生成假的加密 hash 值，发给服务器；</li><li>服务器用私钥解密获得假密钥,然后加密数据传输给客户端。</li></ol><p>使用抓包工具 fiddle 来进行举例说明：</p><ol><li>首先通过一些途径在客户端安装证书；</li><li>然后客户端发送连接请求，fiddle 在中间截取请求，并返回自己伪造的证书；</li><li>客户端已经安装了攻击者的根证书，所以验证通过；</li><li>客户端就会正常和 fiddle 进行通信，把 fiddle 当作正确的服务器；</li><li>同时 fiddle 会跟原有的服务器进行通信，获取数据以及加密的密钥，去解密密钥。</li></ol><p>常见攻击方式：</p><ul><li>嗅探：嗅探是一种用来捕获流进和流出的网络数据包的技术，就好像是监听电话一样。比如：抓包工具；</li><li>数据包注入：在这种，攻击者会将恶意数据包注入到常规数据中的，因为这些恶意数据包是在正常的数据包里面的，用户和系统都很难发现这个内容；</li><li>会话劫持：当我们进行一个网站的登录的时候到退出登录这个时候，会产生一个会话，这个会话是攻击者用来攻击的首要目标，因为这个会话，包含了用户大量的数据和私密信息；</li><li>SSL 剥离：HTTPS 是通过 SSL/TLS 进行加密过的，在 SSL 剥离攻击中，会使 SSL/TLS 连接断开，让受保护的 HTTPS，变成不受保护的 HTTP（这对于网站非常致命）；</li><li>DNS 欺骗，攻击者往往通过入侵到 DNS 服务器，或者篡改用户本地 hosts 文件，然后去劫持用户发送的请求，然后转发到攻击者想要转发到的服务器；</li><li>ARP 欺骗，ARP(address resolution protocol)地址解析协议，攻击者利用 APR 的漏洞，用当前局域网之间的一台服务器，来冒充客户端想要请求的服务端，向客户端发送自己的 MAC 地址，客户端无从得到真正的主机的 MAC 地址，所以，他会把这个地址当作真正的主机来进行通信，将 MAC 存入 ARP 缓存表；</li><li>代理服务器；</li></ul><p>应对方案：</p><ol><li>用可信的第三方 CA 厂商；</li><li>不下载未知来源的证书，不要去下载一些不安全的文件；</li><li>确认你访问的 URL 是 HTTPS 的，确保网站使用了 SSL，确保禁用一些不安全的 SSL，只开启：<code>TLS1.1</code>、<code>TLS1.2</code>；</li><li>不要使用公用网络发送一些敏感的信息；</li><li>不要去点击一些不安全的连接或者恶意链接或邮件信息；</li></ol><h2 id="SQL-注入"><a href="#SQL-注入" class="headerlink" title="SQL 注入"></a>SQL 注入</h2><p>场景：通过把 SQL 命令插入到 Web 表单递交或输入域名或页面请求的查询字符串，最终达到欺骗数据库服务器执行恶意的 SQL 命令,从而达到和服务器<br>进行直接的交互</p><p>应对方案：</p><ol><li>后台进行输入验证，对敏感字符过滤。</li><li>使用参数化查询，能避免拼接 SQL，就不要拼接 SQL 语句。</li></ol><h2 id="前端数据安全"><a href="#前端数据安全" class="headerlink" title="前端数据安全"></a>前端数据安全</h2><p>反爬虫：如猫眼电影、天眼查等等，以数据内容为核心资产的企业。</p><p>应对方案：</p><ul><li><code>font-face</code> 拼接方式：猫眼电影、天眼查</li><li><code>background</code> 拼接：美团</li><li>伪元素隐藏：汽车之家</li><li>元素定位覆盖式：去哪儿</li><li><code>iframe</code> 异步加载：网易云音乐</li></ul><h2 id="其他建议"><a href="#其他建议" class="headerlink" title="其他建议"></a>其他建议</h2><ul><li>定期请第三方机构做安全性测试，漏洞扫描；</li><li>使用第三方开源库做上线前的安全测试，可以考虑融合到 CI 中；</li><li>code review 保证代码质量；</li><li>默认项目中设置对应的 Header 请求头，如 <code>X-XSS-Protection</code>、 <code>X-Content-Type-Options</code> 、<code>X-Frame-Options</code>、<code>Content-Security-Policy</code> 等；</li><li>对第三方包和库做检测：NSP，Snyk；</li></ul></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.nirongfei.site/blog-hexo/2019/03/02/others/190302/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/blog-hexo/images/avatar.png"><meta itemprop="name" content="阳明先生"><meta itemprop="description" content="知之真切笃实处即是行 行之明觉精察处即是知"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="阳明先生"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/blog-hexo/2019/03/02/others/190302/" class="post-title-link" itemprop="url">百度网盘限速解决办法</a></h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2019-03-02 00:00:00" itemprop="dateCreated datePublished" datetime="2019-03-02T00:00:00+08:00">2019-03-02</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2020-11-18 15:57:12" itemprop="dateModified" datetime="2020-11-18T15:57:12+08:00">2020-11-18</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/blog-hexo/categories/%E5%85%B6%E5%AE%83/" itemprop="url" rel="index"><span itemprop="name">其它</span></a></span></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>1.4k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>1 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><h2 id="百度网盘下载助手脚本"><a href="#百度网盘下载助手脚本" class="headerlink" title="百度网盘下载助手脚本"></a>百度网盘下载助手脚本</h2><p>通过浏览器拓展 <a target="_blank" rel="noopener" href="https://www.runningcheese.com/go?url=https://violentmonkey.github.io/get-it/">Violentmonkey</a> 或者 <a target="_blank" rel="noopener" href="https://www.runningcheese.com/go?url=https://tampermonkey.net/">Tampermonkey</a> 来安装 <a target="_blank" rel="noopener" href="https://www.runningcheese.com/go?url=https://greasyfork.org/zh-CN/scripts/39504">百度下载助手脚本</a>，使其显示直链的方法来加速下载。</p><p>方法是在百度网盘点击下载页面里的 <strong>下载助手-&gt;显示链接</strong> 来获取真实的下载地址，支持在「管理页面」和「分享页面」上使用。</p><p>但是，复制链接的方法比较麻烦，有时候也无法使用，因为需要传递浏览器 cookies，所以需要通过浏览器来调用 IDM 或者迅雷。你可以使用已经集成好脚本和下载器的定制浏览器来一键下载：</p><ul><li><p>Chrome 定制版浏览器：<a target="_blank" rel="noopener" href="https://www.lanzous.com/b851998">https://www.lanzous.com/b851998</a></p></li><li><p>Firefox 定制版浏览器：<a target="_blank" rel="noopener" href="https://www.lanzous.com/b851982">https://www.lanzous.com/b851982</a></p></li></ul><p>使用方法简单来说，分为两步：</p><ol><li><p>下载上面定制版的 Firefox 或 Chrome 浏览器。</p></li><li><p>下载安装版 IDM 下载器。</p></li></ol><p>具体来说：</p><ol><li><p>下载并解压安装包，32 位是带有 32bit 压缩包，64 位是什么都没有的。</p></li><li><p>Firefox 浏览器点击「开始.bat」后，点击「firefox.exe」；Chrome 浏览器点击「chrome.exe」。</p></li><li><p>下载安装「安装版 IDM」，安装成功后，浏览器会自动调用 IDM。</p></li><li><p>在网页端「管理页面」上使用时，选中文件后，点击 <strong>下载助手-&gt;API 下载-&gt;显示链接</strong>，然后在菜单右键上选择 <strong>使用 IDM 下载</strong>。如下图：</p></li></ol><p><img src="https://tva1.sinaimg.cn/large/7a6a15d5gy1g275416p6sg20tk0hfk0z.gif"></p><p>5、在网页端「分享页面」上使用时，选中文件后，点击 <strong>下载助手-&gt;高速下载</strong>，在弹出的新网页里下载。</p><p><img src="https://tva1.sinaimg.cn/large/7a6a15d5gy1g58y9opttcg20uw0gy7c4.gif"></p><p>6、支持「文件夹和多选文件」下载，但总大小不可超过 300Mb，超过会出错无法下载。</p><p>方法是点击 <strong>生成链接-&gt;压缩包</strong>，然后在菜单右键上选择 <strong>使用 IDM 下载</strong>。如下图：</p><p><img src="https://tva1.sinaimg.cn/large/7a6a15d5gy1g275a94bjxg20tk0hftkt.gif"></p><p>注意事项：</p><ul><li><p>如果浏览器无法运行，则尝试使用管理员身份运行。</p></li><li><p>务必要等到 IDM 获取到文件名和文件大小后，再点击开始下载，否则会出现 HTTP 404 错误。</p></li><li><p>如果出现 HTTP 403 错误，把下载链接 <a target="_blank" rel="noopener" href="https://qdall01.baidupcs.com/">https://qdall01.baidupcs.com</a> 中 的 https 换成 http 即可。</p></li><li><p>如何测试自己有没有被拉黑？试试在分享页面下载单个文件（大于 20MB），观察看看下载速度如何。</p></li><li><p>需要在 IDM 的选项中，将下载线程设置为 32，IDM 的使用技巧：<a target="_blank" rel="noopener" href="https://www.runningcheese.com/idm">https://www.runningcheese.com/idm</a>。</p></li></ul><h2 id="PanDownload"><a href="#PanDownload" class="headerlink" title="PanDownload"></a>PanDownload</h2><p>这是一个 C# 语言下载工具，工作原理和方法 5 类似，登陆自己的账号选择文件下载即可，这对于不会使用脚本的人来说非常的方便。最近又更新了 <a target="_blank" rel="noopener" href="https://www.runningcheese.com/go?url=https://www.baiduwp.com">网页版</a>，可以无需帐号登录也可以下载，避免了拉黑的风险，虽然有每天下载 6 次的限制。</p><p>使用方法：你也可以使用博主定制的浏览器来实现一键下载。</p><p><img src="https://tva1.sinaimg.cn/large/7a6a15d5gy1g58y9opttcg20uw0gy7c4.gif"></p><h2 id="Proxyee-down"><a href="#Proxyee-down" class="headerlink" title="Proxyee down"></a>Proxyee down</h2><p><a target="_blank" rel="noopener" href="https://www.runningcheese.com/go?url=https://github.com/proxyee-down-org/proxyee-down">Proxyee down</a> 使用本地 http 代理服务器方式嗅探下载请求，支持所有操作系统和大部分主流浏览器,支持分段下载和断点下载。使用教程：<a target="_blank" rel="noopener" href="https://www.runningcheese.com/go?url=https://github.com/proxyee-down-org/proxyee-down/wiki/%E8%BD%AF%E4%BB%B6%E4%B8%8B%E8%BD%BD%E4%B8%8E%E8%BF%90%E8%A1%8C">看这里</a>。</p><p><img src="https://tva1.sinaimg.cn/large/7a6a15d5gy1ftl7pzoy21j20l206j0sy.jpg"></p><p>下载地址：<a target="_blank" rel="noopener" href="https://github.com/proxyee-down-org/proxyee-down/releases">https://github.com/proxyee-down-org/proxyee-down/releases</a></p><p>使用介绍：<a target="_blank" rel="noopener" href="https://blog.csdn.net/u011054333/article/details/86427329">https://blog.csdn.net/u011054333/article/details/86427329</a></p><h2 id="ENFI"><a href="#ENFI" class="headerlink" title="ENFI"></a>ENFI</h2><p>这个工具可以直接去官网下载 <a target="_blank" rel="noopener" href="http://enfi.cloud/">enfi.cloud</a>，注册账号后会送 3 个 G 的下载流量，流量用完后需要充值才能继续使用。</p><p><img src="https://user-gold-cdn.xitu.io/2019/5/28/16afdafc4d9926b7?imageView2/0/w/1280/h/960/format/webp/ignore-error/1"></p><blockquote><p>PS：参考文章 <a target="_blank" rel="noopener" href="https://www.runningcheese.com/baiduyun">https://www.runningcheese.com/baiduyun</a>，如有侵权请联系我删除文章。</p></blockquote></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.nirongfei.site/blog-hexo/2019/02/15/frontend/190215/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/blog-hexo/images/avatar.png"><meta itemprop="name" content="阳明先生"><meta itemprop="description" content="知之真切笃实处即是行 行之明觉精察处即是知"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="阳明先生"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/blog-hexo/2019/02/15/frontend/190215/" class="post-title-link" itemprop="url">Vue-cli3项目搭建优化</a></h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2019-02-15 00:00:00" itemprop="dateCreated datePublished" datetime="2019-02-15T00:00:00+08:00">2019-02-15</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2020-11-18 15:57:04" itemprop="dateModified" datetime="2020-11-18T15:57:04+08:00">2020-11-18</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/blog-hexo/categories/%E5%89%8D%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">前端</span></a></span></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>9.2k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>8 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><h2 id="自动注册组件"><a href="#自动注册组件" class="headerlink" title="自动注册组件"></a>自动注册组件</h2><p>在 <code>components</code> 中创建 <code>index.js</code>，用来扫描全局组件对象并自动注册：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 自动加载 global 目录下的 .js 结尾的文件</span></span><br><span class="line"><span class="keyword">const</span> componentsContext = <span class="built_in">require</span>.context(<span class="string">&#x27;./global&#x27;</span>, <span class="literal">true</span>, <span class="regexp">/\.js$/</span>)</span><br><span class="line"></span><br><span class="line">componentsContext.keys().forEach(<span class="function"><span class="params">component</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> componentConfig = componentsContext(component)</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 兼容 import export 和 require module.export 两种规范</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">const</span> ctrl = componentConfig.default || componentConfig</span><br><span class="line">  Vue.component(ctrl.name, ctrl)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>最后在 <code>main.js</code> 中引入 <code>import &#39;@/components&#39;</code> 即可。</p><h2 id="自动导入路由"><a href="#自动导入路由" class="headerlink" title="自动导入路由"></a>自动导入路由</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> Router <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span><br><span class="line"></span><br><span class="line">Vue.use(Router)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> routes = []</span><br><span class="line">cosnt routeContext = <span class="built_in">require</span>.context(<span class="string">&#x27;./&#x27;</span>, <span class="literal">true</span>, <span class="regexp">/index\.js$/</span>)</span><br><span class="line">routeContext.keys().forEach(<span class="function"><span class="params">route</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (route.startsWith(<span class="string">&#x27;./index&#x27;</span>)) <span class="keyword">return</span></span><br><span class="line">  <span class="keyword">const</span> routeModule = routeContext(route)</span><br><span class="line">  routes = [...routes, ...(routeModule.default || routeModule)]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> Router(&#123;</span><br><span class="line">  mode: <span class="string">&#x27;history&#x27;</span>,</span><br><span class="line">  base: process.env.BASE_URL,</span><br><span class="line">  routes: routes</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="配置路由权限"><a href="#配置路由权限" class="headerlink" title="配置路由权限"></a>配置路由权限</h2><p><code>vue-router</code> 提供了非常方便的钩子，可以让我们在做路由跳转的时候进行统一操作，比如常见的权限验证。</p><p>首先，需要在 <code>src/utils</code> 下创建 <code>auth.js</code>，用于存储 <code>token</code>：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Cookies <span class="keyword">from</span> <span class="string">&#x27;js-cookie&#x27;</span></span><br><span class="line"><span class="keyword">const</span> TokenKey = <span class="string">&#x27;project-token&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">getToken</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> Cookies.get(TokenKey)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">setToken</span>(<span class="params">token</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> Cookies.set(TokenKey, token)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">removeToken</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> Cookies.remove(TokenKey)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在 <code>src/utils</code> 下创建 <code>permission.js</code>：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;@/store&#x27;</span></span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&#x27;@/router&#x27;</span></span><br><span class="line"><span class="keyword">import</span> NProgress <span class="keyword">from</span> <span class="string">&#x27;nprogress&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;nprogress/nprogress.css&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; getToken &#125; <span class="keyword">from</span> <span class="string">&#x27;./auth&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; Message &#125; <span class="keyword">from</span> <span class="string">&#x27;element-ui&#x27;</span></span><br><span class="line"><span class="comment">// 路由白名单</span></span><br><span class="line"><span class="keyword">const</span> whiteList = [<span class="string">&#x27;/login&#x27;</span>]</span><br><span class="line">router.beforeEach(<span class="function">(<span class="params">to, <span class="keyword">from</span>, next</span>) =&gt;</span> &#123;</span><br><span class="line">  NProgress.start()</span><br><span class="line">  <span class="keyword">if</span> (getToken()) &#123;</span><br><span class="line">    <span class="keyword">if</span> (to.path === <span class="string">&#x27;/login&#x27;</span>) &#123;</span><br><span class="line">      next(&#123;</span><br><span class="line">        path: <span class="string">&#x27;/&#x27;</span></span><br><span class="line">      &#125;)</span><br><span class="line">      NProgress.done()</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// 实时拉取用户的信息</span></span><br><span class="line">      store</span><br><span class="line">        .dispatch(<span class="string">&#x27;GetUserInfo&#x27;</span>)</span><br><span class="line">        .then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">          next()</span><br><span class="line">        &#125;)</span><br><span class="line">        .catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">          store.dispatch(<span class="string">&#x27;FedLogOut&#x27;</span>).then(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            Message.error(<span class="string">&#x27;拉取用户信息失败，请重新登录！&#x27;</span> + err)</span><br><span class="line">            next(&#123;</span><br><span class="line">              path: <span class="string">&#x27;/&#x27;</span></span><br><span class="line">            &#125;)</span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (whiteList.includes(to.path)) &#123;</span><br><span class="line">      next()</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      next(<span class="string">&#x27;/login&#x27;</span>)</span><br><span class="line">      NProgress.done()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">router.afterEach(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  NProgress.done()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="封装-Axios"><a href="#封装-Axios" class="headerlink" title="封装 Axios"></a>封装 Axios</h2><p>在 <code>src</code> 目录下创建 <code>utils</code>， 并创建 <code>axios.js</code> 用来封装 <code>axios</code>：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> service = axios.create(&#123;</span><br><span class="line">  baseURL: process.env.BASE_URL,</span><br><span class="line">  timeout: <span class="number">10000</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// request 拦截器</span></span><br><span class="line">service.interceptors.request.use(</span><br><span class="line">  config =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> token = <span class="built_in">localStorage</span>.getItem(<span class="string">&#x27;token&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> (token) &#123;</span><br><span class="line">      config.headers[<span class="string">&#x27;Authorization&#x27;</span>] = token</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> config</span><br><span class="line">  &#125;,</span><br><span class="line">  error =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error)</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br><span class="line"><span class="comment">// response 拦截器</span></span><br><span class="line">service.interceptors.response.use(</span><br><span class="line">  response =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> status = response.status</span><br><span class="line">    <span class="keyword">if</span> (status === <span class="number">200</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">Promise</span>.resolve(response.data)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(<span class="string">&#x27;error&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  error =&gt; &#123;</span><br><span class="line">    <span class="comment">// 断网或请求超时</span></span><br><span class="line">    <span class="keyword">if</span> (!error.response) &#123;</span><br><span class="line">      <span class="keyword">if</span> (error.message.includes(<span class="string">&#x27;timeout&#x27;</span>)) &#123;</span><br><span class="line">        Message.error(<span class="string">&#x27;请求超时，请检查网络是否连接正常&#x27;</span>)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        Message.error(<span class="string">&#x27;请求失败，请检查网络是否已连接&#x27;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> status = error.response.status</span><br><span class="line">    <span class="keyword">switch</span> (status) &#123;</span><br><span class="line">      <span class="comment">// 未登录</span></span><br><span class="line">      <span class="keyword">case</span> <span class="number">401</span>:</span><br><span class="line">        router.replace(&#123;</span><br><span class="line">          path: <span class="string">&#x27;/login&#x27;</span>,</span><br><span class="line">          query: &#123;</span><br><span class="line">            redirect: router.currentRoute.fullPath</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">      <span class="comment">// 登录过期</span></span><br><span class="line">      <span class="keyword">case</span> <span class="number">403</span>:</span><br><span class="line">        Message(&#123;</span><br><span class="line">          type: <span class="string">&#x27;error&#x27;</span>,</span><br><span class="line">          message: <span class="string">&#x27;登录信息过期，请重新登录&#x27;</span></span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        <span class="built_in">localStorage</span>.removeItem(<span class="string">&#x27;token&#x27;</span>)</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">          router.replace(&#123;</span><br><span class="line">            path: <span class="string">&#x27;/login&#x27;</span>,</span><br><span class="line">            query: &#123;</span><br><span class="line">              redirect: router.currentRoute.fullPath</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;, <span class="number">1000</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">      <span class="comment">// 请求错误</span></span><br><span class="line">      <span class="keyword">case</span> <span class="number">404</span>:</span><br><span class="line">        Message(&#123;</span><br><span class="line">          message: <span class="string">&#x27;网络请求错误&#x27;</span>,</span><br><span class="line">          type: <span class="string">&#x27;error&#x27;</span></span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        Message(&#123;</span><br><span class="line">          message: error.response.data.message,</span><br><span class="line">          type: <span class="string">&#x27;error&#x27;</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error)</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> service</span><br></pre></td></tr></table></figure><p>既然要使用 <code>axios</code> ，必不可少的需要配置环境变量以及需要请求的地址，这里可以简单的修改 <code>poackage.json</code>：</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">    &quot;dev&quot;: &quot;vue-cli-service serve --project-mode dev&quot;,</span><br><span class="line">    &quot;test&quot;: &quot;vue-cli-service serve --project-mode test&quot;,</span><br><span class="line">    &quot;pro&quot;: &quot;vue-cli-service serve --project-mode pro&quot;,</span><br><span class="line">    &quot;pre&quot;: &quot;vue-cli-service serve --project-mode pre&quot;,</span><br><span class="line">    &quot;build:dev&quot;: &quot;vue-cli-service build --project-mode dev&quot;,</span><br><span class="line">    &quot;build:test&quot;: &quot;vue-cli-service build --project-mode test&quot;,</span><br><span class="line">    &quot;build:pro&quot;: &quot;vue-cli-service build --project-mode pro&quot;,</span><br><span class="line">    &quot;build:pre&quot;: &quot;vue-cli-service build --project-mode pre&quot;,</span><br><span class="line">    &quot;build&quot;: &quot;vue-cli-service build&quot;,</span><br><span class="line">    &quot;lint&quot;: &quot;vue-cli-service lint&quot;</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure><p>同时修改 <code>vue.config.js</code>：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">resolve</span>(<span class="params">dir</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> path.join(__dirname, <span class="string">&#x27;./&#x27;</span>, dir)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  chainWebpack: <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 配置BASE_API</span></span><br><span class="line">    config.plugin(<span class="string">&#x27;define&#x27;</span>).tap(<span class="function"><span class="params">args</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> argv = process.argv</span><br><span class="line">      <span class="keyword">const</span> mode = argv[argv.indexOf(<span class="string">&#x27;--project-mode&#x27;</span>) + <span class="number">1</span>]</span><br><span class="line">      args[<span class="number">0</span>][<span class="string">&#x27;process.env&#x27;</span>].MODE = <span class="string">`&quot;<span class="subst">$&#123;mode&#125;</span>&quot;`</span></span><br><span class="line">      args[<span class="number">0</span>][<span class="string">&#x27;process.env&#x27;</span>].BASE_URL = <span class="string">&#x27;http://192.168.1.187:8080&#x27;</span></span><br><span class="line">      <span class="comment">// args[0][&#x27;process.env&#x27;].BASE_URL = JSON.stringify(process.env.BASE_URL)</span></span><br><span class="line">      <span class="keyword">return</span> args</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这样的好处是方便管理、后期维护，还可以和后端的微服务对应，建立多文件存放不同模块的 <code>api</code>，剩下的就是你使用到哪个 <code>api</code> 时，自己引入便可。</p><h2 id="全局引用-SVG"><a href="#全局引用-SVG" class="headerlink" title="全局引用 SVG"></a>全局引用 SVG</h2><p>首先在 <code>src/components</code> 下创建 <code>SvgIcon.vue</code>：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;svg :<span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;svgClass&quot;</span> aria-hidden=<span class="string">&quot;true&quot;</span>&gt;</span><br><span class="line">    &lt;use :xlink:href=<span class="string">&quot;iconName&quot;</span>&gt;&lt;/use&gt;</span><br><span class="line">  &lt;/svg&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=<span class="string">&quot;ts&quot;</span>&gt;</span><br><span class="line"><span class="keyword">import</span> &#123; Component, Vue, Prop &#125; <span class="keyword">from</span> <span class="string">&#x27;vue-property-decorator&#x27;</span></span><br><span class="line"></span><br><span class="line">@Component(&#123;</span><br><span class="line">  name: <span class="string">&#x27;SvgIcon&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="keyword">extends</span> <span class="title">Vue</span> </span>&#123;</span><br><span class="line">  @Prop(&#123; <span class="attr">required</span>: <span class="literal">true</span> &#125;) private icon!: string</span><br><span class="line">  @Prop(&#123; <span class="attr">default</span>: <span class="string">&#x27;&#x27;</span> &#125;) private className!: string</span><br><span class="line"></span><br><span class="line">  <span class="keyword">get</span> <span class="title">iconName</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`#icon-<span class="subst">$&#123;<span class="built_in">this</span>.icon&#125;</span>`</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">get</span> <span class="title">svgClass</span>() &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.className) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&#x27;svg-icon &#x27;</span> + <span class="built_in">this</span>.className</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&#x27;svg-icon&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=<span class="string">&quot;scss&quot;</span> scoped&gt;</span><br><span class="line">.svg-icon &#123;</span><br><span class="line">  overflow: hidden;</span><br><span class="line">  fill: currentColor;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><p>在 <code>src</code> 下创建 <code>icons</code> 文件夹，并在内部创建 <code>svg</code> 文件夹用于存放 <code>svg</code> 图标，创建 <code>index.js</code> 作为入口文件：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> SvgIcon <span class="keyword">from</span> <span class="string">&#x27;@/components/SvgIcon.vue&#x27;</span></span><br><span class="line"></span><br><span class="line">Vue.component(<span class="string">&#x27;svg-icon&#x27;</span>, SvgIcon)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> svgContext = <span class="built_in">require</span>.context(<span class="string">&#x27;./svg&#x27;</span>, <span class="literal">false</span>, <span class="regexp">/\.svg$/</span>)</span><br><span class="line"><span class="keyword">const</span> svgIcon = <span class="function"><span class="params">context</span> =&gt;</span> context.keys().map(context)</span><br><span class="line">svgIcon(svgContext)</span><br></pre></td></tr></table></figure><p>通过 <code>svg-sprite-loader</code> 对项目中使用的 <code>svg</code> 进行处理：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">resolve</span>(<span class="params">dir</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> path.join(__dirname, <span class="string">&#x27;./&#x27;</span>, dir)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  chainWebpack: <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 配置SVG</span></span><br><span class="line">    config.module</span><br><span class="line">      .rule(<span class="string">&#x27;svg&#x27;</span>)</span><br><span class="line">      .exclude.add(resolve(<span class="string">&#x27;src/icons&#x27;</span>))</span><br><span class="line">      .end()</span><br><span class="line">    config.module</span><br><span class="line">      .rule(<span class="string">&#x27;icons&#x27;</span>)</span><br><span class="line">      .test(<span class="regexp">/\.svg$/</span>)</span><br><span class="line">      .include.add(resolve(<span class="string">&#x27;src/icons&#x27;</span>))</span><br><span class="line">      .end()</span><br><span class="line">      .use(<span class="string">&#x27;svg-sprite-loader&#x27;</span>)</span><br><span class="line">      .loader(<span class="string">&#x27;svg-sprite-loader&#x27;</span>)</span><br><span class="line">      .options(&#123;</span><br><span class="line">        symbolId: <span class="string">&#x27;icon-[name]&#x27;</span></span><br><span class="line">      &#125;)</span><br><span class="line">      .end()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>最后在 <code>main.js</code> 中引入 <code>import &#39;@/icons&#39;</code> 即可。</p><h2 id="全局-Loading-效果"><a href="#全局-Loading-效果" class="headerlink" title="全局 Loading 效果"></a>全局 Loading 效果</h2><p>平时写网络请求之前一般都需要开启 <code>loading</code> 效果，成功之后结束 <code>loading</code> 效果，这就会产生大量重复代码，我们可以结合 <code>axios</code> 和 <code>vuex</code> 统一处理。</p><p>首先，在 <code>store/modules/app.js</code> 里写 <code>loading</code> 效果：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> app = &#123;</span><br><span class="line">  state: &#123;</span><br><span class="line">    requestLoading: <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  mutations: &#123;</span><br><span class="line">    SET_LOADING: <span class="function">(<span class="params">state, status</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (status === <span class="number">0</span>) &#123;</span><br><span class="line">        state.requestLoading = <span class="number">0</span></span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">      &#125;</span><br><span class="line">      state.requestLoading = status ? ++state.requestLoading : --state.requestLoading</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  actions: &#123;</span><br><span class="line">    <span class="function"><span class="title">SetLoading</span>(<span class="params">&#123; commit &#125;, status</span>)</span> &#123;</span><br><span class="line">      commit(<span class="string">&#x27;SET_LOADING&#x27;</span>, status)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> app</span><br></pre></td></tr></table></figure><p>再来修改一下 <code>utils/axios.js</code>：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;@/store&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> service = axios.create(&#123;</span><br><span class="line">  baseURL: process.env.BASE_URL,</span><br><span class="line">  timeout: <span class="number">10000</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// request拦截器</span></span><br><span class="line">service.interceptors.request.use(</span><br><span class="line">  config =&gt; &#123;</span><br><span class="line">    store.dispatch(<span class="string">&#x27;SetLoading&#x27;</span>, <span class="literal">true</span>)</span><br><span class="line">    <span class="keyword">return</span> config</span><br><span class="line">  &#125;,</span><br><span class="line">  error =&gt; &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      store.dispatch(<span class="string">&#x27;SetLoading&#x27;</span>, <span class="number">0</span>)</span><br><span class="line">    &#125;, <span class="number">500</span>)</span><br><span class="line">    <span class="built_in">Promise</span>.reject(error)</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br><span class="line"><span class="comment">// response拦截器</span></span><br><span class="line">service.interceptors.response.use(</span><br><span class="line">  response =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> res = response.data</span><br><span class="line">    store.dispatch(<span class="string">&#x27;SetLoading&#x27;</span>, <span class="literal">false</span>)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line">  &#125;,</span><br><span class="line">  error =&gt; &#123;</span><br><span class="line">    store.dispatch(<span class="string">&#x27;SetLoading&#x27;</span>, <span class="literal">false</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error)</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> service</span><br></pre></td></tr></table></figure><p>最后在 <code>src/components</code> 下创建 <code>RequestLoading.vue</code> 组件：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;transition name=<span class="string">&quot;fade-transform&quot;</span> mode=<span class="string">&quot;out-in&quot;</span>&gt;</span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;request-loading-component&quot;</span> v-<span class="keyword">if</span>=<span class="string">&quot;requestLoading&quot;</span>&gt;</span><br><span class="line">      &lt;svg-icon icon-<span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;loading&quot;</span> /&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/transition&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">import</span> &#123; mapGetters &#125; <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  name: <span class="string">&#x27;RequestLoading&#x27;</span>,</span><br><span class="line">  computed: &#123;</span><br><span class="line">    ...mapGetters([</span><br><span class="line">      <span class="string">&#x27;requestLoading&#x27;</span></span><br><span class="line">    ])</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.nirongfei.site/blog-hexo/2019/02/13/frontend/190213/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/blog-hexo/images/avatar.png"><meta itemprop="name" content="阳明先生"><meta itemprop="description" content="知之真切笃实处即是行 行之明觉精察处即是知"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="阳明先生"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/blog-hexo/2019/02/13/frontend/190213/" class="post-title-link" itemprop="url">Vue-cli3项目全面配置</a></h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2019-02-13 00:00:00" itemprop="dateCreated datePublished" datetime="2019-02-13T00:00:00+08:00">2019-02-13</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2020-11-18 15:57:04" itemprop="dateModified" datetime="2020-11-18T15:57:04+08:00">2020-11-18</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/blog-hexo/categories/%E5%89%8D%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">前端</span></a></span></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>25k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>22 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><h2 id="配置环境变量"><a href="#配置环境变量" class="headerlink" title="配置环境变量"></a>配置环境变量</h2><p>通过在 <code>package.json</code> 里的 <code>scripts</code> 配置项中添加 <code>--mode xxx</code> 来选择不同环境。</p><p>NODE_ENV 和 BASE_URL 是两个特殊变量，在项目中始终可用。只有以 VUE_APP 开头的变量才会被 <code>webpack.DefinePlugin</code> 静态嵌入到客户端包中，代码中可以通过 <code>process.env.VUE_APP_BASE_API</code> 访问。</p><p>在项目根目录中新建 <code>.env</code>, <code>.env.production</code>, <code>.env.analyz</code> 等文件：</p><ul><li><p>.env</p><p><code>serve</code> 默认的开发环境配置：</p></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">NODE_ENV &#x3D; &#39;development&#39;</span><br><span class="line">BASE_URL &#x3D; &#39;.&#x2F;&#39;</span><br><span class="line">VUE_APP_PUBLIC_PATH &#x3D; &#39;.&#x2F;&#39;</span><br><span class="line">VUE_APP_API &#x3D; &#39;https:&#x2F;&#x2F;test.staven630.com&#x2F;api&#39;</span><br></pre></td></tr></table></figure><ul><li><p>.env.production</p><p><code>build</code> 默认的生产环境配置：</p></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">NODE_ENV &#x3D; &#39;production&#39;</span><br><span class="line">BASE_URL &#x3D; &#39;https:&#x2F;&#x2F;prod.staven630.com&#x2F;&#39;</span><br><span class="line">VUE_APP_PUBLIC_PATH &#x3D; &#39;https:&#x2F;&#x2F;prod.oss.com&#x2F;staven-blog&#39;</span><br><span class="line">VUE_APP_API &#x3D; &#39;https:&#x2F;&#x2F;prod.staven630.com&#x2F;api&#39;</span><br><span class="line"></span><br><span class="line">ACCESS_KEY_ID &#x3D; &#39;xxxxxxxxxxxxx&#39;</span><br><span class="line">ACCESS_KEY_SECRET &#x3D; &#39;xxxxxxxxxxxxx&#39;</span><br><span class="line">REGION &#x3D; &#39;oss-cn-hangzhou&#39;</span><br><span class="line">BUCKET &#x3D; &#39;staven-prod&#39;</span><br><span class="line">PREFIX &#x3D; &#39;staven-blog&#39;</span><br></pre></td></tr></table></figure><ul><li><p>.env.analyz</p><p>自定义 <code>build</code> 环境配置：</p></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">NODE_ENV &#x3D; &#39;production&#39;</span><br><span class="line">BASE_URL &#x3D; &#39;https:&#x2F;&#x2F;prod.staven630.com&#x2F;&#39;</span><br><span class="line">VUE_APP_PUBLIC_PATH &#x3D; &#39;https:&#x2F;&#x2F;prod.oss.com&#x2F;staven-blog&#39;</span><br><span class="line">VUE_APP_API &#x3D; &#39;https:&#x2F;&#x2F;prod.staven630.com&#x2F;api&#39;</span><br><span class="line"></span><br><span class="line">ACCESS_KEY_ID &#x3D; &#39;xxxxxxxxxxxxx&#39;</span><br><span class="line">ACCESS_KEY_SECRET &#x3D; &#39;xxxxxxxxxxxxx&#39;</span><br><span class="line">REGION &#x3D; &#39;oss-cn-hangzhou&#39;</span><br><span class="line">BUCKET &#x3D; &#39;staven-prod&#39;</span><br><span class="line">PREFIX &#x3D; &#39;staven-blog&#39;</span><br><span class="line"></span><br><span class="line">IS_ANALYZE &#x3D; true</span><br></pre></td></tr></table></figure><p>修改 <code>package.json</code>：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">  &quot;serve&quot;: &quot;vue-cli-service serve&quot;,</span><br><span class="line">  &quot;build&quot;: &quot;vue-cli-service build&quot;,</span><br><span class="line">  &quot;analyz&quot;: &quot;vue-cli-service build --mode analyze&quot;,</span><br><span class="line">  &quot;lint&quot;: &quot;vue-cli-service lint&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>使用环境变量：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;home&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- template中使用环境变量 --&gt;</span></span><br><span class="line">    &#123;&#123; api &#125;&#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">    name: <span class="string">&#x27;home&#x27;</span>,</span></span><br><span class="line"><span class="javascript">    <span class="function"><span class="title">data</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">return</span> &#123;</span></span><br><span class="line">        api: process.env.VUE_APP_API</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line"><span class="javascript">    <span class="function"><span class="title">mounted</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">      <span class="comment">// js代码中使用环境变量</span></span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="string">&#x27;BASE_URL&#x27;</span>, process.env.BASE_URL)</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="string">&#x27;VUE_APP_API&#x27;</span>, process.env.VUE_APP_API)</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="配置-Proxy-代理"><a href="#配置-Proxy-代理" class="headerlink" title="配置 Proxy 代理"></a>配置 Proxy 代理</h2><p>假设 <code>mock</code> 接口为 <code>https://www.easy-mock.com/mock/5bc75b55dc36971c160cad1b/sheets/1</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  devServer: &#123;</span><br><span class="line">    proxy: &#123;</span><br><span class="line">      <span class="string">&#x27;/api&#x27;</span>: &#123;</span><br><span class="line">        <span class="comment">// 目标代理接口地址</span></span><br><span class="line">        target: <span class="string">&#x27;https://www.easy-mock.com/mock/5bc75b55dc36971c160cad1b/sheets&#x27;</span>,</span><br><span class="line">        secure: <span class="literal">false</span>,</span><br><span class="line">        <span class="comment">// 开启代理，在本地创建一个虚拟服务端</span></span><br><span class="line">        changeOrigin: <span class="literal">true</span>,</span><br><span class="line">        <span class="comment">// 是否启用websockets</span></span><br><span class="line">        ws: <span class="literal">true</span>,</span><br><span class="line">        pathRewrite: &#123;</span><br><span class="line">          <span class="string">&#x27;^/api&#x27;</span>: <span class="string">&#x27;/&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="配置图片压缩"><a href="#配置图片压缩" class="headerlink" title="配置图片压缩"></a>配置图片压缩</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i -D image-webpack-loader</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  chainWebpack: <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">    config.module</span><br><span class="line">      .rule(<span class="string">&#x27;images&#x27;</span>)</span><br><span class="line">      .use(<span class="string">&#x27;image-webpack-loader&#x27;</span>)</span><br><span class="line">      .loader(<span class="string">&#x27;image-webpack-loader&#x27;</span>)</span><br><span class="line">      .options(&#123;</span><br><span class="line">        mozjpeg: &#123; <span class="attr">progressive</span>: <span class="literal">true</span>, <span class="attr">quality</span>: <span class="number">65</span> &#125;,</span><br><span class="line">        optipng: &#123; <span class="attr">enabled</span>: <span class="literal">false</span> &#125;,</span><br><span class="line">        pngquant: &#123; <span class="attr">quality</span>: <span class="string">&#x27;65-90&#x27;</span>, <span class="attr">speed</span>: <span class="number">4</span> &#125;,</span><br><span class="line">        gifsicle: &#123; <span class="attr">interlaced</span>: <span class="literal">false</span> &#125;,</span><br><span class="line">        webp: &#123; <span class="attr">quality</span>: <span class="number">75</span> &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="配置雪碧图"><a href="#配置雪碧图" class="headerlink" title="配置雪碧图"></a>配置雪碧图</h2><p>默认 <code>src/assets/icons</code> 中存放需要生成雪碧图的 PNG 格式图片。首次运行 <code>npm run serve/build</code> 会生成雪碧图，并在根目录生成 <code>icons.json</code> 文件。再次运行命令时，会对比 <code>icons</code> 目录下图片文件与 <code>icons.json</code> 的匹配关系，确定是否需要再次执行 <code>webpack-spritesmith</code> 插件。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i -D webpack-spritesmith</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> SpritesmithPlugin = <span class="built_in">require</span>(<span class="string">&#x27;webpack-spritesmith&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> has_sprite = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> result = fs.readFileSync(path.resolve(__dirname, <span class="string">&#x27;./icons.json&#x27;</span>), <span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">  result = <span class="built_in">JSON</span>.parse(result)</span><br><span class="line">  <span class="keyword">const</span> files = fs.readdirSync(path.resolve(__dirname, <span class="string">&#x27;./src/assets/icons&#x27;</span>))</span><br><span class="line">  <span class="keyword">if</span> (files &amp;&amp; files.length) &#123;</span><br><span class="line">    has_sprite = files.some(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> filename = item.toLocaleLowerCase().replace(<span class="regexp">/_/g</span>, <span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">      <span class="keyword">return</span> !result[filename]</span><br><span class="line">    &#125;)</span><br><span class="line">      ? <span class="literal">true</span></span><br><span class="line">      : <span class="literal">false</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    has_sprite = <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="keyword">catch</span> (error) &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 雪碧图样式处理模板</span></span><br><span class="line"><span class="keyword">const</span> SpritesmithTemplate = <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// pc</span></span><br><span class="line">  <span class="keyword">let</span> icons = &#123;&#125;</span><br><span class="line">  <span class="keyword">let</span> tpl = <span class="string">`.ico &#123; </span></span><br><span class="line"><span class="string">  display: inline-block; </span></span><br><span class="line"><span class="string">  background-image: url(<span class="subst">$&#123;data.sprites[<span class="number">0</span>].image&#125;</span>); </span></span><br><span class="line"><span class="string">  background-size: <span class="subst">$&#123;data.spritesheet.width&#125;</span>px <span class="subst">$&#123;data.spritesheet.height&#125;</span>px; </span></span><br><span class="line"><span class="string">&#125;`</span></span><br><span class="line"></span><br><span class="line">  data.sprites.forEach(<span class="function"><span class="params">sprite</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> name = <span class="string">&#x27;&#x27;</span> + sprite.name.toLocaleLowerCase().replace(<span class="regexp">/_/g</span>, <span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">    icons[<span class="string">`<span class="subst">$&#123;name&#125;</span>.png`</span>] = <span class="literal">true</span></span><br><span class="line">    tpl = <span class="string">`<span class="subst">$&#123;tpl&#125;</span> </span></span><br><span class="line"><span class="string">.ico-<span class="subst">$&#123;name&#125;</span>&#123;</span></span><br><span class="line"><span class="string">  width: <span class="subst">$&#123;sprite.width&#125;</span>px; </span></span><br><span class="line"><span class="string">  height: <span class="subst">$&#123;sprite.height&#125;</span>px; </span></span><br><span class="line"><span class="string">  background-position: <span class="subst">$&#123;sprite.offset_x&#125;</span>px <span class="subst">$&#123;sprite.offset_y&#125;</span>px;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">`</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  fs.writeFile(path.resolve(__dirname, <span class="string">&#x27;./icons.json&#x27;</span>), <span class="built_in">JSON</span>.stringify(icons, <span class="literal">null</span>, <span class="number">2</span>), <span class="function">(<span class="params">err, data</span>) =&gt;</span> &#123;&#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> tpl</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  configureWebpack: <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> plugins = []</span><br><span class="line">    <span class="keyword">if</span> (has_sprite) &#123;</span><br><span class="line">      plugins.push(</span><br><span class="line">        <span class="keyword">new</span> SpritesmithPlugin(&#123;</span><br><span class="line">          src: &#123;</span><br><span class="line">            cwd: path.resolve(__dirname, <span class="string">&#x27;./src/assets/icons/&#x27;</span>), <span class="comment">// 图标根路径</span></span><br><span class="line">            glob: <span class="string">&#x27;**/*.png&#x27;</span> <span class="comment">// 匹配任意 png 图标</span></span><br><span class="line">          &#125;,</span><br><span class="line">          target: &#123;</span><br><span class="line">            image: path.resolve(__dirname, <span class="string">&#x27;./src/assets/images/sprites.png&#x27;</span>), <span class="comment">// 生成雪碧图目标路径与名称</span></span><br><span class="line">            <span class="comment">// 设置生成CSS背景及其定位的文件或方式</span></span><br><span class="line">            css: [</span><br><span class="line">              [</span><br><span class="line">                path.resolve(__dirname, <span class="string">&#x27;./src/assets/scss/sprites.scss&#x27;</span>),</span><br><span class="line">                &#123;</span><br><span class="line">                  format: <span class="string">&#x27;function_based_template&#x27;</span></span><br><span class="line">                &#125;</span><br><span class="line">              ]</span><br><span class="line">            ]</span><br><span class="line">          &#125;,</span><br><span class="line">          customTemplates: &#123;</span><br><span class="line">            function_based_template: SpritesmithTemplate</span><br><span class="line">          &#125;,</span><br><span class="line">          apiOptions: &#123;</span><br><span class="line">            cssImageRef: <span class="string">&#x27;../images/sprites.png&#x27;</span> <span class="comment">// css文件中引用雪碧图的相对位置路径配置</span></span><br><span class="line">          &#125;,</span><br><span class="line">          spritesmithOptions: &#123;</span><br><span class="line">            padding: <span class="number">2</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">      )</span><br><span class="line">    &#125;</span><br><span class="line">    config.plugins = [...config.plugins, ...plugins]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="配置-CDN-资源"><a href="#配置-CDN-资源" class="headerlink" title="配置 CDN 资源"></a>配置 CDN 资源</h2><p>防止将某些 <code>import</code> 的包(package)打包到 <code>bundle</code> 中，而是在运行时 <code>runtime</code> 再去从外部获取这些扩展依赖：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  configureWebpack: <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">    config.externals = &#123;</span><br><span class="line">      vue: <span class="string">&#x27;Vue&#x27;</span>,</span><br><span class="line">      vuex: <span class="string">&#x27;Vuex&#x27;</span>,</span><br><span class="line">      axios: <span class="string">&#x27;axios&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;element-ui&#x27;</span>: <span class="string">&#x27;ELEMENT&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;vue-router&#x27;</span>: <span class="string">&#x27;VueRouter&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  chainWebpack: <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> cdn = &#123;</span><br><span class="line">      css: [<span class="string">&#x27;//unpkg.com/element-ui@2.10.1/lib/theme-chalk/index.css&#x27;</span>],</span><br><span class="line">      js: [</span><br><span class="line">        <span class="string">&#x27;//unpkg.com/vue@2.6.10/dist/vue.min.js&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;//unpkg.com/vuex@3.1.1/dist/vuex.min.js&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;//unpkg.com/axios@0.19.0/dist/axios.min.js&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;//unpkg.com/element-ui@2.10.1/lib/index.js&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;//unpkg.com/vue-router@3.0.6/dist/vue-router.min.js&#x27;</span></span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// html中添加cdn</span></span><br><span class="line">    config.plugin(<span class="string">&#x27;html&#x27;</span>).tap(<span class="function"><span class="params">args</span> =&gt;</span> &#123;</span><br><span class="line">      args[<span class="number">0</span>].cdn = cdn</span><br><span class="line">      <span class="keyword">return</span> args</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在 html 中添加：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 使用CDN的CSS文件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">for</span> (<span class="attr">var</span> <span class="attr">i</span> <span class="attr">in</span> <span class="attr">htmlWebpackPlugin.options.cdn</span> &amp;&amp; <span class="attr">htmlWebpackPlugin.options.cdn.css</span>) &#123; %&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">&quot;&lt;%= htmlWebpackPlugin.options.cdn.css[i] %&gt;&quot;</span> <span class="attr">rel</span>=<span class="string">&quot;external nofollow&quot;</span> <span class="attr">rel</span>=<span class="string">&quot;preload&quot;</span> <span class="attr">as</span>=<span class="string">&quot;style&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%</span> &#125; %&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 使用CDN的CSS文件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">for</span> (<span class="attr">var</span> <span class="attr">css</span> <span class="attr">of</span> <span class="attr">htmlWebpackPlugin.options.cdn.css</span>) &#123; %&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">&quot;&lt;%=css%&gt;&quot;</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">as</span>=<span class="string">&quot;style&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%</span> &#125; %&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 使用CDN的JS文件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">for</span> (<span class="attr">var</span> <span class="attr">i</span> <span class="attr">in</span> <span class="attr">htmlWebpackPlugin.options.cdn</span> &amp;&amp; <span class="attr">htmlWebpackPlugin.options.cdn.js</span>) &#123; %&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">&quot;&lt;%= htmlWebpackPlugin.options.cdn.js[i] %&gt;&quot;</span> <span class="attr">rel</span>=<span class="string">&quot;external nofollow&quot;</span> <span class="attr">rel</span>=<span class="string">&quot;preload&quot;</span> <span class="attr">as</span>=<span class="string">&quot;script&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%</span> &#125; %&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 使用CDN的JS文件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">for</span> (<span class="attr">var</span> <span class="attr">js</span> <span class="attr">of</span> <span class="attr">htmlWebpackPlugin.options.cdn.js</span>) &#123; %&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;&lt;%=js%&gt;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%</span> &#125; %&gt;</span></span><br></pre></td></tr></table></figure><h2 id="配置模块打包"><a href="#配置模块打包" class="headerlink" title="配置模块打包"></a>配置模块打包</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> isPro = process.env.NODE_ENV === <span class="string">&#x27;production&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  chainWebpack: <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (isPro) &#123;</span><br><span class="line">      config.optimization = &#123;</span><br><span class="line">        splitChunks: &#123;</span><br><span class="line">          cacheGroups: &#123;</span><br><span class="line">            libs: &#123;</span><br><span class="line">              name: <span class="string">&#x27;chunk-libs&#x27;</span>,</span><br><span class="line">              test: <span class="regexp">/[\\/]node_modules[\\/]/</span>,</span><br><span class="line">              priority: <span class="number">10</span>,</span><br><span class="line">              chunks: <span class="string">&#x27;initial&#x27;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            elementUI: &#123;</span><br><span class="line">              name: <span class="string">&#x27;chunk-elementUI&#x27;</span>,</span><br><span class="line">              priority: <span class="number">20</span>,</span><br><span class="line">              test: <span class="regexp">/[\\/]node_modules[\\/]element-ui[\\/]/</span>,</span><br><span class="line">              chunks: <span class="string">&#x27;all&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="配置页面预渲染"><a href="#配置页面预渲染" class="headerlink" title="配置页面预渲染"></a>配置页面预渲染</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i -D prerender-spa-plugin</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> PrerenderSpaPlugin = <span class="built_in">require</span>(<span class="string">&#x27;prerender-spa-plugin&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> resolve = <span class="function"><span class="params">dir</span> =&gt;</span> path.join(__dirname, dir)</span><br><span class="line"><span class="keyword">const</span> isPro = process.env.NODE_ENV === <span class="string">&#x27;production&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  configureWebpack: <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> plugins = []</span><br><span class="line">    <span class="keyword">if</span> (isPro) &#123;</span><br><span class="line">      plugins.push(</span><br><span class="line">        <span class="keyword">new</span> PrerenderSpaPlugin(&#123;</span><br><span class="line">          staticDir: resolve(<span class="string">&#x27;dist&#x27;</span>),</span><br><span class="line">          routes: [<span class="string">&#x27;/&#x27;</span>],</span><br><span class="line">          <span class="function"><span class="title">postProcess</span>(<span class="params">ctx</span>)</span> &#123;</span><br><span class="line">            ctx.route = ctx.originalRoute</span><br><span class="line">            ctx.html = ctx.html.split(<span class="regexp">/&gt;[\s]+&lt;/gim</span>).join(<span class="string">&#x27;&gt;&lt;&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> (ctx.route.endsWith(<span class="string">&#x27;.html&#x27;</span>)) &#123;</span><br><span class="line">              ctx.outputPath = path.join(__dirname, <span class="string">&#x27;dist&#x27;</span>, ctx.route)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> ctx</span><br><span class="line">          &#125;,</span><br><span class="line">          minify: &#123;</span><br><span class="line">            collapseBooleanAttributes: <span class="literal">true</span>,</span><br><span class="line">            collapseWhitespace: <span class="literal">true</span>,</span><br><span class="line">            decodeEntities: <span class="literal">true</span>,</span><br><span class="line">            keepClosingSlash: <span class="literal">true</span>,</span><br><span class="line">            sortAttributes: <span class="literal">true</span></span><br><span class="line">          &#125;,</span><br><span class="line">          renderer: <span class="keyword">new</span> PrerenderSpaPlugin.PuppeteerRenderer(&#123;</span><br><span class="line">            <span class="comment">// 需要注入一个值，这样就可以检测页面当前是否是预渲染的</span></span><br><span class="line">            inject: &#123;&#125;,</span><br><span class="line">            headless: <span class="literal">false</span>,</span><br><span class="line">            <span class="comment">// 视图组件是在API请求获取所有必要数据后呈现的，因此我们在dom中存在“data view”属性后创建页面快照</span></span><br><span class="line">            renderAfterDocumentEvent: <span class="string">&#x27;render-event&#x27;</span></span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">      )</span><br><span class="line">    &#125;</span><br><span class="line">    config.plugins = [...config.plugins, ...plugins]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>mounted()</code> 中添加 <code>document.dispatchEvent(new Event(&#39;render-event&#39;))</code>：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  router,</span><br><span class="line">  store,</span><br><span class="line">  render: <span class="function"><span class="params">h</span> =&gt;</span> h(App),</span><br><span class="line">  <span class="function"><span class="title">mounted</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">document</span>.dispatchEvent(<span class="keyword">new</span> Event(<span class="string">&#x27;render-event&#x27;</span>))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;).$mount(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure><h2 id="修复热更新失效"><a href="#修复热更新失效" class="headerlink" title="修复热更新失效"></a>修复热更新失效</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  chainWebpack: <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 修复HMR</span></span><br><span class="line">    config.resolve.symlinks(<span class="literal">true</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="修复路由懒加载"><a href="#修复路由懒加载" class="headerlink" title="修复路由懒加载"></a>修复路由懒加载</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  chainWebpack: <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">    config.plugin(<span class="string">&#x27;html&#x27;</span>).tap(<span class="function"><span class="params">args</span> =&gt;</span> &#123;</span><br><span class="line">      args[<span class="number">0</span>].chunksSortMode = <span class="string">&#x27;none&#x27;</span></span><br><span class="line">      <span class="keyword">return</span> args</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="添加别名-alias"><a href="#添加别名-alias" class="headerlink" title="添加别名 alias"></a>添加别名 alias</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> resolve = <span class="function"><span class="params">dir</span> =&gt;</span> path.join(__dirname, dir)</span><br><span class="line"><span class="keyword">const</span> isPro = process.env.NODE_ENV === <span class="string">&#x27;production&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  chainWebpack: <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 添加别名</span></span><br><span class="line">    config.resolve.alias</span><br><span class="line">      .set(<span class="string">&#x27;vue$&#x27;</span>, <span class="string">&#x27;vue/dist/vue.esm.js&#x27;</span>)</span><br><span class="line">      .set(<span class="string">&#x27;@&#x27;</span>, resolve(<span class="string">&#x27;src&#x27;</span>))</span><br><span class="line">      .set(<span class="string">&#x27;@assets&#x27;</span>, resolve(<span class="string">&#x27;src/assets&#x27;</span>))</span><br><span class="line">      .set(<span class="string">&#x27;@components&#x27;</span>, resolve(<span class="string">&#x27;src/components&#x27;</span>))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="添加-IE-兼容"><a href="#添加-IE-兼容" class="headerlink" title="添加 IE 兼容"></a>添加 IE 兼容</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i --save @babel&#x2F;polyfill</span><br></pre></td></tr></table></figure><p>在 <code>main.js</code> 中添加：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;@babel/polyfill&#x27;</span></span><br></pre></td></tr></table></figure><p>配置 <code>babel.config.js</code>：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> plugins = []</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  presets: [[<span class="string">&#x27;@vue/app&#x27;</span>, &#123; <span class="attr">useBuiltIns</span>: <span class="string">&#x27;entry&#x27;</span> &#125;]],</span><br><span class="line">  plugins: plugins</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="添加打包分析"><a href="#添加打包分析" class="headerlink" title="添加打包分析"></a>添加打包分析</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> BundleAnalyzerPlugin = <span class="built_in">require</span>(<span class="string">&#x27;webpack-bundle-analyzer&#x27;</span>).BundleAnalyzerPlugin</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  chainWebpack: <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 打包分析</span></span><br><span class="line">    <span class="keyword">if</span> (process.env.IS_ANALYZ) &#123;</span><br><span class="line">      config.plugin(<span class="string">&#x27;webpack-report&#x27;</span>).use(BundleAnalyzerPlugin, [</span><br><span class="line">        &#123;</span><br><span class="line">          analyzerMode: <span class="string">&#x27;static&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">      ])</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>添加 <code>.env.analyz</code> 文件：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">NODE_ENV &#x3D; &#39;production&#39;</span><br><span class="line">IS_ANALYZE &#x3D; true</span><br></pre></td></tr></table></figure><p>在<code>package.json</code> 的 <code>scripts</code> 中添加：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;analyz&quot;: &quot;vue-cli-service build --mode analyze&quot;</span><br></pre></td></tr></table></figure><h2 id="添加全局-Sass"><a href="#添加全局-Sass" class="headerlink" title="添加全局 Sass"></a>添加全局 Sass</h2><p>可以通过在 <code>main.js</code> 中 <code>Vue.prototype.$src = process.env.VUE_APP_PUBLIC_PATH;</code> 挂载环境变量中的配置信息，然后在 js 中使用 <code>$src</code> 访问。</p><p>css 中可以使用注入 <code>sass</code> 变量访问环境变量中的配置信息：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  css: &#123;</span><br><span class="line">    modules: <span class="literal">false</span>,</span><br><span class="line">    extract: isPro,</span><br><span class="line">    sourceMap: <span class="literal">false</span>,</span><br><span class="line">    loaderOptions: &#123;</span><br><span class="line">      sass: &#123;</span><br><span class="line">        <span class="comment">// 向全局sass样式传入共享的全局变量</span></span><br><span class="line">        data: <span class="string">`@import &quot;~assets/scss/variables.scss&quot;;</span></span><br><span class="line"><span class="string">          $src: &quot;<span class="subst">$&#123;process.env.VUE_APP_PUBLIC_PATH&#125;</span>&quot;;`</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在 scss 中引用：</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.home</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: url(<span class="variable">$src</span>+<span class="string">&#x27;/images/500.png&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="添加全局-Stylus"><a href="#添加全局-Stylus" class="headerlink" title="添加全局 Stylus"></a>添加全局 Stylus</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i -D style-resources-loader</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> resolve = <span class="function"><span class="params">dir</span> =&gt;</span> path.resolve(__dirname, dir)</span><br><span class="line"><span class="keyword">const</span> addStylusResource = <span class="function"><span class="params">rule</span> =&gt;</span> &#123;</span><br><span class="line">  rule</span><br><span class="line">    .use(<span class="string">&#x27;style-resouce&#x27;</span>)</span><br><span class="line">    .loader(<span class="string">&#x27;style-resources-loader&#x27;</span>)</span><br><span class="line">    .options(&#123;</span><br><span class="line">      patterns: [resolve(<span class="string">&#x27;src/assets/stylus/variable.styl&#x27;</span>)]</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  chainWebpack: <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> types = [<span class="string">&#x27;vue-modules&#x27;</span>, <span class="string">&#x27;vue&#x27;</span>, <span class="string">&#x27;normal-modules&#x27;</span>, <span class="string">&#x27;normal&#x27;</span>]</span><br><span class="line">    types.forEach(<span class="function"><span class="params">type</span> =&gt;</span> addStylusResource(config.module.rule(<span class="string">&#x27;stylus&#x27;</span>).oneOf(type)))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="添加文件上传"><a href="#添加文件上传" class="headerlink" title="添加文件上传"></a>添加文件上传</h2><p>开启文件上传 <code>ali oss</code>，需要将 <code>publicPath</code> 改成 <code>ali oss</code> 资源 <code>url</code> 前缀,也就是修改 VUE_APP_PUBLIC_PATH：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i -D webpack-oss</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> AliOssPlugin = <span class="built_in">require</span>(<span class="string">&#x27;webpack-oss&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  configureWebpack: <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (isPro) &#123;</span><br><span class="line">      <span class="keyword">const</span> plugins = []</span><br><span class="line">      <span class="comment">// 上传文件到oss</span></span><br><span class="line">      <span class="keyword">if</span> (</span><br><span class="line">        process.env.ACCESS_KEY_ID ||</span><br><span class="line">        process.env.ACCESS_KEY_SECRET ||</span><br><span class="line">        process.env.REGION ||</span><br><span class="line">        process.env.BUCKET ||</span><br><span class="line">        process.env.PREFIX</span><br><span class="line">      ) &#123;</span><br><span class="line">        plugins.push(</span><br><span class="line">          <span class="keyword">new</span> AliOssPlugin(&#123;</span><br><span class="line">            accessKeyId: process.env.ACCESS_KEY_ID,</span><br><span class="line">            accessKeySecret: process.env.ACCESS_KEY_SECRET,</span><br><span class="line">            region: process.env.REGION,</span><br><span class="line">            bucket: process.env.BUCKET,</span><br><span class="line">            prefix: process.env.PREFIX,</span><br><span class="line">            exclude: <span class="regexp">/.*\.html$/</span>,</span><br><span class="line">            deleteAll: <span class="literal">false</span></span><br><span class="line">          &#125;)</span><br><span class="line">        )</span><br><span class="line">      &#125;</span><br><span class="line">      config.plugins = [...config.plugins, ...plugins]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="添加-Gzip-压缩"><a href="#添加-Gzip-压缩" class="headerlink" title="添加 Gzip 压缩"></a>添加 Gzip 压缩</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i --D compression-webpack-plugin</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> isPro = process.env.NODE_ENV === <span class="string">&#x27;production&#x27;</span></span><br><span class="line"><span class="keyword">const</span> productionGzipExtensions = <span class="regexp">/\.(js|css|json|txt|html|ico|svg)(\?.*)?$/i</span></span><br><span class="line"><span class="keyword">const</span> CompressionWebpackPlugin = <span class="built_in">require</span>(<span class="string">&#x27;compression-webpack-plugin&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  configureWebpack: <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> plugins = []</span><br><span class="line">    <span class="keyword">if</span> (isPro) &#123;</span><br><span class="line">      plugins.push(</span><br><span class="line">        <span class="keyword">new</span> CompressionWebpackPlugin(&#123;</span><br><span class="line">          filename: <span class="string">&#x27;[path].gz[query]&#x27;</span>,</span><br><span class="line">          algorithm: <span class="string">&#x27;gzip&#x27;</span>,</span><br><span class="line">          test: productionGzipExtensions,</span><br><span class="line">          threshold: <span class="number">10240</span>,</span><br><span class="line">          minRatio: <span class="number">0.8</span></span><br><span class="line">        &#125;)</span><br><span class="line">      )</span><br><span class="line">    &#125;</span><br><span class="line">    config.plugins = [...config.plugins, ...plugins]</span><br><span class="line">  &#125;,</span><br><span class="line">  chainWebpack: <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (isPro) &#123;</span><br><span class="line">      config</span><br><span class="line">        .plugin(<span class="string">&#x27;compression&#x27;</span>)</span><br><span class="line">        .use(CompressionWebpackPlugin, &#123;</span><br><span class="line">          asset: <span class="string">&#x27;[path].gz[query]&#x27;</span>,</span><br><span class="line">          algorithm: <span class="string">&#x27;gzip&#x27;</span>,</span><br><span class="line">          test: productionGzipExtensions,</span><br><span class="line">          threshold: <span class="number">10240</span>,</span><br><span class="line">          minRatio: <span class="number">0.8</span>,</span><br><span class="line">          cache: <span class="literal">true</span></span><br><span class="line">        &#125;)</span><br><span class="line">        .tap(<span class="function"><span class="params">args</span> =&gt;</span> &#123;&#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>如果服务端使用的是 <code>nginx</code> 服务器的话，需要配置开启 <code>gzip</code> 才能支持：</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">gzip</span> <span class="literal">on</span>;</span><br><span class="line"><span class="attribute">gzip_static</span> <span class="literal">on</span>;</span><br><span class="line"><span class="attribute">gzip_min_length</span> <span class="number">1024</span>;</span><br><span class="line"><span class="attribute">gzip_buffers</span> <span class="number">4</span> <span class="number">16k</span>;</span><br><span class="line"><span class="attribute">gzip_comp_level</span> <span class="number">2</span>;</span><br><span class="line"><span class="attribute">gzip_types</span> text/plain application/javascript application/x-javascript text/css application/xml text/javascript application/x-httpd-php application/vnd.ms-fontobject font/ttf font/opentype font/x-woff image/svg+xml;</span><br><span class="line"><span class="attribute">gzip_vary</span> <span class="literal">off</span>;</span><br><span class="line"><span class="attribute">gzip_disable</span> <span class="string">&quot;MSIE [1-6]\.&quot;</span>;</span><br></pre></td></tr></table></figure><p>除了 <code>gzip</code> 压缩，还有体验更好的 <a target="_blank" rel="noopener" href="https://webpack.js.org/plugins/compression-webpack-plugin">Zopfli 压缩</a>：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i --save-dev @gfx&#x2F;zopfli brotli-webpack-plugin</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> CompressionWebpackPlugin = <span class="built_in">require</span>(<span class="string">&#x27;compression-webpack-plugin&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> zopfli = <span class="built_in">require</span>(<span class="string">&#x27;@gfx/zopfli&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> BrotliPlugin = <span class="built_in">require</span>(<span class="string">&#x27;brotli-webpack-plugin&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> isPro = process.env.NODE_ENV === <span class="string">&#x27;production&#x27;</span></span><br><span class="line"><span class="keyword">const</span> productionGzipExtensions = <span class="regexp">/\.(js|css|json|txt|html|ico|svg)(\?.*)?$/i</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  configureWebpack: <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> plugins = []</span><br><span class="line">    <span class="keyword">if</span> (isPro) &#123;</span><br><span class="line">      plugins.push(</span><br><span class="line">        <span class="keyword">new</span> CompressionWebpackPlugin(&#123;</span><br><span class="line">          <span class="function"><span class="title">algorithm</span>(<span class="params">input, compressionOptions, callback</span>)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> zopfli.gzip(input, compressionOptions, callback)</span><br><span class="line">          &#125;,</span><br><span class="line">          compressionOptions: &#123;</span><br><span class="line">            numiterations: <span class="number">15</span></span><br><span class="line">          &#125;,</span><br><span class="line">          minRatio: <span class="number">0.99</span>,</span><br><span class="line">          test: productionGzipExtensions</span><br><span class="line">        &#125;)</span><br><span class="line">      )</span><br><span class="line">      plugins.push(</span><br><span class="line">        <span class="keyword">new</span> BrotliPlugin(&#123;</span><br><span class="line">          test: productionGzipExtensions,</span><br><span class="line">          minRatio: <span class="number">0.99</span></span><br><span class="line">        &#125;)</span><br><span class="line">      )</span><br><span class="line">    &#125;</span><br><span class="line">    config.plugins = [...config.plugins, ...plugins]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="移除无效-CSS"><a href="#移除无效-CSS" class="headerlink" title="移除无效 CSS"></a>移除无效 CSS</h2><p>方案一：<code>@fullhuman/postcss-purgecss</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i -D postcss-import @fullhuman&#x2F;postcss-purgecss</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> autoprefixer = <span class="built_in">require</span>(<span class="string">&#x27;autoprefixer&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> postcssImport = <span class="built_in">require</span>(<span class="string">&#x27;postcss-import&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> purgecss = <span class="built_in">require</span>(<span class="string">&#x27;@fullhuman/postcss-purgecss&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> isPro = process.env.NODE_ENV === <span class="string">&#x27;production&#x27;</span></span><br><span class="line"><span class="keyword">let</span> plugins = []</span><br><span class="line"><span class="keyword">if</span> (isPro) &#123;</span><br><span class="line">  plugins.push(postcssImport)</span><br><span class="line">  plugins.push(</span><br><span class="line">    purgecss(&#123;</span><br><span class="line">      content: [</span><br><span class="line">        <span class="string">&#x27;./layouts/**/*.vue&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;./components/**/*.vue&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;./pages/**/*.vue&#x27;</span></span><br><span class="line">      ],</span><br><span class="line">      extractors: [</span><br><span class="line">        &#123;</span><br><span class="line">          extractor: <span class="class"><span class="keyword">class</span> <span class="title">Extractor</span> </span>&#123;</span><br><span class="line">            <span class="keyword">static</span> <span class="function"><span class="title">extract</span>(<span class="params">content</span>)</span> &#123;</span><br><span class="line">              <span class="keyword">const</span> validSection = content.replace(</span><br><span class="line">                /<span class="xml"><span class="tag">&lt;<span class="name">style([\s\S]*?)</span>&lt;\/<span class="attr">style</span>&gt;</span>+/gim,</span></span><br><span class="line"><span class="xml">                &#x27;&#x27;</span></span><br><span class="line"><span class="xml">              )</span></span><br><span class="line"><span class="xml">              return validSection..match(/[A-Za-z0-9-_/:]*[A-Za-z0-9-_/]+/g) || []</span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"><span class="xml">          &#125;,</span></span><br><span class="line"><span class="xml">          extensions: [&#x27;html&#x27;, &#x27;vue&#x27;]</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml">      ],</span></span><br><span class="line"><span class="xml">      whitelist: [&#x27;html&#x27;, &#x27;body&#x27;],</span></span><br><span class="line"><span class="xml">      whitelistPatterns: [/el-.*/, /-(leave|enter|appear)(|-(to|from|active))$/, /^(?!cursor-move).+-move$/, /^router-link(|-exact)-active$/],</span></span><br><span class="line"><span class="xml">      whitelistPatternsChildren: [/^token/, /^pre/, /^code/]</span></span><br><span class="line"><span class="xml">    &#125;)</span></span><br><span class="line"><span class="xml">  )</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml">module.exports = &#123;</span></span><br><span class="line"><span class="xml">  plugins: [...plugins, autoprefixer]</span></span><br><span class="line"><span class="xml">&#125;</span></span><br></pre></td></tr></table></figure><p>方案二：<code>purgecss-webpack-plugin</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i -D glob-all purgecss-webpack-plugin</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> glob = <span class="built_in">require</span>(<span class="string">&quot;glob-all&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> PurgecssPlugin = <span class="built_in">require</span>(<span class="string">&quot;purgecss-webpack-plugin&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> resolve = <span class="function"><span class="params">dir</span> =&gt;</span> path.join(__dirname, dir);</span><br><span class="line"><span class="keyword">const</span> isPro = [<span class="string">&quot;production&quot;</span>, <span class="string">&quot;prod&quot;</span>].includes(process.env.NODE_ENV);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  configureWebpack: <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> plugins = [];</span><br><span class="line">    <span class="keyword">if</span> (isPro) &#123;</span><br><span class="line">      plugins.push(</span><br><span class="line">        <span class="keyword">new</span> PurgecssPlugin(&#123;</span><br><span class="line">          paths: glob.sync([resolve(<span class="string">&quot;./**/*.vue&quot;</span>)]),</span><br><span class="line">          extractors: [</span><br><span class="line">            &#123;</span><br><span class="line">              extractor: <span class="class"><span class="keyword">class</span> <span class="title">Extractor</span> </span>&#123;</span><br><span class="line">                <span class="keyword">static</span> <span class="function"><span class="title">extract</span>(<span class="params">content</span>)</span> &#123;</span><br><span class="line">                  <span class="keyword">const</span> validSection = content.replace(</span><br><span class="line">                    /<span class="xml"><span class="tag">&lt;<span class="name">style([\s\S]*?)</span>&lt;\/<span class="attr">style</span>&gt;</span>+/gim,</span></span><br><span class="line"><span class="xml">                    &quot;&quot;</span></span><br><span class="line"><span class="xml">                  );</span></span><br><span class="line"><span class="xml">                  return validSection..match(/[A-Za-z0-9-_/:]*[A-Za-z0-9-_/]+/g) || []</span></span><br><span class="line"><span class="xml">                &#125;</span></span><br><span class="line"><span class="xml">              &#125;,</span></span><br><span class="line"><span class="xml">              extensions: [&quot;html&quot;, &quot;vue&quot;]</span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"><span class="xml">          ],</span></span><br><span class="line"><span class="xml">          whitelist: [&quot;html&quot;, &quot;body&quot;],</span></span><br><span class="line"><span class="xml">          whitelistPatterns: [/el-.*/, /-(leave|enter|appear)(|-(to|from|active))$/, /^(?!cursor-move).+-move$/, /^router-link(|-exact)-active$/],</span></span><br><span class="line"><span class="xml">          whitelistPatternsChildren: [/^token/, /^pre/, /^code/]</span></span><br><span class="line"><span class="xml">        &#125;)</span></span><br><span class="line"><span class="xml">      );</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"><span class="xml">    config.plugins = [...config.plugins, ...plugins];</span></span><br><span class="line"><span class="xml">  &#125;</span></span><br><span class="line"><span class="xml">&#125;;</span></span><br></pre></td></tr></table></figure><h2 id="移除-console-log"><a href="#移除-console-log" class="headerlink" title="移除 console.log"></a>移除 console.log</h2><p>方法一：使用 <code>babel-plugin-transform-remove-console</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i --D babel-plugin-transform-remove-console</span><br></pre></td></tr></table></figure><p>在 <code>babel.config.js</code> 中配置：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> isPro = process.env.NODE_ENV === <span class="string">&#x27;production&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> plugins = []</span><br><span class="line"><span class="keyword">if</span> (isPro) &#123;</span><br><span class="line">  plugins.push(<span class="string">&#x27;transform-remove-console&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  presets: [<span class="string">&#x27;@vue/app&#x27;</span>, &#123; <span class="attr">useBuiltIns</span>: <span class="string">&#x27;entry&#x27;</span> &#125;],</span><br><span class="line">  plugins</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>方法二：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> UglifyJsPlugin = <span class="built_in">require</span>(<span class="string">&#x27;uglifyjs-webpack-plugin&#x27;</span>)</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  configureWebpack: <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (isPro) &#123;</span><br><span class="line">      <span class="keyword">const</span> plugins = []</span><br><span class="line">      plugins.push(</span><br><span class="line">        <span class="keyword">new</span> UglifyJsPlugin(&#123;</span><br><span class="line">          uglifyOptions: &#123;</span><br><span class="line">            warnings: <span class="literal">false</span>,</span><br><span class="line">            compress: &#123;</span><br><span class="line">              drop_console: <span class="literal">true</span>,</span><br><span class="line">              drop_debugger: <span class="literal">true</span>,</span><br><span class="line">              pure_funcs: [<span class="string">&#x27;console.log&#x27;</span>]</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          sourceMap: <span class="literal">false</span>,</span><br><span class="line">          parallel: <span class="literal">true</span></span><br><span class="line">        &#125;)</span><br><span class="line">      )</span><br><span class="line">      config.plugins = [...config.plugins, ...plugins]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>如果使用 <code>uglifyjs-webpack-plugin</code> 会报错，可能存在 <code>node_modules</code> 中有些依赖需要 <code>babel</code> 转译。</p><p>而 <code>vue-cli</code> 的 <code>transpileDependencies</code> 配置默认为 <code>[]</code>, <code>babel-loader</code> 会忽略所有 <code>node_modules</code> 中的文件。如果你想要通过 Babel 显式转译一个依赖，可以在这个选项中列出来。配置需要转译的第三方库。</p><h2 id="完整配置代码"><a href="#完整配置代码" class="headerlink" title="完整配置代码"></a>完整配置代码</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> glob = <span class="built_in">require</span>(<span class="string">&#x27;glob-all&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> AliOssPlugin = <span class="built_in">require</span>(<span class="string">&#x27;webpack-oss&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> PurgecssPlugin = <span class="built_in">require</span>(<span class="string">&#x27;purgecss-webpack-plugin&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> UglifyJsPlugin = <span class="built_in">require</span>(<span class="string">&#x27;uglifyjs-webpack-plugin&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> PrerenderSpaPlugin = <span class="built_in">require</span>(<span class="string">&#x27;prerender-spa-plugin&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> CompressionWebpackPlugin = <span class="built_in">require</span>(<span class="string">&#x27;compression-webpack-plugin&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> BundleAnalyzerPlugin = <span class="built_in">require</span>(<span class="string">&#x27;webpack-bundle-analyzer&#x27;</span>).BundleAnalyzerPlugin</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> resolve = <span class="function"><span class="params">dir</span> =&gt;</span> path.join(__dirname, dir)</span><br><span class="line"><span class="keyword">const</span> isPro = process.env.NODE_ENV === <span class="string">&#x27;production&#x27;</span></span><br><span class="line"><span class="keyword">const</span> productionGzipExtensions = <span class="regexp">/\.(js|css|json|txt|html|ico|svg)(\?.*)?$/i</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> addStylusResource = <span class="function"><span class="params">rule</span> =&gt;</span> &#123;</span><br><span class="line">  rule</span><br><span class="line">    .use(<span class="string">&#x27;style-resouce&#x27;</span>)</span><br><span class="line">    .loader(<span class="string">&#x27;style-resources-loader&#x27;</span>)</span><br><span class="line">    .options(&#123;</span><br><span class="line">      patterns: [resolve(<span class="string">&#x27;src/assets/stylus/variable.styl&#x27;</span>)]</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  publicPath: process.env.VUE_APP_PUBLIC_PATH,</span><br><span class="line">  outputDir: process.env.outputDir || <span class="string">&#x27;dist&#x27;</span>,</span><br><span class="line">  assetsDir: <span class="string">&#x27;static&#x27;</span>,</span><br><span class="line">  configureWebpack: <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> plugins = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (isPro) &#123;</span><br><span class="line">      <span class="comment">// 移除无效CSS</span></span><br><span class="line">      plugins.push(</span><br><span class="line">        <span class="keyword">new</span> PurgecssPlugin(&#123;</span><br><span class="line">          paths: glob.sync([resolve(<span class="string">&#x27;./**/*.vue&#x27;</span>)]),</span><br><span class="line">          extractors: [</span><br><span class="line">            &#123;</span><br><span class="line">              extractor: <span class="class"><span class="keyword">class</span> <span class="title">Extractor</span> </span>&#123;</span><br><span class="line">                <span class="keyword">static</span> <span class="function"><span class="title">extract</span>(<span class="params">content</span>)</span> &#123;</span><br><span class="line">                  <span class="keyword">const</span> validSection = content.replace(<span class="regexp">/&lt;style([\s\S]*?)&lt;\/style&gt;+/gim</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">                  <span class="keyword">return</span> validSection.match(<span class="regexp">/[A-Za-z0-9-_:/]+/g</span>) || []</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;,</span><br><span class="line">              extensions: [<span class="string">&#x27;html&#x27;</span>, <span class="string">&#x27;vue&#x27;</span>]</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          whitelist: [<span class="string">&#x27;html&#x27;</span>, <span class="string">&#x27;body&#x27;</span>],</span><br><span class="line">          whitelistPatterns: [<span class="regexp">/el-.*/</span>],</span><br><span class="line">          whitelistPatternsChildren: [<span class="regexp">/^token/</span>, <span class="regexp">/^pre/</span>, <span class="regexp">/^code/</span>]</span><br><span class="line">        &#125;)</span><br><span class="line">      )</span><br><span class="line">      <span class="comment">// 移除打印</span></span><br><span class="line">      plugins.push(</span><br><span class="line">        <span class="keyword">new</span> UglifyJsPlugin(&#123;</span><br><span class="line">          uglifyOptions: &#123;</span><br><span class="line">            compress: &#123;</span><br><span class="line">              warnings: <span class="literal">false</span>,</span><br><span class="line">              drop_console: <span class="literal">true</span>,</span><br><span class="line">              drop_debugger: <span class="literal">false</span>,</span><br><span class="line">              pure_funcs: [<span class="string">&#x27;console.log&#x27;</span>]</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          sourceMap: <span class="literal">false</span>,</span><br><span class="line">          parallel: <span class="literal">true</span></span><br><span class="line">        &#125;)</span><br><span class="line">      )</span><br><span class="line">      <span class="comment">// 文件压缩</span></span><br><span class="line">      plugins.push(</span><br><span class="line">        <span class="keyword">new</span> CompressionWebpackPlugin(&#123;</span><br><span class="line">          filename: <span class="string">&#x27;[path].gz[query]&#x27;</span>,</span><br><span class="line">          algorithm: <span class="string">&#x27;gzip&#x27;</span>,</span><br><span class="line">          test: productionGzipExtensions,</span><br><span class="line">          threshold: <span class="number">10240</span>,</span><br><span class="line">          minRatio: <span class="number">0.8</span></span><br><span class="line">        &#125;)</span><br><span class="line">      )</span><br><span class="line">      <span class="comment">// 页面预加载</span></span><br><span class="line">      plugins.push(</span><br><span class="line">        <span class="keyword">new</span> PrerenderSpaPlugin(&#123;</span><br><span class="line">          staticDir: resolve(<span class="string">&#x27;dist&#x27;</span>),</span><br><span class="line">          routes: [<span class="string">&#x27;/&#x27;</span>],</span><br><span class="line">          <span class="function"><span class="title">postProcess</span>(<span class="params">ctx</span>)</span> &#123;</span><br><span class="line">            ctx.route = ctx.originalRoute</span><br><span class="line">            ctx.html = ctx.html.split(<span class="regexp">/&gt;[\s]+&lt;/gim</span>).join(<span class="string">&#x27;&gt;&lt;&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> (ctx.route.endsWith(<span class="string">&#x27;.html&#x27;</span>)) &#123;</span><br><span class="line">              ctx.outputPath = path.join(__dirname, <span class="string">&#x27;dist&#x27;</span>, ctx.route)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> ctx</span><br><span class="line">          &#125;,</span><br><span class="line">          minify: &#123;</span><br><span class="line">            collapseBooleanAttributes: <span class="literal">true</span>,</span><br><span class="line">            collapseWhitespace: <span class="literal">true</span>,</span><br><span class="line">            decodeEntities: <span class="literal">true</span>,</span><br><span class="line">            keepClosingSlash: <span class="literal">true</span>,</span><br><span class="line">            sortAttributes: <span class="literal">true</span></span><br><span class="line">          &#125;,</span><br><span class="line">          renderer: <span class="keyword">new</span> PrerenderSpaPlugin.PuppeteerRenderer(&#123;</span><br><span class="line">            <span class="comment">// 需要注入一个值，这样就可以检测页面当前是否是预渲染的</span></span><br><span class="line">            inject: &#123;&#125;,</span><br><span class="line">            headless: <span class="literal">false</span>,</span><br><span class="line">            <span class="comment">// 视图组件是在API请求获取所有必要数据后呈现的，因此我们在dom中存在“data view”属性后创建页面快照</span></span><br><span class="line">            renderAfterDocumentEvent: <span class="string">&#x27;render-event&#x27;</span></span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">      )</span><br><span class="line">      <span class="comment">// 文件上传</span></span><br><span class="line">      plugins.push(</span><br><span class="line">        <span class="keyword">new</span> AliOssPlugin(&#123;</span><br><span class="line">          accessKeyId: process.env.ACCESS_KEY_ID,</span><br><span class="line">          accessKeySecret: process.env.ACCESS_KEY_SECRET,</span><br><span class="line">          region: process.env.REGION,</span><br><span class="line">          bucket: process.env.BUCKET,</span><br><span class="line">          prefix: process.env.PREFIX,</span><br><span class="line">          exclude: <span class="regexp">/.*\.html$/</span>,</span><br><span class="line">          deleteAll: <span class="literal">false</span></span><br><span class="line">        &#125;)</span><br><span class="line">      )</span><br><span class="line">    &#125;</span><br><span class="line">    config.externals = &#123;</span><br><span class="line">      vue: <span class="string">&#x27;Vue&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;element-ui&#x27;</span>: <span class="string">&#x27;ELEMENT&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;vue-router&#x27;</span>: <span class="string">&#x27;VueRouter&#x27;</span>,</span><br><span class="line">      vuex: <span class="string">&#x27;Vuex&#x27;</span>,</span><br><span class="line">      axios: <span class="string">&#x27;axios&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    config.plugins = [...config.plugins, ...plugins]</span><br><span class="line">  &#125;,</span><br><span class="line">  chainWebpack: <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// CDN资源</span></span><br><span class="line">    <span class="keyword">const</span> cdn = &#123;</span><br><span class="line">      css: [<span class="string">&#x27;//unpkg.com/element-ui@2.10.1/lib/theme-chalk/index.css&#x27;</span>],</span><br><span class="line">      js: [</span><br><span class="line">        <span class="string">&#x27;//unpkg.com/vue@2.6.10/dist/vue.min.js&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;//unpkg.com/vue-router@3.0.6/dist/vue-router.min.js&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;//unpkg.com/vuex@3.1.1/dist/vuex.min.js&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;//unpkg.com/axios@0.19.0/dist/axios.min.js&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;//unpkg.com/element-ui@2.10.1/lib/index.js&#x27;</span></span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 修复HMR</span></span><br><span class="line">    config.resolve.symlinks(<span class="literal">true</span>)</span><br><span class="line">    <span class="comment">// 修复路由懒加载</span></span><br><span class="line">    config.plugin(<span class="string">&#x27;html&#x27;</span>).tap(<span class="function"><span class="params">args</span> =&gt;</span> &#123;</span><br><span class="line">      args[<span class="number">0</span>].chunksSortMode = <span class="string">&#x27;none&#x27;</span></span><br><span class="line">      <span class="comment">// html中添加cdn</span></span><br><span class="line">      <span class="comment">// args[0].cdn = cdn;</span></span><br><span class="line">      <span class="keyword">return</span> args</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// 添加别名</span></span><br><span class="line">    config.resolve.alias</span><br><span class="line">      .set(<span class="string">&#x27;vue$&#x27;</span>, <span class="string">&#x27;vue/dist/vue.esm.js&#x27;</span>)</span><br><span class="line">      .set(<span class="string">&#x27;@&#x27;</span>, resolve(<span class="string">&#x27;src&#x27;</span>))</span><br><span class="line">      .set(<span class="string">&#x27;@assets&#x27;</span>, resolve(<span class="string">&#x27;src/assets&#x27;</span>))</span><br><span class="line">      .set(<span class="string">&#x27;@components&#x27;</span>, resolve(<span class="string">&#x27;src/components&#x27;</span>))</span><br><span class="line">    <span class="comment">// 图片压缩</span></span><br><span class="line">    config.module</span><br><span class="line">      .rule(<span class="string">&quot;images&quot;</span>)</span><br><span class="line">      .use(<span class="string">&quot;image-webpack-loader&quot;</span>)</span><br><span class="line">      .loader(<span class="string">&quot;image-webpack-loader&quot;</span>)</span><br><span class="line">      .options(&#123;</span><br><span class="line">        mozjpeg: &#123; <span class="attr">progressive</span>: <span class="literal">true</span>, <span class="attr">quality</span>: <span class="number">65</span> &#125;,</span><br><span class="line">        optipng: &#123; <span class="attr">enabled</span>: <span class="literal">false</span> &#125;,</span><br><span class="line">        pngquant: &#123; <span class="attr">quality</span>: <span class="string">&quot;65-90&quot;</span>, <span class="attr">speed</span>: <span class="number">4</span> &#125;,</span><br><span class="line">        gifsicle: &#123; <span class="attr">interlaced</span>: <span class="literal">false</span> &#125;,</span><br><span class="line">        webp: &#123; <span class="attr">quality</span>: <span class="number">75</span> &#125;</span><br><span class="line">      &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> types = [<span class="string">&quot;vue-modules&quot;</span>, <span class="string">&quot;vue&quot;</span>, <span class="string">&quot;normal-modules&quot;</span>, <span class="string">&quot;normal&quot;</span>];</span><br><span class="line">    types.forEach(<span class="function"><span class="params">type</span> =&gt;</span></span><br><span class="line">      addStylusResource(config.module.rule(<span class="string">&quot;stylus&quot;</span>).oneOf(type))</span><br><span class="line">    )</span><br><span class="line">    <span class="comment">// 打包分析</span></span><br><span class="line">    <span class="keyword">if</span> (process.env.IS_ANALYZ) &#123;</span><br><span class="line">      config.plugin(<span class="string">&#x27;webpack-report&#x27;</span>).use(BundleAnalyzerPlugin, [</span><br><span class="line">        &#123;</span><br><span class="line">          analyzerMode: <span class="string">&#x27;static&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">      ])</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (isPro) &#123;</span><br><span class="line">      <span class="comment">// 打包模块</span></span><br><span class="line">      config.optimization.splitChunks(&#123;</span><br><span class="line">        cacheGroups: &#123;</span><br><span class="line">          libs: &#123;</span><br><span class="line">            name: <span class="string">&#x27;chunk-libs&#x27;</span>,</span><br><span class="line">            chunks: <span class="string">&#x27;initial&#x27;</span>,</span><br><span class="line">            priority: <span class="number">10</span>,</span><br><span class="line">            test: <span class="regexp">/[\\/]node_modules[\\/]/</span></span><br><span class="line">          &#125;,</span><br><span class="line">          elementUI: &#123;</span><br><span class="line">            name: <span class="string">&#x27;chunk-elementUI&#x27;</span>,</span><br><span class="line">            chunks: <span class="string">&#x27;all&#x27;</span></span><br><span class="line">            priority: <span class="number">20</span>,</span><br><span class="line">            test: <span class="regexp">/[\\/]node_modules[\\/]element-ui[\\/]/</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> config</span><br><span class="line">  &#125;,</span><br><span class="line">  css: &#123;</span><br><span class="line">    modules: <span class="literal">false</span>,</span><br><span class="line">    extract: isPro,</span><br><span class="line">    sourceMap: <span class="literal">false</span>,</span><br><span class="line">    loaderOptions: &#123;</span><br><span class="line">      sass: &#123;</span><br><span class="line">        data: <span class="string">`@import &quot;~assets/scss/variables.scss&quot;;</span></span><br><span class="line"><span class="string">        $src: &quot;<span class="subst">$&#123;process.env.VUE_APP_PUBLIC_PATH&#125;</span>&quot;;`</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  transpileDependencies: [],</span><br><span class="line">  lintOnSave: <span class="literal">false</span>,</span><br><span class="line">  runtimeCompiler: <span class="literal">true</span>,</span><br><span class="line">  productionSourceMap: !isPro,</span><br><span class="line">  parallel: <span class="built_in">require</span>(<span class="string">&#x27;os&#x27;</span>).cpus().length &gt; <span class="number">1</span>,</span><br><span class="line">  pwa: &#123;&#125;,</span><br><span class="line">  devServer: &#123;</span><br><span class="line">    overlay: &#123;</span><br><span class="line">      warnings: <span class="literal">false</span>,</span><br><span class="line">      errors: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    open: <span class="literal">false</span>,</span><br><span class="line">    host: <span class="string">&quot;localhost&quot;</span>,</span><br><span class="line">    port: <span class="string">&quot;8080&quot;</span>,</span><br><span class="line">    https: <span class="literal">false</span>,</span><br><span class="line">    hotOnly: <span class="literal">false</span>,</span><br><span class="line">    proxy: &#123;</span><br><span class="line">      <span class="string">&#x27;/api&#x27;</span>: &#123;</span><br><span class="line">        target: <span class="string">&#x27;https://www.easy-mock.com/mock/5bc75b55dc36971c160cad1b/sheets&#x27;</span>,</span><br><span class="line">        secure: <span class="literal">false</span>,</span><br><span class="line">        changeOrigin: <span class="literal">true</span>,</span><br><span class="line">        ws: <span class="literal">true</span>,</span><br><span class="line">        pathRewrite: &#123;</span><br><span class="line">          <span class="string">&#x27;^/api&#x27;</span>: <span class="string">&#x27;/&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.nirongfei.site/blog-hexo/2019/01/03/frontend/190103/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/blog-hexo/images/avatar.png"><meta itemprop="name" content="阳明先生"><meta itemprop="description" content="知之真切笃实处即是行 行之明觉精察处即是知"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="阳明先生"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/blog-hexo/2019/01/03/frontend/190103/" class="post-title-link" itemprop="url">Vue开发知识总结</a></h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2019-01-03 00:00:00" itemprop="dateCreated datePublished" datetime="2019-01-03T00:00:00+08:00">2019-01-03</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2020-11-18 15:57:04" itemprop="dateModified" datetime="2020-11-18T15:57:04+08:00">2020-11-18</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/blog-hexo/categories/%E5%89%8D%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">前端</span></a></span></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>26k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>23 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><h2 id="组件通讯"><a href="#组件通讯" class="headerlink" title="组件通讯"></a>组件通讯</h2><h3 id="props"><a href="#props" class="headerlink" title="props"></a>props</h3><p>子组件中声明 <code>props</code> 接受父组件传递的数据, 值可以是数组或对象：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 数组</span></span><br><span class="line">props:[]</span><br><span class="line"></span><br><span class="line"><span class="comment">// 对象</span></span><br><span class="line">props: &#123;</span><br><span class="line"> inpVal: &#123;</span><br><span class="line">  type: <span class="built_in">Number</span>, <span class="comment">//传入值限定类型</span></span><br><span class="line">  <span class="comment">// type 值可为String,Number,Boolean,Array,Object,Date,Function,Symbol</span></span><br><span class="line">  <span class="comment">// type 还可以是一个自定义的构造函数，并且通过 instanceof 来进行检查确认</span></span><br><span class="line">  required: <span class="literal">true</span>, <span class="comment">//是否必传</span></span><br><span class="line">  <span class="keyword">default</span>: <span class="number">200</span>,  <span class="comment">//默认值,对象或数组默认值必须从一个工厂函数获取如 default:()=&gt;[]</span></span><br><span class="line">  validator: (value) &#123;</span><br><span class="line">    <span class="comment">// 这个值必须匹配下列字符串中的一个</span></span><br><span class="line">    <span class="keyword">return</span> [<span class="string">&#x27;success&#x27;</span>, <span class="string">&#x27;warning&#x27;</span>, <span class="string">&#x27;danger&#x27;</span>].indexOf(value) !== -<span class="number">1</span></span><br><span class="line">  &#125;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="emit"><a href="#emit" class="headerlink" title="emit"></a>emit</h3><p>子组件触发监听事件向父组件发送消息：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 父组件</span></span><br><span class="line">&lt;parent @click=<span class="string">&quot;onclick&quot;</span> /&gt;</span><br><span class="line"><span class="comment">// 子组件</span></span><br><span class="line"><span class="built_in">this</span>.$emit(<span class="string">&#x27;click&#x27;</span>, [&#123;<span class="attr">title</span>: <span class="string">&#x27;这是title&#x27;</span>&#125;])</span><br></pre></td></tr></table></figure><h3 id="refs"><a href="#refs" class="headerlink" title="refs"></a>refs</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 父组件</span></span><br><span class="line">&lt;parent ref=<span class="string">&quot;home&quot;</span>/&gt;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">mounted</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="comment">// 获取到子组件实例, 可以直接操作其属性方法</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">this</span>.$refs.home)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="root"><a href="#root" class="headerlink" title="root"></a>root</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 父组件</span></span><br><span class="line"><span class="function"><span class="title">mounted</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">this</span>.$root) <span class="comment">//获取根实例,所有组件都挂载到根实例</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">this</span>.$root.$children[<span class="number">0</span>]) <span class="comment">//获取根实例的一级子组件</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">this</span>.$root.$children[<span class="number">0</span>].$children[<span class="number">0</span>]) <span class="comment">//获取根实例的二级子组件</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="sync"><a href="#sync" class="headerlink" title="sync"></a>sync</h3><ul><li>在 <code>vue@1.x</code> 的时候曾作为双向绑定功能存在，即子组件可以修改父组件中的值;</li><li>在 <code>vue@2.0</code> 的由于违背单向数据通讯设计被移除了;</li><li>在 <code>vue@2.3.0+</code> 又重新引入了 <code>.sync</code> 修饰符;</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 父组件</span></span><br><span class="line">&lt;home :title.sync=<span class="string">&quot;title&quot;</span> /&gt;</span><br><span class="line"><span class="comment">// 编译时会被扩展为</span></span><br><span class="line">&lt;home :title=<span class="string">&quot;title&quot;</span> @update:title=<span class="string">&quot;val =&gt; title = val&quot;</span>/&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 子组件</span></span><br><span class="line"><span class="comment">// 所以子组件可以通过$emit 触发 update 方法改变</span></span><br><span class="line"><span class="function"><span class="title">mounted</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.$emit(<span class="string">&quot;update:title&quot;</span>, <span class="string">&#x27;这是新的 title&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="vuex"><a href="#vuex" class="headerlink" title="vuex"></a>vuex</h3><ul><li>vuex 是一个状态管理器；</li><li>vuex 适合应用于共享大量数据的场景；</li><li>vuex 核心概念:<ul><li><code>state</code>: 定义存贮数据的仓库 ,可通过 <code>this.$store.state</code> 或 <code>mapState</code> 访问</li><li><code>getter</code>: 获取 <code>store</code> 值,可认为是 <code>store</code> 的计算属性,可通过 <code>this.$store.getter</code> 或 <code>mapGetters</code> 访问</li><li><code>mutation</code>: 同步改变 <code>store</code> 值,为什么会设计成同步,因为 <code>mutation</code> 是直接改变 <code>store</code> 值, vue 对操作进行了记录,如果是异步无法追踪改变.可通过 <code>mapMutations</code> 调用</li><li><code>action</code>: 异步调用函数执行 <code>mutation</code>,进而改变 store 值,可通过 <code>this.$dispatch</code> 或 <code>mapActions</code> 访问</li><li><code>modules</code>: 模块,如果状态过多,可以拆分成模块,最后在入口通过 <code>...</code> 解构引入</li></ul></li></ul><h3 id="v-slot"><a href="#v-slot" class="headerlink" title="v-slot"></a>v-slot</h3><p>-<code>slot/slot-cope/scope</code> 在 2.6.0 中被废弃, 但仍可使用;</p><ul><li><p>将父组件的 template 传入子组件;</p></li><li><p>插槽分类:</p><ul><li>匿名插槽</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// 父组件</span><br><span class="line"><span class="tag">&lt;<span class="name">todo-list</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-slot:default</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>我是匿名插槽<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">todo-list</span>&gt;</span></span><br><span class="line">// 子组件</span><br><span class="line"><span class="tag">&lt;<span class="name">slot</span>&gt;</span>我是默认值<span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>具名插槽: 相对匿名插槽组件 <code>slot</code> 标签带 <code>name</code> 命名的;</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// 父组件</span><br><span class="line"><span class="tag">&lt;<span class="name">todo-list</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-slot:todo</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>我是匿名插槽<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">todo-list</span>&gt;</span></span><br><span class="line">// 子组件</span><br><span class="line"><span class="tag">&lt;<span class="name">slot</span> <span class="attr">name</span>=<span class="string">&quot;todo&quot;</span>&gt;</span>我是默认值<span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>作用域插槽: 子组件内数据可以在父组件中拿到</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// 父组件</span><br><span class="line"><span class="tag">&lt;<span class="name">todo-list</span>&gt;</span></span><br><span class="line">  // slotProps 可以随意命名</span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-slot:todo</span>=<span class="string">&quot;slotProps&quot;</span>&gt;</span></span><br><span class="line">    &#123;&#123;slotProps.user.firstName&#125;&#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">todo-list</span>&gt;</span></span><br><span class="line">// 子组件</span><br><span class="line"><span class="tag">&lt;<span class="name">slot</span> <span class="attr">name</span>=<span class="string">&quot;todo&quot;</span> <span class="attr">:user</span>=<span class="string">&quot;user&quot;</span> <span class="attr">:test</span>=<span class="string">&quot;test&quot;</span>&gt;</span></span><br><span class="line">  &#123;&#123; user.lastName &#125;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line"></span><br><span class="line">data() &#123; return &#123; user: &#123; lastName:&quot;Zhang&quot;, firstName:&quot;yue&quot; &#125;, test:[1,2,3,4] &#125; &#125;</span><br></pre></td></tr></table></figure></li></ul><h3 id="EventBus"><a href="#EventBus" class="headerlink" title="EventBus"></a>EventBus</h3><p>EventBus 的原理是声明一个全局的实例变量, 绑定需要通讯的数据和事件, 利用 <code>$emit</code> 实现组件通讯, 但是对应监听事件名 eventTarget 必须保证唯一性;</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.js</span></span><br><span class="line">Vue.prototype.$eventBus = <span class="keyword">new</span> Vue()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 传值组件</span></span><br><span class="line"><span class="built_in">this</span>.$eventBus.$emit(<span class="string">&#x27;eventTarget&#x27;</span>, <span class="string">&#x27;这是 eventTarget 传过来的值&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 接收组件</span></span><br><span class="line"><span class="built_in">this</span>.$eventBus.$on(<span class="string">&#x27;eventTarget&#x27;</span>, <span class="function"><span class="params">v</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;eventTarget&#x27;</span>, v) <span class="comment">//这是 eventTarget 传过来的值</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="attrs-listeners"><a href="#attrs-listeners" class="headerlink" title="attrs/listeners"></a>attrs/listeners</h3><h4 id="attrs"><a href="#attrs" class="headerlink" title="attrs"></a>attrs</h4><p><code>attrs</code> 可以在子组件中获取父组件中声明的未定义属性：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 父组件</span></span><br><span class="line">&lt;parent title=<span class="string">&quot;这是标题&quot;</span> width=<span class="string">&quot;80&quot;</span> height=<span class="string">&quot;80&quot;</span> imgUrl=<span class="string">&quot;imgUrl&quot;</span>/&gt;</span><br><span class="line"><span class="comment">// 子组件</span></span><br><span class="line"><span class="function"><span class="title">mounted</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">this</span>.$attrs) <span class="comment">//&#123;title: &quot;这是标题&quot;, width: &quot;80&quot;, height: &quot;80&quot;, imgUrl: &quot;imgUrl&quot;&#125;</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p>如果子组件 <code>props</code> 中声明了属性, 打印结果就会排除掉该属性, 并且可以通过 <code>v-bind=&quot;$attrs&quot;</code> 将 <code>attrs</code> 传入内部组件：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">props: &#123;</span><br><span class="line">  width: &#123;</span><br><span class="line">    type: <span class="built_in">String</span>,</span><br><span class="line">    <span class="keyword">default</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="function"><span class="title">mounted</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">this</span>.$attrs) <span class="comment">//&#123;title: &quot;这是标题&quot;, height: &quot;80&quot;, imgUrl: &quot;imgUrl&quot;&#125;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="listeners"><a href="#listeners" class="headerlink" title="listeners"></a>listeners</h4><p><code>listeners</code> 可以在子组件中获取父组件中监听的事件方法：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 父组件</span></span><br><span class="line">&lt;parent @change=<span class="string">&quot;onchange&quot;</span>/&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 子组件</span></span><br><span class="line"><span class="function"><span class="title">mounted</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">this</span>.$listeners) <span class="comment">//即可拿到 onchange 事件</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>同样, 子组件可以通过 <code>v-on=&quot;$listeners&quot;</code> 将 <code>listeners</code> 传入内部组件。</p><h4 id="inheritAttrs"><a href="#inheritAttrs" class="headerlink" title="inheritAttrs"></a>inheritAttrs</h4><p><code>inheritAttrs</code> 默认值为 <code>true</code>，表示将父组件中除了 <code>props</code> 以外的属性添加到子组件的根节点上，如果设置为 <code>false</code> , 属性就不会添加到子组件根节点上了。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 父组件</span></span><br><span class="line">&lt;parent title=<span class="string">&quot;这是标题&quot;</span> width=<span class="string">&quot;80&quot;</span> height=<span class="string">&quot;80&quot;</span> imgUrl=<span class="string">&quot;imgUrl&quot;</span>/&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 子组件</span></span><br><span class="line"><span class="function"><span class="title">mounted</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">this</span>.$attrs) <span class="comment">//&#123;title: &quot;这是标题&quot;, width: &quot;80&quot;, height: &quot;80&quot;, imgUrl: &quot;imgUrl&quot;&#125;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="parent-children"><a href="#parent-children" class="headerlink" title="parent/children"></a>parent/children</h3><p><code>parent</code> 和 <code>children</code> 并不保证顺序，也不是响应式的，只能获取到直接父组件和子组件。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 父组件</span></span><br><span class="line"><span class="function"><span class="title">mounted</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="comment">// 获取到直接子组件,操作其属性和方法</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">this</span>.$children)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 子组件</span></span><br><span class="line"><span class="function"><span class="title">mounted</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="comment">// 获取到直接父组件,操作其属性和方法</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">this</span>.$parent)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="provide-inject"><a href="#provide-inject" class="headerlink" title="provide/inject"></a>provide/inject</h3><p><code>provide</code> 和 <code>inject</code> 主要为高阶插件/组件库提供用例，并不推荐直接用于应用程序代码中。并且这对选项需要一起使用，以允许一个祖先组件向其所有子孙后代注入一个依赖，不论组件层次有多深，并在起上下游关系成立的时间里始终生效。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 父组件:</span></span><br><span class="line">provide: &#123;</span><br><span class="line">  foo: <span class="string">&#x27;这是 foo&#x27;</span>,</span><br><span class="line">  fooMethod:<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;父组件 fooMethod 被调用&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line"><span class="comment">// 子孙组件</span></span><br><span class="line">inject: [<span class="string">&#x27;foo&#x27;</span>,<span class="string">&#x27;fooMethod&#x27;</span>], <span class="comment">//数组或者对象,注入到子组件</span></span><br><span class="line"><span class="function"><span class="title">mounted</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">  <span class="built_in">this</span>.fooMethod()</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">this</span>.foo)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>provide</code> 和 <code>inject</code> 绑定并不是可响应的。然而，如果你传入了一个可监听的对象，那么其对象的属性还是可响应的，因为对象是引用类型。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//父组件:</span></span><br><span class="line">provide: &#123;</span><br><span class="line">  foo: <span class="string">&#x27;这是 foo&#x27;</span></span><br><span class="line">&#125;,</span><br><span class="line"><span class="function"><span class="title">mounted</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.foo=<span class="string">&#x27;这是新的 foo&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 子孙组件</span></span><br><span class="line">inject: [<span class="string">&#x27;foo&#x27;</span>],</span><br><span class="line"><span class="function"><span class="title">mounted</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">this</span>.foo) <span class="comment">//子组件打印的还是&#x27;这是 foo&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="broadcast-dispatch"><a href="#broadcast-dispatch" class="headerlink" title="broadcast/dispatch"></a>broadcast/dispatch</h3><p><code>vue1.x</code> 有事件广播和派发这两个方法，但是在 <code>vue2.x</code> 中移除了，下面是这两个方法的实现：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">broadcast</span>(<span class="params">componentName, eventName, params</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.$children.forEach(<span class="function"><span class="params">child</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> name = child.$options.componentName</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (name === componentName) &#123;</span><br><span class="line">      child.$emit.apply(child, [eventName].concat(params))</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      broadcast.apply(child, [componentName, eventName].concat(params))</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  methods: &#123;</span><br><span class="line">    <span class="function"><span class="title">dispatch</span>(<span class="params">componentName, eventName, params</span>)</span> &#123;</span><br><span class="line">      <span class="keyword">var</span> parent = <span class="built_in">this</span>.$parent</span><br><span class="line">      <span class="keyword">var</span> name = parent.$options.componentName</span><br><span class="line">      <span class="keyword">while</span> (parent &amp;&amp; (!name || name !== componentName)) &#123;</span><br><span class="line">        parent = parent.\$parent</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (parent) &#123;</span><br><span class="line">          name = parent.$options.componentName</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (parent) &#123;</span><br><span class="line">        parent.$emit.apply(parent, [eventName].concat(params))</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="title">broadcast</span>(<span class="params">componentName, eventName, params</span>)</span> &#123;</span><br><span class="line">      broadcast.call(<span class="built_in">this</span>, componentName, eventName, params)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Vue-observable"><a href="#Vue-observable" class="headerlink" title="Vue.observable"></a>Vue.observable</h3><p>Vue 内部会用它来处理 <code>data</code> 函数返回的对象，返回的对象可以直接用于渲染函数和计算属性内，并且会在发生改变时触发相应的更新，也可以作为最小化的跨组件状态存储器，用于简单的场景。通讯原理实质上是利用 Vue.observable 实现一个简易的 <code>vuex</code>。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 文件路径</span></span><br><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> store = Vue.observable(&#123; <span class="attr">count</span>: <span class="number">0</span> &#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> mutations = &#123;</span><br><span class="line">  <span class="function"><span class="title">setCount</span>(<span class="params">count</span>)</span> &#123;</span><br><span class="line">    store.count = count</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;bookNum&quot;</span>&gt;</span>数 量<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;setCount(count+1)&quot;</span>&gt;</span>+<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123;count&#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;setCount(count-1)&quot;</span>&gt;</span>-<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">import</span> &#123; store, mutations &#125; <span class="keyword">from</span> <span class="string">&#x27;../store/store&#x27;</span></span></span><br><span class="line"></span><br><span class="line"><span class="javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">    name: <span class="string">&#x27;Add&#x27;</span>,</span></span><br><span class="line">    computed: &#123;</span><br><span class="line"><span class="javascript">      <span class="function"><span class="title">count</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">return</span> store.count</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">      setCount: mutations.setCount</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="路由传参"><a href="#路由传参" class="headerlink" title="路由传参"></a>路由传参</h3><h4 id="方式一"><a href="#方式一" class="headerlink" title="方式一"></a>方式一</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 路由定义</span></span><br><span class="line">&#123;</span><br><span class="line">  path: <span class="string">&#x27;/describe/:id&#x27;</span>,</span><br><span class="line">  name: <span class="string">&#x27;Describe&#x27;</span>,</span><br><span class="line">  component: Describe</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 页面传参</span></span><br><span class="line"><span class="built_in">this</span>.$router.push(&#123;</span><br><span class="line">  path: <span class="string">`/describe/<span class="subst">$&#123;id&#125;</span>`</span>,</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 页面获取</span></span><br><span class="line"><span class="built_in">this</span>.$route.params.id</span><br></pre></td></tr></table></figure><h4 id="方式二"><a href="#方式二" class="headerlink" title="方式二"></a>方式二</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 路由定义</span></span><br><span class="line">&#123;</span><br><span class="line">  path: <span class="string">&#x27;/describe&#x27;</span>,</span><br><span class="line">  name: <span class="string">&#x27;Describe&#x27;</span>,</span><br><span class="line">  omponent: Describe</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 页面传参</span></span><br><span class="line"><span class="built_in">this</span>.$router.push(&#123;</span><br><span class="line">  name: <span class="string">&#x27;Describe&#x27;</span>,</span><br><span class="line">  params: &#123;</span><br><span class="line">    id: id</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 页面获取</span></span><br><span class="line"><span class="built_in">this</span>.$route.params.id</span><br></pre></td></tr></table></figure><h4 id="方式三"><a href="#方式三" class="headerlink" title="方式三"></a>方式三</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 路由定义</span></span><br><span class="line">&#123;</span><br><span class="line">  path: <span class="string">&#x27;/describe&#x27;</span>,</span><br><span class="line">  name: <span class="string">&#x27;Describe&#x27;</span>,</span><br><span class="line">  component: Describe</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 页面传参</span></span><br><span class="line"><span class="built_in">this</span>.$router.push(&#123;</span><br><span class="line">  path: <span class="string">&#x27;/describe&#x27;</span>,</span><br><span class="line">  query: &#123;</span><br><span class="line">    id: id</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br><span class="line"><span class="comment">// 页面获取</span></span><br><span class="line"><span class="built_in">this</span>.$route.query.id</span><br></pre></td></tr></table></figure><p>在这三种方式中，方式二参数不会拼接在路由后面，页面刷新参数会丢失，方式一和方式三参数会拼接在路由后面，暴露出来。</p><h2 id="组件注册"><a href="#组件注册" class="headerlink" title="组件注册"></a>组件注册</h2><p>components: 局部注册组件</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  components: &#123; home &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Vue.component: 全局注册组件</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Vue.component(<span class="string">&#x27;home&#x27;</span>, home)</span><br></pre></td></tr></table></figure><h2 id="异步组件"><a href="#异步组件" class="headerlink" title="异步组件"></a>异步组件</h2><p>场景:项目过大就会导致加载缓慢,所以异步组件实现按需加载就是必须要做的事啦 1.异步注册组件<br>3 种方法</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 工厂函数执行 resolve 回调</span></span><br><span class="line">Vue.component(<span class="string">&#x27;async-webpack-example&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">resolve</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 这个特殊的 `require` 语法将会告诉 webpack</span></span><br><span class="line">  <span class="comment">// 自动将你的构建代码切割成多个包, 这些包</span></span><br><span class="line">  <span class="comment">// 会通过 Ajax 请求加载</span></span><br><span class="line">  <span class="built_in">require</span>([<span class="string">&#x27;./my-async-component&#x27;</span>], resolve)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 工厂函数返回 Promise</span></span><br><span class="line">Vue.component(</span><br><span class="line">  <span class="string">&#x27;async-webpack-example&#x27;</span>,</span><br><span class="line">  <span class="comment">// 这个 `import` 函数会返回一个 `Promise` 对象。</span></span><br><span class="line">  () =&gt; <span class="keyword">import</span>(<span class="string">&#x27;./my-async-component&#x27;</span>)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 工厂函数返回一个配置化组件对象</span></span><br><span class="line"><span class="keyword">const</span> AsyncComponent = <span class="function">() =&gt;</span> (&#123;</span><br><span class="line">  <span class="comment">// 需要加载的组件 (应该是一个 `Promise` 对象)</span></span><br><span class="line">  component: <span class="keyword">import</span>(<span class="string">&#x27;./MyComponent.vue&#x27;</span>),</span><br><span class="line">  <span class="comment">// 异步组件加载时使用的组件</span></span><br><span class="line">  loading: LoadingComponent,</span><br><span class="line">  <span class="comment">// 加载失败时使用的组件</span></span><br><span class="line">  error: ErrorComponent,</span><br><span class="line">  <span class="comment">// 展示加载时组件的延时时间。默认值是 200 (毫秒)</span></span><br><span class="line">  delay: <span class="number">200</span>,</span><br><span class="line">  <span class="comment">// 如果提供了超时时间且组件加载也超时了，</span></span><br><span class="line">  <span class="comment">// 则使用加载失败时使用的组件。默认值是：`Infinity`</span></span><br><span class="line">  timeout: <span class="number">3000</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>异步组件的渲染本质上其实就是执行 2 次或者 2 次以上的渲染, 先把当前组件渲染为注释节点, 当组件加载成功后, 通过 forceRender 执行重新渲染。或者是渲染为注释节点, 然后再渲染为 loading 节点, 在渲染为请求完成的组件<br>路由的按需加载</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">webpack&lt; <span class="number">2.4</span> 时</span><br><span class="line">&#123;</span><br><span class="line">path:<span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">name:<span class="string">&#x27;home&#x27;</span>,</span><br><span class="line">components:<span class="function"><span class="params">resolve</span>=&gt;</span><span class="built_in">require</span>([<span class="string">&#x27;@/components/home&#x27;</span>],resolve)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">webpack&gt; <span class="number">2.4</span> 时</span><br><span class="line">&#123;</span><br><span class="line">path:<span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">name:<span class="string">&#x27;home&#x27;</span>,</span><br><span class="line">components:<span class="function">()=&gt;</span><span class="keyword">import</span>(<span class="string">&#x27;@/components/home&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>import()方法由 es6 提出，import()方法是动态加载，返回一个 Promise 对象，then 方法的参数是加载到的模块。类似于 Node.js 的 require 方法，主要 import()方法是异步加载的。</p><h2 id="动态组件"><a href="#动态组件" class="headerlink" title="动态组件"></a>动态组件</h2><p>场景:做一个 tab 切换时就会涉及到组件动态加载</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">component</span> <span class="attr">v-bind:is</span>=<span class="string">&quot;currentTabComponent&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">component</span>&gt;</span></span><br></pre></td></tr></table></figure><p>但是这样每次组件都会重新加载,会消耗大量性能,所以 就起到了作用</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">keep-alive</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">component</span> <span class="attr">v-bind:is</span>=<span class="string">&quot;currentTabComponent&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">component</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">keep-alive</span>&gt;</span></span><br></pre></td></tr></table></figure><p>这样切换效果没有动画效果,这个也不用着急,可以利用内置的</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">transition</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">keep-alive</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">component</span> <span class="attr">v-bind:is</span>=<span class="string">&quot;currentTabComponent&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">component</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">keep-alive</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="递归组件"><a href="#递归组件" class="headerlink" title="递归组件"></a>递归组件</h2><p>场景:如果开发一个 tree 组件,里面层级是根据后台数据决定的,这个时候就需要用到动态组件<br>// 递归组件: 组件在它的模板内可以递归的调用自己，只要给组件设置 name 组件就可以了。<br>// 设置那么 House 在组件模板内就可以递归使用了,不过需要注意的是，<br>// 必须给一个条件来限制数量，否则会抛出错误: max stack size exceeded<br>// 组件递归用来开发一些具体有未知层级关系的独立组件。比如：<br>// 联级选择器和树形控件</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-for</span>=<span class="string">&quot;(item,index) in treeArr&quot;</span>&gt;</span></span><br><span class="line">    子组件，当前层级值： &#123;&#123;index&#125;&#125; <span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 递归调用自身, 后台判断是否不存在改值 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tree</span> <span class="attr">:item</span>=<span class="string">&quot;item.arr&quot;</span> <span class="attr">v-if</span>=<span class="string">&quot;item.flag&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">tree</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">    <span class="comment">// 必须定义name，组件内部才能递归调用</span></span></span><br><span class="line"><span class="javascript">    name: <span class="string">&#x27;tree&#x27;</span>,</span></span><br><span class="line"><span class="javascript">    <span class="function"><span class="title">data</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">return</span> &#123;&#125;</span></span><br><span class="line">    &#125;,</span><br><span class="line"><span class="javascript">    <span class="comment">// 接收外部传入的值</span></span></span><br><span class="line">    props: &#123;</span><br><span class="line">      item: &#123;</span><br><span class="line"><span class="javascript">        type: <span class="built_in">Array</span>,</span></span><br><span class="line"><span class="javascript">        <span class="keyword">default</span>: <span class="function">() =&gt;</span> []</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>递归组件必须设置 name 和结束的阀值</p><h2 id="函数式组件"><a href="#函数式组件" class="headerlink" title="函数式组件"></a>函数式组件</h2><p>定义:无状态,无法实例化，内部没有任何生命周期处理方法<br>规则:在 2.3.0 之前的版本中，如果一个函数式组件想要接收 prop，则 props 选项是必须的。<br>在 2.3.0 或以上的版本中，你可以省略 props 选项，所有组件上的特性都会被自动隐式解析为 prop<br>在 2.5.0 及以上版本中，如果你使用了单文件组件(就是普通的.vue 文件),可以直接在 template 上声明 functional<br>组件需要的一切都是通过 context 参数传递, 它的属性有:</p><ul><li>props：提供所有 prop 的对象</li><li>children: VNode 子节点的数组</li><li>slots: 一个函数，返回了包含所有插槽的对象</li><li>scopedSlots: (2.6.0+) 一个暴露传入的作用域插槽的对象。也以函数形式暴露普通插槽。</li><li>data：传递给组件的整个数据对象，作为 createElement 的第二个参数传入组件</li><li>parent：对父组件的引用</li><li>listeners: (2.3.0+) 一个包含了所有父组件为当前组件注册的事件监听器的对象。这是 data.on 的一个别名。</li><li>injections: (2.3.0+) 如果使用了 inject 选项，则该对象包含了应当被注入的属性</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">functional</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-for</span>=<span class="string">&quot;(item,index) in props.arr&quot;</span>&gt;</span>&#123;&#123;item&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="watch"><a href="#watch" class="headerlink" title="watch"></a>watch</h2><h4 id="常用用法"><a href="#常用用法" class="headerlink" title="常用用法"></a>常用用法</h4><p>场景：表格初始进来获取数据，条件改变会重新获取：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">watch: &#123;</span><br><span class="line">  <span class="function"><span class="title">inpVal</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.getList()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="function"><span class="title">created</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.getList()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="立即执行"><a href="#立即执行" class="headerlink" title="立即执行"></a>立即执行</h4><p><code>watch</code> 的 <code>immediate</code> 和 <code>handler</code> 属性：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">watch: &#123;</span><br><span class="line">  inpVal: &#123;</span><br><span class="line">    handler: <span class="string">&#x27;getList&#x27;</span>,</span><br><span class="line">    immediate: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="深度监听"><a href="#深度监听" class="headerlink" title="深度监听"></a>深度监听</h4><p><code>watch</code> 的 <code>deep</code> 属性, 监听复杂数据类型：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">watch: &#123;</span><br><span class="line">  inpValObj: &#123;</span><br><span class="line">    deep: <span class="literal">true</span>,</span><br><span class="line">    <span class="function"><span class="title">handler</span>(<span class="params">newVal, oldVal</span>)</span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(newVal)</span><br><span class="line">      <span class="built_in">console</span>.log(oldVal)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>深度监听虽然可以监听到对象的变化，但是无法监听到对象具体哪个属性发生变化。</p><h2 id="install"><a href="#install" class="headerlink" title="install"></a>install</h2><p>场景:在 Vue.use()说到,执行该方法会触发 install<br>是开发 vue 的插件,这个方法的第一个参数是 Vue 构造器，第二个参数是一个可选的选项对象(可选)</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> MyPlugin = &#123;&#125;</span><br><span class="line">MyPlugin.install = <span class="function"><span class="keyword">function</span>(<span class="params">Vue, options</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 2. 添加全局资源,第二个参数传一个值默认是 update 对应的值</span></span><br><span class="line">  Vue.directive(<span class="string">&#x27;click&#x27;</span>, &#123;</span><br><span class="line">    <span class="function"><span class="title">bind</span>(<span class="params">el, binding, vnode, oldVnode</span>)</span> &#123;</span><br><span class="line">      <span class="comment">//做绑定的准备工作,添加时间监听</span></span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;指令 my-directive 的 bind 执行啦&#x27;</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    inserted: <span class="function"><span class="keyword">function</span>(<span class="params">el</span>) </span>&#123;</span><br><span class="line">      <span class="comment">//获取绑定的元素</span></span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;指令 my-directive 的 inserted 执行啦&#x27;</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    update: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="comment">//根据获得的新值执行对应的更新</span></span><br><span class="line">      <span class="comment">//对于初始值也会调用一次</span></span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;指令 my-directive 的 update 执行啦&#x27;</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    componentUpdated: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;指令 my-directive 的 componentUpdated 执行啦&#x27;</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    unbind: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="comment">//做清理操作</span></span><br><span class="line">      <span class="comment">//比如移除 bind 时绑定的事件监听器</span></span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;指令 my-directive 的 unbind 执行啦&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 3. 注入组件</span></span><br><span class="line">  Vue.mixin(&#123;</span><br><span class="line">    created: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;注入组件的created被调用啦&#x27;</span>)</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;options的值为&#x27;</span>, options)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 4. 添加实例方法</span></span><br><span class="line">  Vue.prototype.$myMethod = <span class="function"><span class="keyword">function</span>(<span class="params">methodOptions</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;实例方法myMethod被调用啦&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//调用 MyPlugin</span></span><br><span class="line">Vue.use(MyPlugin, &#123; <span class="attr">someOption</span>: <span class="literal">true</span> &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//3.挂载</span></span><br><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  el: <span class="string">&#x27;#app&#x27;</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="mixins"><a href="#mixins" class="headerlink" title="mixins"></a>mixins</h2><p>场景:有些组件有些重复的 js 逻辑,如校验手机验证码,解析时间等,mixins 就可以实现这种混入<br>mixins 值是一个数组</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mixin = &#123;</span><br><span class="line">  <span class="function"><span class="title">created</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.dealTime()</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    <span class="function"><span class="title">dealTime</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;这是 mixin 的 dealTime 里面的方法&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  mixins: [mixin]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="render"><a href="#render" class="headerlink" title="render"></a>render</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">&quot;level === 1&quot;</span>&gt;</span> <span class="tag">&lt;<span class="name">slot</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">v-else-if</span>=<span class="string">&quot;level === 2&quot;</span>&gt;</span> <span class="tag">&lt;<span class="name">slot</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span> <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span> <span class="attr">v-else-if</span>=<span class="string">&quot;level === 3&quot;</span>&gt;</span> <span class="tag">&lt;<span class="name">slot</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span> <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span> <span class="attr">v-else-if</span>=<span class="string">&quot;level === 4&quot;</span>&gt;</span> <span class="tag">&lt;<span class="name">slot</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span> <span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">strong</span> <span class="attr">v-else-if</span>=<span class="string">&quot;level === 5&quot;</span>&gt;</span> <span class="tag">&lt;<span class="name">slot</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span> <span class="tag">&lt;/<span class="name">stong</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">textarea</span> <span class="attr">v-else-if</span>=<span class="string">&quot;level === 6&quot;</span>&gt;</span> <span class="tag">&lt;<span class="name">slot</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span> <span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line">// 利用 render 函数精简代码</span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">child</span> <span class="attr">:level</span>=<span class="string">&quot;level&quot;</span>&gt;</span>Hello world!<span class="tag">&lt;/<span class="name">child</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&#x27;text/javascript&#x27;</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"></span><br><span class="line"><span class="javascript">Vue.component(<span class="string">&#x27;child&#x27;</span>, &#123;</span></span><br><span class="line"><span class="javascript">  <span class="function"><span class="title">render</span>(<span class="params">h</span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">const</span> tag = [<span class="string">&#x27;div&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;strong&#x27;</span>, <span class="string">&#x27;h1&#x27;</span>, <span class="string">&#x27;h2&#x27;</span>, <span class="string">&#x27;textarea&#x27;</span>][<span class="built_in">this</span>.level-<span class="number">1</span>]</span></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> h(tag, <span class="built_in">this</span>.$slots.default)</span></span><br><span class="line">  &#125;,</span><br><span class="line">  props: &#123;</span><br><span class="line"><span class="javascript">    level: &#123;  <span class="attr">type</span>: <span class="built_in">Number</span>,  <span class="attr">required</span>: <span class="literal">true</span>  &#125;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">  name: <span class="string">&#x27;hehe&#x27;</span>,</span></span><br><span class="line"><span class="javascript">  <span class="function"><span class="title">data</span>(<span class="params"></span>)</span> &#123; <span class="keyword">return</span> &#123; <span class="attr">level</span>: <span class="number">3</span> &#125; &#125;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>render 和 template 对比：</p><ul><li>前者适合复杂逻辑，后者适合简单逻辑;</li><li>前者属于自定义 Render 函数，后者在声明时渲染;</li><li>前者的性能较高，后者性能较低。</li></ul><h2 id="extends"><a href="#extends" class="headerlink" title="extends"></a>extends</h2><p>extends 用法和 mixins 很相似,只不过接收的参数是简单的选项对象或构造函数,所以 extends 只能单次扩展一个组件</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> extend = &#123;</span><br><span class="line">  <span class="function"><span class="title">created</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.dealTime()</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    <span class="function"><span class="title">dealTime</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;这是 mixin 的 dealTime 里面的方法&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="keyword">extends</span>: extend</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="v-pre"><a href="#v-pre" class="headerlink" title="v-pre"></a>v-pre</h2><p>场景:vue 是响应式系统,但是有些静态的标签不需要多次编译,这样可以节省性能</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">v-pre</span>&gt;</span>&#123;&#123; this will not be compiled &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span> 显示的是&#123;&#123; this will not be compiled &#125;&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">v-pre</span>&gt;</span>&#123;&#123;msg&#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span> 即使 data 里面定义了 msg 这里仍然是显示的&#123;&#123;msg&#125;&#125;</span><br></pre></td></tr></table></figure><h2 id="v-once"><a href="#v-once" class="headerlink" title="v-once"></a>v-once</h2><p>场景:有些 template 中的静态 dom 没有改变,这时就只需要渲染一次,可以降低性能开销</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;span v-once&gt; 这时只需要加载一次的标签&lt;/span&gt;</span><br></pre></td></tr></table></figure><p>v-once 和 v-pre 的区别:<br>v-once 只渲染一次；v-pre 不编译,原样输出</p><h2 id="v-cloak"><a href="#v-cloak" class="headerlink" title="v-cloak"></a>v-cloak</h2><p>场景:在网速慢的情况下,在使用 vue 绑定数据的时候，渲染页面时会出现变量闪烁<br>用法:这个指令保持在元素上直到关联实例结束编译。和 CSS 规则如 [v-cloak] { display: none } 一起用时，这个指令可以隐藏未编译的 Mustache 标签直到实例准备完毕</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// template 中</span></span><br><span class="line"></span><br><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;#app&quot;</span> v-cloak&gt;</span><br><span class="line">    &lt;p&gt;&#123;&#123;value.name&#125;&#125;&lt;/p&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// css 中</span></span><br><span class="line">[v-cloak] &#123;</span><br><span class="line">display: none;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这样就可以解决闪烁,但是会出现白屏,这样可以结合骨架屏使用</p><h2 id="Vue-set"><a href="#Vue-set" class="headerlink" title="Vue.set"></a>Vue.set</h2><p>场景:当你利用索引直接设置一个数组项时或你修改数组的长度时,由于 Object.defineprototype()方法限制,数据不响应式更新<br>不过 vue.3.x 将利用 proxy 这个问题将得到解决<br>解决方案:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 利用 set</span></span><br><span class="line"><span class="built_in">this</span>.\$set(arr, index, item)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 利用数组 push(),splice()</span></span><br></pre></td></tr></table></figure><h2 id="Vue-use"><a href="#Vue-use" class="headerlink" title="Vue.use"></a>Vue.use</h2><p>场景:我们使用 element 时会先 import,再 Vue.use()一下,实际上就是注册组件,触发 install 方法;<br>这个在组件调用会经常使用到;<br>会自动组织多次注册相同的插件.</p><h2 id="Vue-config"><a href="#Vue-config" class="headerlink" title="Vue.config"></a>Vue.config</h2><h3 id="keyCodes"><a href="#keyCodes" class="headerlink" title="keyCodes"></a>keyCodes</h3><p>场景:自定义按键修饰符别名</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 将键码为 113 定义为 f2</span></span><br><span class="line">Vue.config.keyCodes.f2 = <span class="number">113</span>;</span><br><span class="line">&lt;input type=<span class="string">&quot;text&quot;</span> @keyup.f2=<span class="string">&quot;add&quot;</span>/&gt;</span><br></pre></td></tr></table></figure><h3 id="performance"><a href="#performance" class="headerlink" title="performance"></a>performance</h3><p>场景:监听性能</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Vue.config.performance = <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>复制代码只适用于开发模式和支持 performance.mark API 的浏览器上</p><h3 id="errorHandler"><a href="#errorHandler" class="headerlink" title="errorHandler"></a>errorHandler</h3><p>场景:指定组件的渲染和观察期间未捕获错误的处理函数<br>规则:</p><ul><li>从 2.2.0 起，这个钩子也会捕获组件生命周期钩子里的错误。同样的，当这个钩子是 undefined 时，被捕获的错误会通过 console.error 输出而避免应用崩溃</li><li>从 2.4.0 起，这个钩子也会捕获 Vue 自定义事件处理函数内部的错误了</li><li>从 2.6.0 起，这个钩子也会捕获 v-on DOM 监听器内部抛出的错误。另外，如果任何被覆盖的钩子或处理函数返回一个 Promise 链 (例如 async 函数)，则来自其 Promise 链的错误也会被处理</li></ul><p>使用</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Vue.config.errorHandler = <span class="function"><span class="keyword">function</span>(<span class="params">err, vm, info</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// handle error</span></span><br><span class="line">  <span class="comment">// `info` 是 Vue 特定的错误信息，比如错误所在的生命周期钩子</span></span><br><span class="line">  <span class="comment">// 只在 2.2.0+ 可用</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="warnHandler"><a href="#warnHandler" class="headerlink" title="warnHandler"></a>warnHandler</h3><p>2.4.0 新增 1.场景:为 Vue 的运行时警告赋予一个自定义处理函数,只会在开发者环境下生效 2.用法:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Vue.config.warnHandler = <span class="function"><span class="keyword">function</span>(<span class="params">msg, vm, trace</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// `trace` 是组件的继承关系追踪</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Vue-extend"><a href="#Vue-extend" class="headerlink" title="Vue.extend"></a>Vue.extend</h2><p>场景:vue 组件中有些需要将一些元素挂载到元素上,这个时候 extend 就起到作用了<br>是构造一个组件的语法器<br>写法:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建构造器</span></span><br><span class="line"><span class="keyword">var</span> Profile = Vue.extend(&#123;</span><br><span class="line">  template: <span class="string">&#x27;&lt;p&gt;&#123;&#123;extendData&#125;&#125;&lt;/br&gt;实例传入的数据为:&#123;&#123;propsExtend&#125;&#125;&lt;/p&gt;&#x27;</span>, <span class="comment">//template 对应的标签最外层必须只有一个标签</span></span><br><span class="line">  data: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      extendData: <span class="string">&#x27;这是 extend 扩展的数据&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  props: [<span class="string">&#x27;propsExtend&#x27;</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建的构造器可以挂载到元素上,也可以通过 components 或 Vue.component()注册使用</span></span><br><span class="line"><span class="comment">// 挂载到一个元素上。可以通过 propsData 传参.</span></span><br><span class="line"><span class="keyword">new</span> Profile(&#123; <span class="attr">propsData</span>: &#123; <span class="attr">propsExtend</span>: <span class="string">&#x27;我是实例传入的数据&#x27;</span> &#125; &#125;).\$mount(<span class="string">&#x27;#app-extend&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 通过 components 或 Vue.component()注册</span></span><br><span class="line">Vue.component(<span class="string">&#x27;Profile&#x27;</span>, Profile)</span><br></pre></td></tr></table></figure><h2 id="Vue-filter"><a href="#Vue-filter" class="headerlink" title="Vue.filter"></a>Vue.filter</h2><p>场景:时间戳转化成年月日这是一个公共方法,所以可以抽离成过滤器使用</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用</span></span><br><span class="line"><span class="comment">// 在双花括号中</span></span><br><span class="line">&#123;</span><br><span class="line">  &#123;</span><br><span class="line">    message | capitalize</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 在 `v-bind` 中</span></span><br><span class="line"></span><br><span class="line">;<span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-bind:id</span>=<span class="string">&quot;rawId | formatId&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 全局注册</span></span><br><span class="line">Vue.filter(<span class="string">&#x27;stampToYYMMDD&#x27;</span>, <span class="function"><span class="params">value</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 处理逻辑</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 局部注册</span></span><br><span class="line">filters: &#123;</span><br><span class="line">  stampToYYMMDD: <span class="function"><span class="params">value</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 处理逻辑</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 多个过滤器全局注册</span></span><br><span class="line"><span class="comment">// /src/common/filters.js</span></span><br><span class="line"><span class="keyword">let</span> dateServer = <span class="function"><span class="params">value</span> =&gt;</span> value.replace(<span class="regexp">/(\d&#123;4&#125;)(\d&#123;2&#125;)(\d&#123;2&#125;)/g</span>, <span class="string">&#x27;$1-$2-$3&#x27;</span>)</span><br><span class="line"><span class="keyword">export</span> &#123; dateServer &#125;</span><br><span class="line"><span class="comment">// /src/main.js</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> custom <span class="keyword">from</span> <span class="string">&#x27;./common/filters/custom&#x27;</span></span><br><span class="line"><span class="built_in">Object</span>.keys(custom).forEach(<span class="function"><span class="params">key</span> =&gt;</span> Vue.filter(key, custom[key]))</span><br></pre></td></tr></table></figure><h2 id="Vue-compile"><a href="#Vue-compile" class="headerlink" title="Vue.compile"></a>Vue.compile</h2><p>场景:在 render 函数中编译模板字符串。只在独立构建时有效</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> res = Vue.compile(<span class="string">&#x27;&lt;div&gt;&lt;span&gt;&#123;&#123; msg &#125;&#125;&lt;/span&gt;&lt;/div&gt;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  data: &#123;</span><br><span class="line">    msg: <span class="string">&#x27;hello&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  render: res.render,</span><br><span class="line">  staticRenderFns: res.staticRenderFns</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="Vue-version"><a href="#Vue-version" class="headerlink" title="Vue.version"></a>Vue.version</h2><p>场景:有些开发插件需要针对不同 vue 版本做兼容,所以就会用到 Vue.version<br>用法:Vue.version()可以获取 vue 版本</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> version = <span class="built_in">Number</span>(Vue.version.split(<span class="string">&#x27;.&#x27;</span>)[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (version === <span class="number">2</span>) &#123;</span><br><span class="line">  <span class="comment">// Vue v2.x.x</span></span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (version === <span class="number">1</span>) &#123;</span><br><span class="line">  <span class="comment">// Vue v1.x.x</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="comment">// Unsupported versions of Vue</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Vue-nextTick"><a href="#Vue-nextTick" class="headerlink" title="Vue.nextTick"></a>Vue.nextTick</h2><p>场景:页面加载时需要让文本框获取焦点</p><p>用法:在下次 DOM 更新循环结束之后执行延迟回调。在修改数据之后立即使用这个方法，获取更新后的 DOM</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">mounted</span>(<span class="params"></span>)</span>&#123; <span class="comment">//因为 mounted 阶段 dom 并未渲染完毕,所以需要$nextTick</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">this</span>.$nextTick(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.$refs.inputs.focus() <span class="comment">//通过 \$refs 获取 dom 并绑定 focus 方法</span></span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="Vue-directive"><a href="#Vue-directive" class="headerlink" title="Vue.directive"></a>Vue.directive</h2><h4 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h4><p>场景:官方给我们提供了很多指令,但是我们如果想将文字变成指定的颜色定义成指令使用,这个时候就需要用到 Vue.directive</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 全局定义</span></span><br><span class="line">Vue.directive(<span class="string">&#x27;change-color&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">el, binding, vnode</span>) </span>&#123;</span><br><span class="line">  el.style[<span class="string">&#x27;color&#x27;</span>] = binding.value</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 使用</span></span><br><span class="line">&lt;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;div v-change-color=“color”&gt;&#123;&#123;message&#125;&#125;&lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">default</span>&#123;</span><br><span class="line">    <span class="function"><span class="title">data</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      <span class="keyword">return</span>&#123;</span><br><span class="line">        color:<span class="string">&#x27;green&#x27;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h4 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a>生命周期</h4><ul><li>bind 只调用一次，指令第一次绑定到元素时候调用，用这个钩子可以定义一个绑定时执行一次的初始化动作。</li><li>inserted:被绑定的元素插入父节点的时候调用(父节点存在即可调用，不必存在 document 中)</li><li>update: 被绑定与元素所在模板更新时调用，而且无论绑定值是否有变化，通过比较更新前后的绑定值，忽略不必要的模板更新</li><li>componentUpdate :被绑定的元素所在模板完成一次更新更新周期的时候调用</li><li>unbind: 只调用一次，指令月元素解绑的时候调用</li></ul><h2 id="Object-freeze"><a href="#Object-freeze" class="headerlink" title="Object.freeze"></a>Object.freeze</h2><p>场景:一个长列表数据,一般不会更改,但是 vue 会做 getter 和 setter 的转换<br>用法:是 ES5 新增的特性，可以冻结一个对象，防止对象被修改<br>支持:vue 1.0.18+对其提供了支持，对于 data 或 vuex 里使用 freeze 冻结了的对象，vue 不会做 getter 和 setter 的转换<br>注意:冻结只是冻结里面的单个属性,引用地址还是可以更改</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  data: &#123;</span><br><span class="line">    <span class="comment">// vue 不会对 list 里的 object 做 getter、setter 绑定</span></span><br><span class="line">    list: <span class="built_in">Object</span>.freeze([&#123; <span class="attr">value</span>: <span class="number">1</span> &#125;, &#123; <span class="attr">value</span>: <span class="number">2</span> &#125;])</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">mounted</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="comment">// 界面不会有响应,因为单个属性被冻结</span></span><br><span class="line">    <span class="built_in">this</span>.list[<span class="number">0</span>].value = <span class="number">100</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 下面两种做法，界面都会响应</span></span><br><span class="line">    <span class="built_in">this</span>.list = [&#123; <span class="attr">value</span>: <span class="number">100</span> &#125;, &#123; <span class="attr">value</span>: <span class="number">200</span> &#125;]</span><br><span class="line">    <span class="built_in">this</span>.list = <span class="built_in">Object</span>.freeze([&#123; <span class="attr">value</span>: <span class="number">100</span> &#125;, &#123; <span class="attr">value</span>: <span class="number">200</span> &#125;])</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="require-context"><a href="#require-context" class="headerlink" title="require.context"></a>require.context</h2><p>页面导入多个组件:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> titleCom <span class="keyword">from</span> <span class="string">&#x27;@/components/home/titleCom&#x27;</span></span><br><span class="line"><span class="keyword">import</span> bannerCom <span class="keyword">from</span> <span class="string">&#x27;@/components/home/bannerCom&#x27;</span></span><br><span class="line"><span class="keyword">import</span> cellCom <span class="keyword">from</span> <span class="string">&#x27;@/components/home/cellCom&#x27;</span></span><br><span class="line">components: &#123;</span><br><span class="line">  titleCom, bannerCom, cellCom</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这样写比较麻烦, 可以利用 <code>require.context()</code> 一次完成引入</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> files = <span class="built_in">require</span>.context(<span class="string">&#x27;@/components/home&#x27;</span>, <span class="literal">false</span>, <span class="regexp">/\.vue\$/</span>)</span><br><span class="line"><span class="keyword">const</span> modules = &#123;&#125;</span><br><span class="line">files.keys().forEach(<span class="function"><span class="params">key</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> name = path.basename(key, <span class="string">&#x27;.vue&#x27;</span>)</span><br><span class="line">  modules[name] = files(key).default || files(key)</span><br><span class="line">&#125;)</span><br><span class="line">components: modules</span><br></pre></td></tr></table></figure><p><code>require.context(directory,useSubdirectories,regExp)</code> 是 <code>webpack</code> 内部定义的方法, 它接收三个参数:</p><ul><li>directory：需要检索的目录</li><li>useSubdirectories：是否检索子目录</li><li>regExp: 匹配文件名的正则表达式</li></ul><h2 id="vue-loader"><a href="#vue-loader" class="headerlink" title="vue-loader"></a>vue-loader</h2><h3 id="preserveWhitespace"><a href="#preserveWhitespace" class="headerlink" title="preserveWhitespace"></a>preserveWhitespace</h3><p>场景:开发 vue 代码一般会有空格,这个时候打包压缩如果不去掉空格会加大包的体积<br>配置 preserveWhitespace 可以减小包的体积</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  vue: &#123;</span><br><span class="line">    preserveWhitespace: <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="transformToRequire"><a href="#transformToRequire" class="headerlink" title="transformToRequire"></a>transformToRequire</h3><p>场景:以前在写 Vue 的时候经常会写到这样的代码：把图片提前 require 传给一个变量再传给组件</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// page 代码</span></span><br><span class="line">&lt;template&gt;</span><br><span class="line"></span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;avatar :img-src=<span class="string">&quot;imgSrc&quot;</span>&gt;&lt;/avatar&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    created () &#123;</span><br><span class="line">      <span class="built_in">this</span>.imgSrc = <span class="built_in">require</span>(<span class="string">&#x27;./assets/default-avatar.png&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>现在:通过配置 transformToRequire 后，就可以直接配置，这样 vue-loader 会把对应的属性自动 require 之后传给组件</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// vue-cli 2.x在vue-loader.conf.js 默认配置是</span></span><br><span class="line">transformToRequire: &#123;</span><br><span class="line">    video: [<span class="string">&#x27;src&#x27;</span>, <span class="string">&#x27;poster&#x27;</span>],</span><br><span class="line">    source: <span class="string">&#x27;src&#x27;</span>,</span><br><span class="line">    img: <span class="string">&#x27;src&#x27;</span>,</span><br><span class="line">    image: <span class="string">&#x27;xlink:href&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 配置文件,如果是 vue-cli2.x 在 vue-loader.conf.js 里面修改</span></span><br><span class="line">avatar: [<span class="string">&#x27;default-src&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// vue-cli 3.x 在 vue.config.js</span></span><br><span class="line"><span class="comment">// vue-cli 3.x 将 transformToRequire 属性换为了 transformAssetUrls</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">pages,</span><br><span class="line">chainWebpack: <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">config</span><br><span class="line">.module</span><br><span class="line">.rule(<span class="string">&#x27;vue&#x27;</span>)</span><br><span class="line">.use(<span class="string">&#x27;vue-loader&#x27;</span>)</span><br><span class="line">.loader(<span class="string">&#x27;vue-loader&#x27;</span>)</span><br><span class="line">.tap(<span class="function"><span class="params">options</span> =&gt;</span> &#123;</span><br><span class="line">options.transformAssetUrls = &#123;</span><br><span class="line">avatar: <span class="string">&#x27;img-src&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> options;</span><br><span class="line">&#125;);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// page 代码可以简化为</span></span><br><span class="line">&lt;template&gt;</span><br><span class="line"></span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;avatar img-src=<span class="string">&quot;./assets/default-avatar.png&quot;</span>&gt;&lt;/avatar&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><h2 id="vue-router"><a href="#vue-router" class="headerlink" title="vue-router"></a>vue-router</h2><p>场景:Vue-router 是官方提供的路由插件</p><h3 id="缓存和动画"><a href="#缓存和动画" class="headerlink" title="缓存和动画"></a>缓存和动画</h3><p>1.路由是使用官方组件 vue-router,使用方法相信大家非常熟悉; 2.这里我就叙述下路由的缓存和动画; 3.可以用 exclude(除了)或者 include(包括),2.1.0 新增来坐判断</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;transition&gt;</span><br><span class="line">&lt;keep-alive :include=<span class="string">&quot;[&#x27;a&#x27;, &#x27;b&#x27;]&quot;</span>&gt;</span><br><span class="line"><span class="comment">//或 include=&quot;a,b&quot; :include=&quot;/a|b/&quot;,a 和 b 表示组件的 name</span></span><br><span class="line"><span class="comment">//因为有些页面,如试试数据统计,要实时刷新,所以就不需要缓存</span></span><br><span class="line">&lt;router-view/&gt; <span class="comment">//路由标签</span></span><br><span class="line">&lt;/keep-alive&gt;</span><br><span class="line">&lt;router-view exclude=<span class="string">&quot;c&quot;</span>/&gt;</span><br><span class="line"><span class="comment">// c 表示组件的 name 值</span></span><br><span class="line">&lt;/transition&gt;</span><br></pre></td></tr></table></figure><p>注:匹配首先检查组件自身的 name 选项，如果 name 选项不可用，则匹配它的局部注册名称 (父组件 components 选项的键值)。匿名组件不能被匹配 4.用 v-if 做判断,组件会重新渲染,但是不用一一列举组件 name</p><h3 id="全局路由钩子"><a href="#全局路由钩子" class="headerlink" title="全局路由钩子"></a>全局路由钩子</h3><p>1.router.beforeEach</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">router.beforeEach(<span class="function">(<span class="params">to, <span class="keyword">from</span>, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;全局前置守卫：beforeEach -- next 需要调用&#x27;</span>) <span class="comment">//一般登录拦截用这个,也叫导航钩子守卫</span></span><br><span class="line">  <span class="keyword">if</span> (path === <span class="string">&#x27;/login&#x27;</span>) &#123;</span><br><span class="line">    next()</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (token) &#123;</span><br><span class="line">    next()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>2.router.beforeResolve (v 2.5.0+)<br>和 beforeEach 类似，区别是在导航被确认之前，同时在所有组件内守卫和异步路由组件被解析之后，解析守卫就被调用<br>即在 beforeEach 之后调用<br>3.router.afterEach<br>全局后置钩子<br>在所有路由跳转结束的时候调用<br>这些钩子不会接受 next 函数也不会改变导航本身</p><h3 id="组件路由钩子"><a href="#组件路由钩子" class="headerlink" title="组件路由钩子"></a>组件路由钩子</h3><p>1.beforeRouteEnter<br>在渲染该组件的对应路由被确认前调用，用法和参数与 router.beforeEach 类似，next 需要被主动调用<br>此时组件实例还未被创建，不能访问 this<br>可以通过传一个回调给 next 来访问组件实例。在导航被确认的时候执行回调，并且把组件实例作为回调方法的参数</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">beforeRouteEnter (to, <span class="keyword">from</span>, next) &#123;</span><br><span class="line"><span class="comment">// 这里还无法访问到组件实例，this === undefined</span></span><br><span class="line">next( <span class="function"><span class="params">vm</span> =&gt;</span> &#123;</span><br><span class="line"><span class="comment">// 通过 `vm` 访问组件实例</span></span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2.beforeRouteUpdate (v 2.2+)<br>在当前路由改变，并且该组件被复用时调用，可以通过 this 访问实例， next 需要被主动调用，不能传回调<br>3.beforeRouteLeave<br>导航离开该组件的对应路由时调用，可以访问组件实例 this，next 需要被主动调用，不能传回调</p><h3 id="路由模式"><a href="#路由模式" class="headerlink" title="路由模式"></a>路由模式</h3><p>设置 mode 属性:hash 或 history</p><h3 id="router"><a href="#router" class="headerlink" title="$router"></a><code>$router</code></h3><p>this.$router.push():跳转到不同的 url，但这个方法回向 history 栈添加一个记录，点击后退会返回到上一个页面<br>this.$router.replace():不会有记录<br>this.$router.go(n):n 可为正数可为负数。正数返回上一个页面,类似 window.history.go(n)</p><h3 id="route"><a href="#route" class="headerlink" title="$route"></a><code>$route</code></h3><p>表示当前跳转的路由对象,属性有:</p><ul><li>name:路由名称</li><li>path:路径</li><li>query:传参接收值</li><li>params:传参接收值</li><li>fullPath:完成解析后的 URL，包含查询参数和 hash 的完整路径</li><li>matched:路由记录副本</li><li>redirectedFrom:如果存在重定向，即为重定向来源的路由的名字</li><li>this.$route.params.id:获取通过 params 或/:id 传参的参数</li><li>this.$route.query.id:获取通过 query 传参的参数</li></ul><h3 id="router-view"><a href="#router-view" class="headerlink" title="router-view"></a>router-view</h3><p>场景:由于 Vue 会复用相同组件, 即 /page/1 =&gt; /page/2 或者 /page?id=1 =&gt; /page?id=2 这类链接跳转时, 将不在执行 created, mounted 之类的钩子</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">router-view</span> <span class="attr">:key</span>=<span class="string">&quot;$route.fullPath&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br></pre></td></tr></table></figure><p>这样组件的 created 和 mounted 就都会执行</p><h2 id="事件修饰符"><a href="#事件修饰符" class="headerlink" title="事件修饰符"></a>事件修饰符</h2><ul><li>.stop:阻止冒泡</li><li>.prevent:阻止默认行为</li><li>.self:仅绑定元素自身触发</li><li>.once: 2.1.4 新增,只触发一次</li><li>.passive: 2.3.0 新增,滚动事件的默认行为 (即滚动行为) 将会立即触发,不能和.prevent 一起使用</li></ul><h2 id="按键修饰符"><a href="#按键修饰符" class="headerlink" title="按键修饰符"></a>按键修饰符</h2><p>场景:有的时候需要监听键盘的行为,如按下 enter 去查询接口等</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 对应键盘上的关键字</span></span><br><span class="line">.enter</span><br><span class="line">.tab</span><br><span class="line">.delete (捕获“删除”和“退格”键)</span><br><span class="line">.esc</span><br><span class="line">.space</span><br><span class="line">.up</span><br><span class="line">.down</span><br><span class="line">.left</span><br><span class="line">.right</span><br></pre></td></tr></table></figure><h2 id="模板调试"><a href="#模板调试" class="headerlink" title="模板调试"></a>模板调试</h2><p>场景:在 Vue 开发过程中, 经常会遇到 template 模板渲染时 JavaScript 变量出错的问题, 此时也许你会通过 console.log 来进行调试<br>这时可以在开发环境挂载一个 log 函数</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.js</span></span><br><span class="line">Vue.prototype.\$log = <span class="built_in">window</span>.console.log;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 组件内部</span></span><br><span class="line"></span><br><span class="line">&lt;div&gt;&#123;&#123;$log(info)&#125;&#125;&lt;/div&gt;</span><br></pre></td></tr></table></figure><h2 id="路径别名"><a href="#路径别名" class="headerlink" title="路径别名"></a>路径别名</h2><p>场景:在开发过程中，我们经常需要引入各种文件，如图片、CSS、JS 等，为了避免写很长的相对路径（../），我们可以为不同的目录配置一个别名<br>vue-cli 2.x 配置</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在 webpack.base.config.js 中的 resolve 配置项，在其 alias 中增加别名</span></span><br><span class="line">resolve: &#123;</span><br><span class="line">extensions: [<span class="string">&#x27;.js&#x27;</span>, <span class="string">&#x27;.vue&#x27;</span>, <span class="string">&#x27;.json&#x27;</span>],</span><br><span class="line">alias: &#123;</span><br><span class="line"><span class="string">&#x27;vue\$&#x27;</span>: <span class="string">&#x27;vue/dist/vue.esm.js&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;@&#x27;</span>: resolve(<span class="string">&#x27;src&#x27;</span>),</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>vue-cli 3.x 配置</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在根目录下创建 vue.config.js</span></span><br><span class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">resolve</span> (<span class="params">dir</span>) </span>&#123;</span><br><span class="line"><span class="built_in">console</span>.log(**dirname)</span><br><span class="line"><span class="keyword">return</span> path.join(**dirname, dir)</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">chainWebpack: <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">config.resolve.alias</span><br><span class="line">.set(key, value) <span class="comment">// key,value 自行定义，比如.set(&#x27;@@&#x27;, resolve(&#x27;src/components&#x27;))</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="图片加载"><a href="#图片加载" class="headerlink" title="图片加载"></a>图片加载</h2><p>场景:有些时候后台返回图片地址不一定能打开,所以这个时候应该加一张默认图片</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// page 代码</span></span><br><span class="line">&lt;img :src=<span class="string">&quot;imgUrl&quot;</span> @error=<span class="string">&quot;handleError&quot;</span> alt=<span class="string">&quot;&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span>&#123;</span><br><span class="line">  <span class="function"><span class="title">data</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span>&#123;</span><br><span class="line">      imgUrl:<span class="string">&#x27;&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods:&#123;</span><br><span class="line">    <span class="function"><span class="title">handleError</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">      e.target.src=reqiure(<span class="string">&#x27;图片路径&#x27;</span>) <span class="comment">//当然如果项目配置了transformToRequire,参考上面 27.2</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h2 id="CSS-样式"><a href="#CSS-样式" class="headerlink" title="CSS 样式"></a>CSS 样式</h2><p>局部样式</p><p>Vue 中 style 标签的 scoped 属性表示它的样式只作用于当前模块，是样式私有化. 2.渲染的规则/原理：<br>给 HTML 的 DOM 节点添加一个 不重复的 data 属性 来表示 唯一性<br>在对应的 CSS 选择器 末尾添加一个当前组件的 data 属性选择器来私有化样式，如：.demo[data-v-2311c06a]{}<br>如果引入 less 或 sass 只会在最后一个元素上设置</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 原始代码</span></span><br><span class="line">&lt;template&gt;</span><br><span class="line"></span><br><span class="line">  &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;demo&quot;</span>&gt;</span><br><span class="line">    &lt;span <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;content&quot;</span>&gt;</span><br><span class="line">      Vue.js scoped</span><br><span class="line">    &lt;/span&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=<span class="string">&quot;less&quot;</span> scoped&gt;</span><br><span class="line">  .demo&#123;</span><br><span class="line">    font-size: <span class="number">16</span>px;</span><br><span class="line">    .content&#123;</span><br><span class="line">      color: red;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 浏览器渲染效果</span></span><br><span class="line"></span><br><span class="line">&lt;div data-v-fed36922&gt;</span><br><span class="line">  Vue.js scoped</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;style type=<span class="string">&quot;text/css&quot;</span>&gt;</span><br><span class="line">.demo[data-v-<span class="number">0</span>39c5b43] &#123;</span><br><span class="line">  font-size: <span class="number">14</span>px;</span><br><span class="line">&#125;</span><br><span class="line">.demo .content[data-v-<span class="number">0</span>39c5b43] &#123; <span class="comment">//.demo 上并没有加 data 属性</span></span><br><span class="line">  color: red;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><p>deep 属性</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 上面样式加一个 /deep/</span></span><br><span class="line">&lt;style lang=<span class="string">&quot;less&quot;</span> scoped&gt;</span><br><span class="line">  .demo&#123;</span><br><span class="line">    font-size: <span class="number">14</span>px;</span><br><span class="line">  &#125;</span><br><span class="line">  .demo /deep/ .content&#123;</span><br><span class="line">    color: blue;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 浏览器编译后</span></span><br><span class="line"></span><br><span class="line">&lt;style type=<span class="string">&quot;text/css&quot;</span>&gt;</span><br><span class="line">.demo[data-v-<span class="number">0</span>39c5b43] &#123;</span><br><span class="line">  font-size: <span class="number">14</span>px;</span><br><span class="line">&#125;</span><br><span class="line">.demo[data-v-<span class="number">0</span>39c5b43] .content &#123;</span><br><span class="line">  color: blue;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.nirongfei.site/blog-hexo/2018/06/08/frontend/180608/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/blog-hexo/images/avatar.png"><meta itemprop="name" content="阳明先生"><meta itemprop="description" content="知之真切笃实处即是行 行之明觉精察处即是知"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="阳明先生"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/blog-hexo/2018/06/08/frontend/180608/" class="post-title-link" itemprop="url">SVG动画学习总结</a></h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2018-06-08 00:00:00" itemprop="dateCreated datePublished" datetime="2018-06-08T00:00:00+08:00">2018-06-08</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2020-11-18 15:57:04" itemprop="dateModified" datetime="2020-11-18T15:57:04+08:00">2020-11-18</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/blog-hexo/categories/%E5%89%8D%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">前端</span></a></span></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>15k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>14 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><h2 id="SVG-SMIL"><a href="#SVG-SMIL" class="headerlink" title="SVG SMIL"></a>SVG SMIL</h2><h3 id="SMIL-概述"><a href="#SMIL-概述" class="headerlink" title="SMIL 概述"></a>SMIL 概述</h3><p>SMIL 是指 Synchronized Multimedia Integration Language（同步多媒体集成语言）的首字母缩写简称，是有标准的。</p><p>SMIL 允许你做下面这些事情：</p><ul><li>动画元素的数值属性</li><li>动画属性变换（平移或旋转）</li><li>动画颜色属性</li><li>沿着运动路径运动</li></ul><p>SVG 的动画元素是和 SMIL 开发组合作开发的。SMIL 开发组和 SVG 开发组合作开发了 SMIL 动画规范，在规范中制定了一个基本的 XML 动画特征集合，SVG 吸收了 SMIL 动画规范当中的动画优点，并提供了一些 SVG 继承实现。除了 IE 浏览器以外，其他主流浏览器的支持情况还可以。</p><p>除了可以实现「路径动画」，SVG Animation 最强大的地方在于：只要在页面放几个 <code>animate</code> 元素，没有任何 CSS 和 JS，页面上的元素就可以跑起来。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&quot;320&quot;</span> <span class="attr">height</span>=<span class="string">&quot;320&quot;</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">g</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">text</span> <span class="attr">font-family</span>=<span class="string">&quot;microsoft yahei&quot;</span> <span class="attr">font-size</span>=<span class="string">&quot;120&quot;</span> <span class="attr">y</span>=<span class="string">&quot;160&quot;</span> <span class="attr">x</span>=<span class="string">&quot;160&quot;</span>&gt;</span>马<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">animateTransform</span> <span class="attr">attributeName</span>=<span class="string">&quot;transform&quot;</span> <span class="attr">begin</span>=<span class="string">&quot;0s&quot;</span> <span class="attr">dur</span>=<span class="string">&quot;10s&quot;</span> <span class="attr">type</span>=<span class="string">&quot;rotate&quot;</span> <span class="attr">from</span>=<span class="string">&quot;0 160 160&quot;</span> <span class="attr">to</span>=<span class="string">&quot;360 160 160&quot;</span> <span class="attr">repeatCount</span>=<span class="string">&quot;indefinite&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">g</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><p>请检查您现在使用的浏览器，IE 浏览器(包括 IE11)不支持。</p><p><img src="https://image.zhangxinxu.com/image/blog/201408/2014-08-28_163516.png"></p><h3 id="SMIL-元素"><a href="#SMIL-元素" class="headerlink" title="SMIL 元素"></a>SMIL 元素</h3><h4 id="set"><a href="#set" class="headerlink" title="set"></a>set</h4><p><code>set</code> 意为设置，此元素没有动画效果。虽然 <code>set</code> 虽然不能触发连续的动画，但是可以实现基本的延迟功能, 在特定时间之后修改某个属性值（也可以是 CSS 属性值）。代码如下：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&quot;320&quot;</span> <span class="attr">height</span>=<span class="string">&quot;320&quot;</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">g</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">text</span> <span class="attr">font-family</span>=<span class="string">&quot;microsoft yahei&quot;</span> <span class="attr">font-size</span>=<span class="string">&quot;120&quot;</span> <span class="attr">y</span>=<span class="string">&quot;160&quot;</span> <span class="attr">x</span>=<span class="string">&quot;160&quot;</span>&gt;</span></span><br><span class="line">      马</span><br><span class="line">      <span class="tag">&lt;<span class="name">set</span> <span class="attr">attributeName</span>=<span class="string">&quot;x&quot;</span> <span class="attr">attributeType</span>=<span class="string">&quot;XML&quot;</span> <span class="attr">to</span>=<span class="string">&quot;60&quot;</span> <span class="attr">begin</span>=<span class="string">&quot;3s&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">g</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><p>这里出现了 <code>attributeName</code>, <code>attributeType</code> 等属性。</p><h4 id="animate"><a href="#animate" class="headerlink" title="animate"></a>animate</h4><p>基础动画元素, 实现单属性的动画过渡效果。类似 Snap.svg 的 <code>animate()</code> 方法支持的动画效果。代码如下：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&quot;320&quot;</span> <span class="attr">height</span>=<span class="string">&quot;320&quot;</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">g</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">text</span> <span class="attr">font-family</span>=<span class="string">&quot;microsoft yahei&quot;</span> <span class="attr">font-size</span>=<span class="string">&quot;120&quot;</span> <span class="attr">y</span>=<span class="string">&quot;160&quot;</span> <span class="attr">x</span>=<span class="string">&quot;160&quot;</span>&gt;</span></span><br><span class="line">    马</span><br><span class="line">      <span class="tag">&lt;<span class="name">animate</span> <span class="attr">attributeName</span>=<span class="string">&quot;x&quot;</span> <span class="attr">from</span>=<span class="string">&quot;160&quot;</span> <span class="attr">to</span>=<span class="string">&quot;60&quot;</span> <span class="attr">begin</span>=<span class="string">&quot;0s&quot;</span> <span class="attr">dur</span>=<span class="string">&quot;3s&quot;</span> <span class="attr">repeatCount</span>=<span class="string">&quot;indefinite&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">g</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><p>这里除了新增 <code>from</code>, <code>dur</code> 和 <code>repeatCount</code> 属性。</p><h4 id="animateColor"><a href="#animateColor" class="headerlink" title="animateColor"></a>animateColor</h4><p><code>animate</code> 可以实现其功能与效果，此属性已经被废弃。</p><h4 id="animateTransform"><a href="#animateTransform" class="headerlink" title="animateTransform"></a>animateTransform</h4><p>此元素是实现 <code>transform</code> 变换动画效果的, 这里的 <code>transform</code> 变换与 CSS3 的 <code>transform</code> 变换，以及 Snap.svg.js 中的 <code>transform()</code> 方法都是一个效果。代码如下：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&quot;320&quot;</span> <span class="attr">height</span>=<span class="string">&quot;320&quot;</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">g</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">text</span> <span class="attr">font-family</span>=<span class="string">&quot;microsoft yahei&quot;</span> <span class="attr">font-size</span>=<span class="string">&quot;80&quot;</span> <span class="attr">y</span>=<span class="string">&quot;100&quot;</span> <span class="attr">x</span>=<span class="string">&quot;100&quot;</span>&gt;</span>马<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">animateTransform</span> <span class="attr">attributeName</span>=<span class="string">&quot;transform&quot;</span> <span class="attr">begin</span>=<span class="string">&quot;0s&quot;</span> <span class="attr">dur</span>=<span class="string">&quot;3s&quot;</span>  <span class="attr">type</span>=<span class="string">&quot;scale&quot;</span> <span class="attr">from</span>=<span class="string">&quot;1&quot;</span> <span class="attr">to</span>=<span class="string">&quot;1.5&quot;</span> <span class="attr">repeatCount</span>=<span class="string">&quot;indefinite&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">g</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="animateMotion"><a href="#animateMotion" class="headerlink" title="animateMotion"></a>animateMotion</h4><p><code>animateMotion</code> 元素可以让 SVG 图形沿着特定的 <code>path</code> 路径运动。代码如下：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&quot;360&quot;</span> <span class="attr">height</span>=<span class="string">&quot;200&quot;</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">text</span> <span class="attr">font-family</span>=<span class="string">&quot;microsoft yahei&quot;</span> <span class="attr">font-size</span>=<span class="string">&quot;40&quot;</span> <span class="attr">x</span>=<span class="string">&quot;0&quot;</span> <span class="attr">y</span>=<span class="string">&quot;0&quot;</span> <span class="attr">fill</span>=<span class="string">&quot;#cd0000&quot;</span>&gt;</span>马</span><br><span class="line">    <span class="tag">&lt;<span class="name">animateMotion</span> <span class="attr">path</span>=<span class="string">&quot;M10,80 q100,120 120,20 q140,-50 160,0&quot;</span> <span class="attr">begin</span>=<span class="string">&quot;0s&quot;</span> <span class="attr">dur</span>=<span class="string">&quot;3s&quot;</span> <span class="attr">rotate</span>=<span class="string">&quot;auto&quot;</span> <span class="attr">repeatCount</span>=<span class="string">&quot;indefinite&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">path</span> <span class="attr">d</span>=<span class="string">&quot;M10,80 q100,120 120,20 q140,-50 160,0&quot;</span> <span class="attr">stroke</span>=<span class="string">&quot;#cd0000&quot;</span> <span class="attr">stroke-width</span>=<span class="string">&quot;2&quot;</span> <span class="attr">fill</span>=<span class="string">&quot;none&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><p>跟上面的 SVG 代码相比，虽然少个组标签 <code>g</code> 元素, 但只要动画元素是图形元素子元素就可以。我们可以在 SVG 图形做路径运动时控制其方向, 代码如下:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&quot;360&quot;</span> <span class="attr">height</span>=<span class="string">&quot;200&quot;</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">text</span> <span class="attr">font-family</span>=<span class="string">&quot;microsoft yahei&quot;</span> <span class="attr">font-size</span>=<span class="string">&quot;40&quot;</span> <span class="attr">x</span>=<span class="string">&quot;0&quot;</span> <span class="attr">y</span>=<span class="string">&quot;0&quot;</span> <span class="attr">fill</span>=<span class="string">&quot;#cd0000&quot;</span>&gt;</span>马</span><br><span class="line">    <span class="tag">&lt;<span class="name">animateMotion</span> <span class="attr">path</span>=<span class="string">&quot;M10,80 q100,120 120,20 q140,-50 160,0&quot;</span> <span class="attr">begin</span>=<span class="string">&quot;0s&quot;</span> <span class="attr">dur</span>=<span class="string">&quot;3s&quot;</span> <span class="attr">rotate</span>=<span class="string">&quot;auto&quot;</span> <span class="attr">repeatCount</span>=<span class="string">&quot;indefinite&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">path</span> <span class="attr">d</span>=<span class="string">&quot;M10,80 q100,120 120,20 q140,-50 160,0&quot;</span> <span class="attr">stroke</span>=<span class="string">&quot;#cd0000&quot;</span> <span class="attr">stroke-width</span>=<span class="string">&quot;2&quot;</span> <span class="attr">fill</span>=<span class="string">&quot;none&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><p>实际制作动画的时候，不可能只是一个属性变化。比方说，位置和透明度同时变化，直接组合就可以。代码如下：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&quot;320&quot;</span> <span class="attr">height</span>=<span class="string">&quot;200&quot;</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">text</span> <span class="attr">font-family</span>=<span class="string">&quot;microsoft yahei&quot;</span> <span class="attr">font-size</span>=<span class="string">&quot;120&quot;</span> <span class="attr">y</span>=<span class="string">&quot;160&quot;</span> <span class="attr">x</span>=<span class="string">&quot;160&quot;</span>&gt;</span>马</span><br><span class="line">        <span class="tag">&lt;<span class="name">animate</span> <span class="attr">attributeName</span>=<span class="string">&quot;x&quot;</span> <span class="attr">from</span>=<span class="string">&quot;160&quot;</span> <span class="attr">to</span>=<span class="string">&quot;60&quot;</span> <span class="attr">begin</span>=<span class="string">&quot;0s&quot;</span> <span class="attr">dur</span>=<span class="string">&quot;3s&quot;</span> <span class="attr">repeatCount</span>=<span class="string">&quot;indefinite&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">animate</span> <span class="attr">attributeName</span>=<span class="string">&quot;opacity&quot;</span> <span class="attr">from</span>=<span class="string">&quot;1&quot;</span> <span class="attr">to</span>=<span class="string">&quot;0&quot;</span> <span class="attr">begin</span>=<span class="string">&quot;0s&quot;</span> <span class="attr">dur</span>=<span class="string">&quot;3s&quot;</span> <span class="attr">repeatCount</span>=<span class="string">&quot;indefinite&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="SMIL-参数"><a href="#SMIL-参数" class="headerlink" title="SMIL 参数"></a>SMIL 参数</h3><h4 id="attributeName"><a href="#attributeName" class="headerlink" title="attributeName"></a>attributeName</h4><p>要变化的元素属性名称，可以是元素直接暴露的属性，例如 text 元素上的 <code>x</code>, <code>y</code> 或 <code>font-size</code>; 也可以是 CSS 属性, 例如透明度 <code>opacity</code>.</p><h4 id="attributeType"><a href="#attributeType" class="headerlink" title="attributeType"></a>attributeType</h4><p><code>attributeType</code> 支持三个固定参数 <code>css/xml/auto</code>. 用来表明 <code>attributeName</code> 属性值的列表。<code>x</code>, <code>y</code> 以及 <code>transform</code> 就属于 XML, <code>opacity</code> 就属于 CSS, <code>auto</code> 为默认值，自动判别的意思（实际上是先当成 CSS 处理，如果发现不认识，直接 XML 类别处理）。因此，如果你不确信某属性是 XML 类别还是 CSS 类别的时候，建议不设置 <code>attributeType</code> 值，直接让浏览器自己去判断，几乎无差错。</p><h4 id="from-to-by-values"><a href="#from-to-by-values" class="headerlink" title="from, to, by, values"></a>from, to, by, values</h4><ul><li><code>from</code> 动画的起始值。</li><li><code>to</code> 指定动画的结束值。</li><li><code>by</code> 动画的相对变化值。</li><li><code>values</code> 用分号分隔的一个或多个值，可以是动画的多个关键点值。</li></ul><p><code>from, to, by, values</code> 相互之间存在制约，有以下规则：</p><ul><li>如果动画的起始值与元素的默认值是一样的，<code>from</code> 参数可以省略。</li><li><code>to</code>,<code>by</code> 两个参数至少需要有一个出现。否则动画效果没有。<code>to</code> 表示绝对值，<code>by</code> 表示相对值。拿位移距离，如果 from 是 100, <code>to</code> 值为 160 则表示移动到 160 这个位置，但是，如果 <code>by</code> 值是 160，则表示移动到 100+160=260 这个位置。</li><li>如果 <code>to</code>,<code>by</code> 同时出现，则 <code>by</code> 打酱油，只识别 <code>to</code>.</li><li>如果 <code>to</code>,<code>by</code>,<code>values</code> 都没设置，自然没动画效果。如果任意一个属性的值不合法，规范上说是没有动画效果。但是，据我测试，FireFox 浏览器确实如此，但是 Chrome 特意做了写容错处理。例如，本来是数值的属性，写了个不合法的值，其会当作 0 来处理，动画效果依然存在。</li><li><code>values</code> 可以是一个值或多值。根据我在 Chrome 浏览器下的测试，是一个值的时候是没有动画效果。多值时候有动画效果。当 <code>values</code> 值设置并能识别时候，<code>from</code>, <code>to</code>, <code>by</code> 的值都会被忽略。那 <code>values</code> 属性是干什么的呢？别看名字挺大众的，其还是有些功力的。我们实现动画，不可能就是单纯的从 <code>a</code> 位置到 <code>b</code> 位置，有时候，需要去 <code>c</code> 位置过渡下。此时，实际上有 3 个动画关键点。而 <code>from</code>, <code>to/by</code> 只能驾驭两个，此时就是 <code>values</code> 大显身手的时候了！</li></ul><p>代码如下：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&quot;320&quot;</span> <span class="attr">height</span>=<span class="string">&quot;200&quot;</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">text</span> <span class="attr">font-family</span>=<span class="string">&quot;microsoft yahei&quot;</span> <span class="attr">font-size</span>=<span class="string">&quot;120&quot;</span> <span class="attr">y</span>=<span class="string">&quot;150&quot;</span> <span class="attr">x</span>=<span class="string">&quot;160&quot;</span>&gt;</span></span><br><span class="line">        马</span><br><span class="line">        <span class="tag">&lt;<span class="name">animate</span> <span class="attr">attributeName</span>=<span class="string">&quot;x&quot;</span> <span class="attr">values</span>=<span class="string">&quot;160;40;160&quot;</span> <span class="attr">dur</span>=<span class="string">&quot;3s&quot;</span> <span class="attr">repeatCount</span>=<span class="string">&quot;indefinite&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><p>总结就是 <code>from-to</code> 动画、<code>from-by</code> 动画、<code>to</code> 动画、<code>by</code> 动画以及 <code>values</code> 动画。</p><h4 id="begin-end"><a href="#begin-end" class="headerlink" title="begin, end"></a>begin, end</h4><p><code>begin</code> 指动画开始的时间，begin 的定义是分号分隔的一组值。例如，<code>beigin=&quot;3s;5s&quot;</code> 表示的是 3s 之后动画走一下，6s 时候动画再走一下（如果之前动画没走完，会立即停止从头开始）。所以，如果一次动画时间为 3s, 即 <code>dur=&quot;3s&quot;</code>，同时没有 <code>repeatCount</code> 属性时候，我们可以看到动画似乎连续执行了 2 次。</p><p><code>begin</code> 的单值除了普通 <code>value</code>，还有下面这些类别的 <code>value</code>：<br><code>offset-value | syncbase-value | event-value | repeat-value | accessKey-value | media-marker-value | wallclock-sync-value | &quot;indefinite&quot;</code></p><ol><li><p><code>offset-value</code> 表示偏移值，数值前面有 <code>+</code> 或 <code>-</code> 应该指相对于 <code>documentdocument</code> 的 <code>begin</code> 值而言。</p></li><li><p><code>syncbase-value</code> 基于同步确定的值。语法为：<code>[元素id].begin/end +/- 时间值</code>. 就是说借用其他元素的 <code>begin</code> 值再加加减减，这个可以准确实现两个独立元素的动画级联效果。代码如下：</p></li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&quot;320&quot;</span> <span class="attr">height</span>=<span class="string">&quot;200&quot;</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">text</span> <span class="attr">font-family</span>=<span class="string">&quot;microsoft yahei&quot;</span> <span class="attr">font-size</span>=<span class="string">&quot;120&quot;</span> <span class="attr">y</span>=<span class="string">&quot;160&quot;</span> <span class="attr">x</span>=<span class="string">&quot;160&quot;</span>&gt;</span>马</span><br><span class="line">        <span class="tag">&lt;<span class="name">animate</span> <span class="attr">id</span>=<span class="string">&quot;x&quot;</span> <span class="attr">attributeName</span>=<span class="string">&quot;x&quot;</span> <span class="attr">to</span>=<span class="string">&quot;60&quot;</span> <span class="attr">begin</span>=<span class="string">&quot;0s&quot;</span> <span class="attr">dur</span>=<span class="string">&quot;3s&quot;</span> <span class="attr">fill</span>=<span class="string">&quot;freeze&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">animate</span> <span class="attr">attributeName</span>=<span class="string">&quot;y&quot;</span> <span class="attr">to</span>=<span class="string">&quot;100&quot;</span> <span class="attr">begin</span>=<span class="string">&quot;x.end&quot;</span> <span class="attr">dur</span>=<span class="string">&quot;3s&quot;</span> <span class="attr">fill</span>=<span class="string">&quot;freeze&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><p>可以看到，后面 <code>attributeName</code> 为 <code>y</code> 的元素的 <code>begin</code> 值是 <code>x.end</code>. <code>x.end</code> 中的 <code>x</code> 就是上面一个 <code>animate</code> 元素的 <code>id</code> 值，而 <code>end</code> 是动画元素都有的一个属性，动画结束的时间。因此，<code>begin=&quot;x.end&quot;</code>意思就是，当 <code>id</code> 为 <code>x</code> 的元素动画结束的时候，我执行动画。非常类似于 PowerPoint 动画的“上一个动画之后”的选项。</p><p>我们还可以增加一些偏移值，例如 <code>begin=&quot;x.end-1s&quot;</code>, 就表示 <code>id</code> 为 <code>x</code> 的元素动画结束前一秒开始纵向移动。</p><ol start="3"><li><code>event-value</code> 这个表示与事件相关联的值。类似于 PowerPoint 动画的“点击执行该动画”。语法是：<code>[元素id].[事件类型] +/- 时间值</code>。代码如下：</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">id</span>=<span class="string">&quot;svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;320&quot;</span> <span class="attr">height</span>=<span class="string">&quot;200&quot;</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">circle</span> <span class="attr">id</span>=<span class="string">&quot;circle&quot;</span> <span class="attr">cx</span>=<span class="string">&quot;100&quot;</span> <span class="attr">cy</span>=<span class="string">&quot;100&quot;</span> <span class="attr">r</span>=<span class="string">&quot;50&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">circle</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">text</span> <span class="attr">font-family</span>=<span class="string">&quot;microsoft yahei&quot;</span> <span class="attr">font-size</span>=<span class="string">&quot;120&quot;</span> <span class="attr">y</span>=<span class="string">&quot;160&quot;</span> <span class="attr">x</span>=<span class="string">&quot;160&quot;</span>&gt;</span>马</span><br><span class="line">        <span class="tag">&lt;<span class="name">animate</span> <span class="attr">attributeName</span>=<span class="string">&quot;x&quot;</span> <span class="attr">to</span>=<span class="string">&quot;60&quot;</span> <span class="attr">begin</span>=<span class="string">&quot;circle.click&quot;</span> <span class="attr">dur</span>=<span class="string">&quot;3s&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><p>代码的关键点就是上面红色高亮的 <code>begin=&quot;circle.click&quot;</code>, 其中 <code>circle</code> 为 <code>circle</code> 元素的 id, <code>click</code> 表示点击事件。含义一目了然，如果你想点击圆圈圈 2 秒钟后马儿才跑，很简单，偏移时间加上就可以了 <code>begin=&quot;circle.click+2s&quot;</code>. 这里要注意，这类与事件关联的 SVG 需要内联在页面中，否则 <code>click</code> 事件无法生效。</p><ol start="4"><li><code>repeat-value</code> 指重复多少次之后干嘛干嘛。语法为：<code>[元素id].repeat(整数) +/- 时间值</code>。代码如下：</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&quot;320&quot;</span> <span class="attr">height</span>=<span class="string">&quot;200&quot;</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">text</span> <span class="attr">font-family</span>=<span class="string">&quot;microsoft yahei&quot;</span> <span class="attr">font-size</span>=<span class="string">&quot;120&quot;</span> <span class="attr">y</span>=<span class="string">&quot;160&quot;</span> <span class="attr">x</span>=<span class="string">&quot;160&quot;</span>&gt;</span>马</span><br><span class="line">        <span class="tag">&lt;<span class="name">animate</span> <span class="attr">id</span>=<span class="string">&quot;x&quot;</span> <span class="attr">attributeName</span>=<span class="string">&quot;x&quot;</span> <span class="attr">to</span>=<span class="string">&quot;60&quot;</span> <span class="attr">begin</span>=<span class="string">&quot;0s&quot;</span> <span class="attr">dur</span>=<span class="string">&quot;3s&quot;</span> <span class="attr">repeatCount</span>=<span class="string">&quot;indefinite&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">animate</span> <span class="attr">attributeName</span>=<span class="string">&quot;y&quot;</span> <span class="attr">to</span>=<span class="string">&quot;100&quot;</span> <span class="attr">begin</span>=<span class="string">&quot;x.repeat(2)&quot;</span> <span class="attr">dur</span>=<span class="string">&quot;3s&quot;</span> <span class="attr">fill</span>=<span class="string">&quot;freeze&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>begin=&quot;x.repeat(2)&quot;</code>指 <code>id</code> 为 <code>x</code> 的元素的动画重复 2 次后执行.</p><ol start="5"><li><code>accessKey-value</code> 定义快捷键。即按下某个按键动画开始。语法为：<code>accessKey(character)</code>. <code>character</code> 表示快捷键所在的字符。代码如下：</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&quot;320&quot;</span> <span class="attr">height</span>=<span class="string">&quot;200&quot;</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">text</span> <span class="attr">font-family</span>=<span class="string">&quot;microsoft yahei&quot;</span> <span class="attr">font-size</span>=<span class="string">&quot;120&quot;</span> <span class="attr">y</span>=<span class="string">&quot;160&quot;</span> <span class="attr">x</span>=<span class="string">&quot;160&quot;</span>&gt;</span>马</span><br><span class="line">        <span class="tag">&lt;<span class="name">animate</span> <span class="attr">attributeName</span>=<span class="string">&quot;x&quot;</span> <span class="attr">to</span>=<span class="string">&quot;60&quot;</span> <span class="attr">begin</span>=<span class="string">&quot;accessKey(s)&quot;</span> <span class="attr">dur</span>=<span class="string">&quot;3s&quot;</span> <span class="attr">repeatCount</span>=<span class="string">&quot;indefinite&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><p>按下键盘上的字母 “<code>s</code>“, 理论上动画就会执行。</p><ol start="6"><li><p><code>wallclock-sync-value</code> 指真实世界的时钟时间定义, 时间语法是基于在 ISO8601 中定义的语法。</p></li><li><p><code>indefinite</code> 就是这个字符串值，表示“无限等待”。据说需要 <code>beginElement()</code>方法触发或者指向该动画元素的超链接。代码如下：</p></li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">id</span>=<span class="string">&quot;svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;320&quot;</span> <span class="attr">height</span>=<span class="string">&quot;200&quot;</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">text</span> <span class="attr">font-family</span>=<span class="string">&quot;microsoft yahei&quot;</span> <span class="attr">font-size</span>=<span class="string">&quot;120&quot;</span> <span class="attr">y</span>=<span class="string">&quot;160&quot;</span> <span class="attr">x</span>=<span class="string">&quot;160&quot;</span>&gt;</span>马</span><br><span class="line">        <span class="tag">&lt;<span class="name">animate</span> <span class="attr">attributeName</span>=<span class="string">&quot;x&quot;</span> <span class="attr">to</span>=<span class="string">&quot;60&quot;</span> <span class="attr">begin</span>=<span class="string">&quot;indefinite&quot;</span> <span class="attr">dur</span>=<span class="string">&quot;3s&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> animate = <span class="built_in">document</span>.getElementsByTagName(<span class="string">&#x27;animate&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">if</span> (animate) &#123;</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">&#x27;svg&#x27;</span>).onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    animate.beginElement()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>意思很简单，点击 <code>svg</code> 触发 <code>animate</code> 元素的 <code>beginElement()</code>方法，前提是 <code>begin=&quot;indefinite&quot;</code>。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&quot;320&quot;</span> <span class="attr">height</span>=<span class="string">&quot;200&quot;</span> <span class="attr">font-family</span>=<span class="string">&quot;microsoft yahei&quot;</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">xmlns:xlink</span>=<span class="string">&quot;http://www.w3.org/1999/xlink&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">text</span> <span class="attr">font-size</span>=<span class="string">&quot;120&quot;</span> <span class="attr">y</span>=<span class="string">&quot;160&quot;</span> <span class="attr">x</span>=<span class="string">&quot;160&quot;</span>&gt;</span>马</span><br><span class="line">          <span class="tag">&lt;<span class="name">animate</span> <span class="attr">id</span>=<span class="string">&quot;animate&quot;</span> <span class="attr">attributeName</span>=<span class="string">&quot;x&quot;</span> <span class="attr">to</span>=<span class="string">&quot;60&quot;</span> <span class="attr">begin</span>=<span class="string">&quot;indefinite&quot;</span> <span class="attr">dur</span>=<span class="string">&quot;3s&quot;</span> <span class="attr">repeatCount</span>=<span class="string">&quot;indefinite&quot;</span> /&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">a</span> <span class="attr">xlink:href</span>=<span class="string">&quot;#animate&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">text</span> <span class="attr">x</span>=<span class="string">&quot;10&quot;</span> <span class="attr">y</span>=<span class="string">&quot;20&quot;</span> <span class="attr">fill</span>=<span class="string">&quot;#cd0000&quot;</span> <span class="attr">font-size</span>=<span class="string">&quot;30&quot;</span>&gt;</span>点击我<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><p>从上面代码可以看出，动画触发条件很简单，只要 <code>a</code> 元素的 <code>xlink:href</code> 指向的我们的动画元素就可以了。</p><h4 id="dur"><a href="#dur" class="headerlink" title="dur"></a>dur</h4><p><code>dur</code> 属性值包括：常规时间值 | “<code>indefinite</code>“.</p><p>“常规时间值”就是 3s 之类的正常值；”<code>indefinite</code>“指事件无限，设置为”<code>indefinite</code>“ 跟没有 <code>dur</code> 效果一致。</p><h4 id="calcMode-keyTimes-keySplines"><a href="#calcMode-keyTimes-keySplines" class="headerlink" title="calcMode, keyTimes, keySplines"></a>calcMode, keyTimes, keySplines</h4><ol><li><code>calcMode</code></li></ol><p><code>calcMode</code> 属性支持 4 个值：<code>discrete | linear | paced | spline</code> ，分别对应：“离散”|“线性”|“踏步”|“样条”。</p><ul><li><code>discrete</code>：from 值直接跳到 to 值。</li><li><code>linear</code>：animateMotion 元素以外元素的 calcMode 默认值。动画从头到尾的速率都是一致的。</li><li><code>paced</code>：通过插值让动画的变化步调平稳均匀。仅支持线性数值区域内的值，这样点之间“距离”的概念才能被计算（如 position, width, height 等）。如果”paced“指定，任何 keyTimes 或 keySplines 值都会打酱油。</li><li><code>spline</code>：插值定义贝塞尔曲线。spline 点的定义在 keyTimes 属性中，每个时间间隔控制点由 keySplines 定义。</li></ul><ol start="2"><li><code>keyTimes</code></li></ol><p>跟上面提到的 <code>list</code> 类似，都是分号分隔一组值。<code>keyTimes</code> 总名字上看是关键时间点的意思，大致就是这个意思。前面提到过 <code>values</code> 也是多值，这里有一些约定的规则：首先，<code>calcMode</code> 值的数目要和 <code>values</code> 一致，如果是 <code>from/to/by</code> 动画，<code>calcMode</code> 就必须有两个值。然后对于 <code>linear</code> 和 <code>spline</code> 动画，第一个数字要是 0, 最后一个是 1。 最后，每个连续的时间值必须比它前面的值大或者相等。</p><p><code>paced</code> 模式下，<code>calcMode</code> 会被忽略；<code>calcMode</code> 定义错误，也会被忽略；<code>dur</code> 为 <code>indefinite</code> 也会被忽略。</p><ol start="3"><li><code>keySplines</code></li></ol><p><code>keySplines</code> 表示的是与 <code>calcMode</code> 相关联的一组贝塞尔控制点（默认 0 0 1 1）。每个控制点使用 4 个浮点值表示：<code>x1 y1 x2 y2</code>. 只有模式是 <code>spline</code> 时候这个参数才有用，也是分号分隔，值范围 0~1，总是比 <code>calcMode</code> 少一个值。</p><p>如果 <code>keySplines</code> 值不合法或个数不对，是没有动画效果的。代码如下:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">animate</span> <span class="attr">attributeName</span>=<span class="string">&quot;x&quot;</span> <span class="attr">dur</span>=<span class="string">&quot;5s&quot;</span> <span class="attr">values</span>=<span class="string">&quot;0; 20; 160&quot;</span> <span class="attr">calcMode</span>=<span class="string">&quot;linear&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">animate</span> <span class="attr">attributeName</span>=<span class="string">&quot;x&quot;</span> <span class="attr">dur</span>=<span class="string">&quot;5s&quot;</span> <span class="attr">values</span>=<span class="string">&quot;0; 20; 160&quot;</span> <span class="attr">calcMode</span>=<span class="string">&quot;paced&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">animate</span> <span class="attr">attributeName</span>=<span class="string">&quot;x&quot;</span> <span class="attr">dur</span>=<span class="string">&quot;5s&quot;</span> <span class="attr">values</span>=<span class="string">&quot;0; 80; 160&quot;</span> <span class="attr">keyTimes</span>=<span class="string">&quot;0; .8; 1&quot;</span> <span class="attr">calcMode</span>=<span class="string">&quot;linear&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">animate</span> <span class="attr">attributeName</span>=<span class="string">&quot;x&quot;</span> <span class="attr">dur</span>=<span class="string">&quot;5s&quot;</span> <span class="attr">values</span>=<span class="string">&quot;0; 80; 160&quot;</span> <span class="attr">keyTimes</span>=<span class="string">&quot;0; .8; 1&quot;</span> <span class="attr">calcMode</span>=<span class="string">&quot;spline&quot;</span>  <span class="attr">keySplines</span>=<span class="string">&quot;.5 0 .5 1; 0 0 1 1&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><p><code>values</code> 确定动画的关键位置，<code>keyTimes</code> 确定到这个关键点需要的时间，<code>keySplines</code> 确定的是每个时间点段之间的贝塞尔曲线，也就是具体的运动表现。</p><h4 id="repeatCount-repeatDur"><a href="#repeatCount-repeatDur" class="headerlink" title="repeatCount, repeatDur"></a>repeatCount, repeatDur</h4><p><code>repeatCount</code> 表示动画执行次数，可以是合法数值或者 <code>indefinite</code>（动画循环到电脑死机）。</p><p><code>repeatDur</code> 定义重复动画的总时间。可以是普通时间值或者 <code>indefinite</code>（”动画循环到电脑死机）。</p><p>例如：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">animate</span> <span class="attr">attributeName</span>=<span class="string">&quot;x&quot;</span> <span class="attr">to</span>=<span class="string">&quot;60&quot;</span> <span class="attr">dur</span>=<span class="string">&quot;3s&quot;</span> <span class="attr">repeatCount</span>=<span class="string">&quot;indefinite&quot;</span> <span class="attr">repeatDur</span>=<span class="string">&quot;10s&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><p>动画只玩执行完整 3 个 + 一个 1/3 个动画。因为 <code>repeat</code> 总时间就 10s 而已。</p><h4 id="fill"><a href="#fill" class="headerlink" title="fill"></a>fill</h4><p><code>fill</code> 表示动画间隙的填充方式。支持参数有：<code>freeze | remove</code>。其中 <code>remove</code> 是默认值，表示动画结束直接回到开始的地方。<code>freeze</code> 表示动画结束后元素保持了动画结束之后的状态。</p><h4 id="accumulate-additive"><a href="#accumulate-additive" class="headerlink" title="accumulate, additive"></a>accumulate, additive</h4><p><code>accumulate</code> 是累积的意思。支持参数有：<code>none | sum</code>, 默认值是 <code>none</code>, 如果值是 <code>sum</code> 表示动画结束时候的位置作为下次动画的起始位置。</p><p><code>additive</code> 控制动画是否附加。支持参数有：<code>replace | sum</code>, 默认值是 <code>replace</code>, 如果值是 <code>sum</code> 表示动画的基础知识会附加到其他低优先级的动画上。</p><p>举例如下：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">...</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">animateMotion</span> <span class="attr">begin</span>=<span class="string">&quot;0&quot;</span> <span class="attr">dur</span>=<span class="string">&quot;5s&quot;</span> <span class="attr">path</span>=<span class="string">&quot;[some path]&quot;</span> <span class="attr">additive</span>=<span class="string">&quot;sum&quot;</span> <span class="attr">fill</span>=<span class="string">&quot;freeze&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">animateMotion</span> <span class="attr">begin</span>=<span class="string">&quot;5s&quot;</span> <span class="attr">dur</span>=<span class="string">&quot;5s&quot;</span> <span class="attr">path</span>=<span class="string">&quot;[some path]&quot;</span> <span class="attr">additive</span>=<span class="string">&quot;sum&quot;</span> <span class="attr">fill</span>=<span class="string">&quot;freeze&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">animateMotion</span> <span class="attr">begin</span>=<span class="string">&quot;10s&quot;</span> <span class="attr">dur</span>=<span class="string">&quot;5s&quot;</span> <span class="attr">path</span>=<span class="string">&quot;[some path]&quot;</span> <span class="attr">additive</span>=<span class="string">&quot;sum&quot;</span> <span class="attr">fill</span>=<span class="string">&quot;freeze&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">img</span>&gt;</span></span><br></pre></td></tr></table></figure><p>这里第二个动画的路径是从第一个动画路径结束地方开始的，这样 3 个动画就无缝连接起来了。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">animateTransform</span> <span class="attr">attributeName</span>=<span class="string">&quot;transform&quot;</span> <span class="attr">type</span>=<span class="string">&quot;scale&quot;</span> <span class="attr">from</span>=<span class="string">&quot;1&quot;</span> <span class="attr">to</span>=<span class="string">&quot;3&quot;</span> <span class="attr">dur</span>=<span class="string">&quot;10s&quot;</span> <span class="attr">repeatCount</span>=<span class="string">&quot;indefinite&quot;</span> <span class="attr">additive</span>=<span class="string">&quot;sum&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">animateTransform</span> <span class="attr">attributeName</span>=<span class="string">&quot;transform&quot;</span> <span class="attr">type</span>=<span class="string">&quot;rotate&quot;</span> <span class="attr">from</span>=<span class="string">&quot;0 30 20&quot;</span> <span class="attr">to</span>=<span class="string">&quot;360 30 20&quot;</span> <span class="attr">dur</span>=<span class="string">&quot;10s&quot;</span> <span class="attr">fill</span>=<span class="string">&quot;freeze&quot;</span> <span class="attr">repeatCount</span>=<span class="string">&quot;indefinite&quot;</span> <span class="attr">additive</span>=<span class="string">&quot;sum&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><p>这里两个动画同时都是 <code>transform</code>，都要使用 <code>type</code> 属性，设置 <code>additive=&quot;sum&quot;</code> 累加而不是 <code>replace</code> 替换, 于是就可以是实现一边旋转一边放大的效果。</p><h4 id="restart"><a href="#restart" class="headerlink" title="restart"></a>restart</h4><p>动画可以由事件触发，如果希望事件触发动画只执行一次，之后再触发不执行, 这时就需要设置 restart 参数, 支持的有：<code>always | whenNotActive | never</code>.</p><p><code>always</code> 是默认值，表示总是触发; <code>whenNotActive</code> 表示动画正在进行的时候不能触发; <code>never</code> 表示动画只能触发一次。</p><h4 id="min-max"><a href="#min-max" class="headerlink" title="min, max"></a>min, max</h4><p><code>min/max</code> 表示动画执行最短和最长时间, 支持参数为时间值和 <code>media</code>（媒介元素有效）, <code>max</code> 还支持 <code>indefinite</code>。</p><h2 id="SVG-offset-path"><a href="#SVG-offset-path" class="headerlink" title="SVG offset-path"></a>SVG offset-path</h2><p>SVG SMIL 虽然强大，但是由于是基于 HTML 属性生成的各类效果，容易存在复用的问题，例如不同的位置的不同元素的不规则路径动画是一样的，那么我在设置的时候，要么冗余啰嗦，要么交叉不利于维护，有点早些年在 HTML 标签上写 <code>style</code> 样式的味道。</p><p>或许是这个原因，Chrome 浏览器开始有了放弃 SVG SMIL 的迹象，转而拥抱经过几十年成功验证的 CSS 来实现，<code>offset-path</code> 几乎可以看成是 Chrome 浏览器让元素沿着不规则路径运动的新宠儿。但相比较 SVG SMIL ，其兼容性还是差了不少：</p><p><img src="https://image.zhangxinxu.com/image/blog/201703/2017-03-05_214211.png"></p><p>使用 CSS 属性让元素不规则运动要比使用 HTML 属性控制简单得多，只需要下面几行 CSS，就可以实现我们想要的效果：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.horse-run</span> &#123;</span><br><span class="line">  <span class="attribute">offset-path</span>: <span class="built_in">path</span>(<span class="string">&#x27;M10,80 q100,120 120,20 q140,-50 160,0&#x27;</span>);</span><br><span class="line">  <span class="attribute">animation</span>: move <span class="number">3s</span> linear infinite;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@keyframes</span> move &#123;</span><br><span class="line">  100% &#123;</span><br><span class="line">    <span class="attribute">offset-distance</span>: <span class="number">100%</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其中用到了两个 CSS 属性，一个是 <code>offset-path</code>，表示运动的路径，另外一个则是 <code>offset-distance</code>，表示运动的距离，可以是数值或者百分比单位，如果是 100% 则表示正好把所有的路都跑完了。</p><p>除了这两个 CSS 属性，还有其他一些相关的属性，例如 <code>offset-rotation</code>（规范上显示的是 <code>offset-rotate</code>，但浏览器不识别），表示运动的角度，默认是 <code>auto</code>，表示自动计算当前路径的切线方向，并朝着这个方向前进。</p><p>除了 <code>offset-rotation</code>，还有其他相关 CSS 属性，包括 <code>offset-position</code> 和 <code>offset-anchor</code>。</p><p><code>offset-position</code> 指定路径的初始位置，行为类似于属性 <code>background-position</code>。</p><p><code>offset-anchor</code> 表示锚定的中心点，其属性值和 <code>transform-origin</code> 类似，可以是：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#item1</span> &#123;</span><br><span class="line">  <span class="attribute">offset-anchor</span>: right top;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#item2</span> &#123;</span><br><span class="line">  <span class="attribute">offset-anchor</span>: right bottom;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#item3</span> &#123;</span><br><span class="line">  <span class="attribute">offset-anchor</span>: left bottom;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#item4</span> &#123;</span><br><span class="line">  <span class="attribute">offset-anchor</span>: left top;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#item5</span> &#123;</span><br><span class="line">  <span class="attribute">offset-anchor</span>: center;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>根据测试，Chrome 浏览器虽然认得 <code>offset-position</code> 和 <code>offset-anchor</code> 这两个属性，但是还没有实际效果，所以只能从规范的示例上挖掘这两个属性的表现：</p><p>已知四个元素 <code>offset-position</code> 值分别是：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">offset-position</span>: 90% 20%;</span><br><span class="line"><span class="selector-tag">offset-position</span>: 100% 100%;</span><br><span class="line"><span class="selector-tag">offset-position</span>: 50% 100%;</span><br><span class="line"><span class="selector-tag">offset-position</span>: 0% 100%;</span><br></pre></td></tr></table></figure><p>当 <code>offset-anchor</code> 值为 <code>center</code> 时，表现如下图：</p><p><img src="https://www.zhangxinxu.com/study/201702/offset_anchor_center.svg"></p><p>上图中的加号表示的就是 <code>offset-anchor</code> 确定的锚点位置。</p><p>当 <code>offset-anchor</code> 值为 <code>auto</code> 时，则跟 <code>background-position</code> 属性的百分比解析一样：</p><p><img src="https://www.zhangxinxu.com/study/201702/offset_anchor_auto.svg"></p></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.nirongfei.site/blog-hexo/2018/06/04/frontend/180604/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/blog-hexo/images/avatar.png"><meta itemprop="name" content="阳明先生"><meta itemprop="description" content="知之真切笃实处即是行 行之明觉精察处即是知"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="阳明先生"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/blog-hexo/2018/06/04/frontend/180604/" class="post-title-link" itemprop="url">SVG知识总结</a></h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2018-06-04 00:00:00" itemprop="dateCreated datePublished" datetime="2018-06-04T00:00:00+08:00">2018-06-04</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2020-11-18 15:57:04" itemprop="dateModified" datetime="2020-11-18T15:57:04+08:00">2020-11-18</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/blog-hexo/categories/%E5%89%8D%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">前端</span></a></span></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>10k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>10 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>SVG 是一种基于 XML 语法的图像格式，全称是可缩放矢量图（Scalable Vector Graphics）。其他图像格式都是基于像素处理的，SVG 则是属于对图像的形状描述，所以它本质上是文本文件，体积较小，且不管放大多少倍都不会失真。SVG 文件可以直接插入网页，成为 DOM 的一部分，然后用 JavaScript 和 CSS 进行操作。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">svg</span></span></span><br><span class="line"><span class="tag">  <span class="attr">id</span>=<span class="string">&quot;mysvg&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">viewBox</span>=<span class="string">&quot;0 0 800 600&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">preserveAspectRatio</span>=<span class="string">&quot;xMidYMid meet&quot;</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">circle</span> <span class="attr">id</span>=<span class="string">&quot;mycircle&quot;</span> <span class="attr">cx</span>=<span class="string">&quot;400&quot;</span> <span class="attr">cy</span>=<span class="string">&quot;300&quot;</span> <span class="attr">r</span>=<span class="string">&quot;50&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">svg</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>上面是 SVG 代码直接插入网页的例子。</p><p>SVG 代码也可以写在一个独立文件中，然后用 <code>&lt;img&gt;、&lt;object&gt;、&lt;embed&gt;、&lt;iframe&gt;</code> 等标签插入网页。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;circle.svg&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">object</span> <span class="attr">id</span>=<span class="string">&quot;object&quot;</span> <span class="attr">data</span>=<span class="string">&quot;circle.svg&quot;</span> <span class="attr">type</span>=<span class="string">&quot;image/svg+xml&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">object</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">embed</span> <span class="attr">id</span>=<span class="string">&quot;embed&quot;</span> <span class="attr">src</span>=<span class="string">&quot;icon.svg&quot;</span> <span class="attr">type</span>=<span class="string">&quot;image/svg+xml&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">id</span>=<span class="string">&quot;iframe&quot;</span> <span class="attr">src</span>=<span class="string">&quot;icon.svg&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br></pre></td></tr></table></figure><p>CSS 也可以使用 SVG 文件:</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.logo</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">url</span>(icon.svg);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>SVG 文件还可以转为 BASE64 编码，然后作为 Data URI 写入网页:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;data:image/svg+xml;base64,[data]&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><h2 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h2><h3 id="lt-svg-gt"><a href="#lt-svg-gt" class="headerlink" title="&lt;svg&gt;"></a><code>&lt;svg&gt;</code></h3><p>SVG 代码都放在顶层标签<code>&lt;svg&gt;</code>之中。下面是一个例子:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&quot;100%&quot;</span> <span class="attr">height</span>=<span class="string">&quot;100%&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">circle</span> <span class="attr">id</span>=<span class="string">&quot;mycircle&quot;</span> <span class="attr">cx</span>=<span class="string">&quot;50&quot;</span> <span class="attr">cy</span>=<span class="string">&quot;50&quot;</span> <span class="attr">r</span>=<span class="string">&quot;50&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>&lt;svg&gt;</code>的 <code>width</code> 和 <code>height</code> 指定了 SVG 图像在 HTML 元素中所占据的宽度和高度。除了相对单位，也可以采用绝对单位（单位：像素）。如果不指定这两个属性，SVG 图像默认大小是 300 像素（宽） x 150 像素（高）。</p><p>如果只想展示 SVG 图像的一部分，就要指定 <code>viewBox</code> 属性。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&quot;100&quot;</span> <span class="attr">height</span>=<span class="string">&quot;100&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;50 50 50 50&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">circle</span> <span class="attr">id</span>=<span class="string">&quot;mycircle&quot;</span> <span class="attr">cx</span>=<span class="string">&quot;50&quot;</span> <span class="attr">cy</span>=<span class="string">&quot;50&quot;</span> <span class="attr">r</span>=<span class="string">&quot;50&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>&lt;viewBox&gt;</code>属性的值有四个数字，分别是左上角的横坐标和纵坐标、视口的宽度和高度。上面代码中，SVG 图像是 100 像素宽 x 100 像素高，<code>viewBox</code> 属性指定视口从(50, 50)这个点开始。所以，实际看到的是右下角的四分之一圆。</p><p>注意，视口必须适配所在的空间。上面代码中，视口的大小是 50 x 50，由于 SVG 图像的大小是 100 x 100，所以视口会放大去适配 SVG 图像的大小，即放大了四倍。</p><p>如果不指定 <code>width</code> 和 <code>height</code> 属性，只指定 <code>viewBox</code> 属性，则相当于只给定 SVG 图像的长宽比。这时，SVG 图像的默认大小将等于所在的 HTML 元素的大小。</p><h3 id="lt-line-gt"><a href="#lt-line-gt" class="headerlink" title="&lt;line&gt;"></a><code>&lt;line&gt;</code></h3><p><code>&lt;line&gt;</code>标签用来绘制直线。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&quot;300&quot;</span> <span class="attr">height</span>=<span class="string">&quot;180&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">line</span> <span class="attr">x1</span>=<span class="string">&quot;0&quot;</span> <span class="attr">y1</span>=<span class="string">&quot;0&quot;</span> <span class="attr">x2</span>=<span class="string">&quot;200&quot;</span> <span class="attr">y2</span>=<span class="string">&quot;0&quot;</span> <span class="attr">style</span>=<span class="string">&quot;stroke:rgb(0,0,0);stroke-width:5&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><p>上面代码中，<code>&lt;line&gt;</code>标签的 <code>x1</code> 和 <code>y1</code> 属性表示线段起点的横坐标和纵坐标, <code>x2</code> 和 <code>y2</code> 属性表示线段终点的横坐标和纵坐标, <code>style</code> 属性表示线段的样式。</p><h3 id="lt-rect-gt"><a href="#lt-rect-gt" class="headerlink" title="&lt;rect&gt;"></a><code>&lt;rect&gt;</code></h3><p><code>&lt;rect&gt;</code> 标签用于绘制矩形。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&quot;300&quot;</span> <span class="attr">height</span>=<span class="string">&quot;180&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">rect</span> <span class="attr">x</span>=<span class="string">&quot;0&quot;</span> <span class="attr">y</span>=<span class="string">&quot;0&quot;</span> <span class="attr">height</span>=<span class="string">&quot;100&quot;</span> <span class="attr">width</span>=<span class="string">&quot;200&quot;</span> <span class="attr">style</span>=<span class="string">&quot;stroke: #70d5dd; fill: #dd524b&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>&lt;rect&gt;</code> 的 <code>x</code> 和 <code>y</code> 属性指定了矩形左上角端点的横坐标和纵坐标, <code>width</code> 和 <code>height</code> 属性指定了矩形的宽度和高度（单位像素）。</p><h3 id="lt-circle-gt"><a href="#lt-circle-gt" class="headerlink" title="&lt;circle&gt;"></a><code>&lt;circle&gt;</code></h3><p><code>&lt;circle&gt;</code>标签代表圆形。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&quot;300&quot;</span> <span class="attr">height</span>=<span class="string">&quot;180&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">circle</span> <span class="attr">cx</span>=<span class="string">&quot;30&quot;</span>  <span class="attr">cy</span>=<span class="string">&quot;50&quot;</span> <span class="attr">r</span>=<span class="string">&quot;25&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">circle</span> <span class="attr">cx</span>=<span class="string">&quot;90&quot;</span>  <span class="attr">cy</span>=<span class="string">&quot;50&quot;</span> <span class="attr">r</span>=<span class="string">&quot;25&quot;</span> <span class="attr">class</span>=<span class="string">&quot;red&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">circle</span> <span class="attr">cx</span>=<span class="string">&quot;150&quot;</span> <span class="attr">cy</span>=<span class="string">&quot;50&quot;</span> <span class="attr">r</span>=<span class="string">&quot;25&quot;</span> <span class="attr">class</span>=<span class="string">&quot;fancy&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><p>上面的代码定义了三个圆。<code>&lt;circle&gt;</code> 标签的 <code>cx</code>、<code>cy</code>、<code>r</code> 属性分别为横坐标、纵坐标和半径，单位为像素。坐标都是相对于 <code>&lt;svg&gt;</code> 画布的左上角原点。</p><p><code>class</code> 属性用来指定对应的 CSS 类。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.red</span> &#123;</span><br><span class="line">  <span class="attribute">fill</span>: red;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.fancy</span> &#123;</span><br><span class="line">  <span class="attribute">fill</span>: none;</span><br><span class="line">  <span class="attribute">stroke</span>: black;</span><br><span class="line">  <span class="attribute">stroke-width</span>: <span class="number">3pt</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>SVG 的 CSS 属性与网页元素有所不同。</p><ul><li><code>fill</code>：填充色</li><li><code>stroke</code>：描边色</li><li><code>stroke-width</code>：边框宽度</li></ul><h3 id="lt-ellipse-gt"><a href="#lt-ellipse-gt" class="headerlink" title="&lt;ellipse&gt;"></a><code>&lt;ellipse&gt;</code></h3><p><code>&lt;ellipse&gt;</code>标签用于绘制椭圆。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&quot;300&quot;</span> <span class="attr">height</span>=<span class="string">&quot;180&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ellipse</span> <span class="attr">cx</span>=<span class="string">&quot;60&quot;</span> <span class="attr">cy</span>=<span class="string">&quot;60&quot;</span> <span class="attr">ry</span>=<span class="string">&quot;40&quot;</span> <span class="attr">rx</span>=<span class="string">&quot;20&quot;</span> <span class="attr">stroke</span>=<span class="string">&quot;black&quot;</span> <span class="attr">stroke-width</span>=<span class="string">&quot;5&quot;</span> <span class="attr">fill</span>=<span class="string">&quot;silver&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="lt-polyline-gt"><a href="#lt-polyline-gt" class="headerlink" title="&lt;polyline&gt;"></a><code>&lt;polyline&gt;</code></h3><p><code>&lt;polyline&gt;</code>标签用于绘制一根折线。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&quot;300&quot;</span> <span class="attr">height</span>=<span class="string">&quot;180&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">polyline</span> <span class="attr">points</span>=<span class="string">&quot;3,3 30,28 3,53&quot;</span> <span class="attr">fill</span>=<span class="string">&quot;none&quot;</span> <span class="attr">stroke</span>=<span class="string">&quot;black&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>&lt;polyline&gt;</code> 的 <code>points</code> 属性指定了每个端点的坐标，横坐标与纵坐标之间与逗号分隔，点与点之间用空格分隔。</p><p><code>&lt;ellipse&gt;</code> 的 <code>cx</code> 和 <code>cy</code> 属性指定了椭圆中心的横坐标和纵坐标（单位像素）；<code>rx</code> 和 <code>ry</code> 属性指定了椭圆横向轴和纵向轴的半径（单位像素）。</p><h3 id="lt-polygon-gt"><a href="#lt-polygon-gt" class="headerlink" title="&lt;polygon&gt;"></a><code>&lt;polygon&gt;</code></h3><p><code>&lt;polygon&gt;</code>标签用于绘制多边形。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&quot;300&quot;</span> <span class="attr">height</span>=<span class="string">&quot;180&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">polygon</span> <span class="attr">fill</span>=<span class="string">&quot;green&quot;</span> <span class="attr">stroke</span>=<span class="string">&quot;orange&quot;</span> <span class="attr">stroke-width</span>=<span class="string">&quot;1&quot;</span> <span class="attr">points</span>=<span class="string">&quot;0,0 100,0 100,100 0,100 0,0&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>&lt;polygon&gt;</code> 的 <code>points</code> 属性指定了每个端点的坐标，横坐标与纵坐标之间与逗号分隔，点与点之间用空格分隔。</p><h3 id="lt-path-gt"><a href="#lt-path-gt" class="headerlink" title="&lt;path&gt;"></a><code>&lt;path&gt;</code></h3><p><code>&lt;path&gt;</code>标签用于制路径。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&quot;300&quot;</span> <span class="attr">height</span>=<span class="string">&quot;180&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">path</span> <span class="attr">d</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="tag"><span class="string">  M 18,3</span></span></span><br><span class="line"><span class="tag"><span class="string">  L 46,3</span></span></span><br><span class="line"><span class="tag"><span class="string">  L 46,40</span></span></span><br><span class="line"><span class="tag"><span class="string">  L 61,40</span></span></span><br><span class="line"><span class="tag"><span class="string">  L 32,68</span></span></span><br><span class="line"><span class="tag"><span class="string">  L 3,40</span></span></span><br><span class="line"><span class="tag"><span class="string">  L 18,40</span></span></span><br><span class="line"><span class="tag"><span class="string">  Z</span></span></span><br><span class="line"><span class="tag"><span class="string">&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>&lt;path&gt;</code> 的 <code>d</code> 属性表示绘制顺序，它的值是一个长字符串，每个字母表示一个绘制动作，后面跟着坐标。</p><ul><li><p>M：移动到（moveto）</p></li><li><p>L：画直线到（lineto）</p></li><li><p>Z：闭合路径</p></li></ul><h3 id="lt-text-gt"><a href="#lt-text-gt" class="headerlink" title="&lt;text&gt;"></a><code>&lt;text&gt;</code></h3><p><code>&lt;text&gt;</code>标签用于绘制文本。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&quot;300&quot;</span> <span class="attr">height</span>=<span class="string">&quot;180&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">text</span> <span class="attr">x</span>=<span class="string">&quot;50&quot;</span> <span class="attr">y</span>=<span class="string">&quot;25&quot;</span>&gt;</span>Hello World<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>&lt;text&gt;</code>的 <code>x</code> 和 <code>y</code> 属性表示文本区块基线（baseline）起点的横坐标和纵坐标。文字的样式可以用 <code>class</code> 或 <code>style</code> 属性指定。</p><h3 id="lt-g-gt"><a href="#lt-g-gt" class="headerlink" title="&lt;g&gt;"></a><code>&lt;g&gt;</code></h3><p><code>&lt;g&gt;</code>标签用于将多个形状组成一个组（group），方便复用。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&quot;300&quot;</span> <span class="attr">height</span>=<span class="string">&quot;100&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">g</span> <span class="attr">id</span>=<span class="string">&quot;myCircle&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">text</span> <span class="attr">x</span>=<span class="string">&quot;25&quot;</span> <span class="attr">y</span>=<span class="string">&quot;20&quot;</span>&gt;</span>圆形<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">circle</span> <span class="attr">cx</span>=<span class="string">&quot;50&quot;</span> <span class="attr">cy</span>=<span class="string">&quot;50&quot;</span> <span class="attr">r</span>=<span class="string">&quot;20&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">g</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">use</span> <span class="attr">href</span>=<span class="string">&quot;#myCircle&quot;</span> <span class="attr">x</span>=<span class="string">&quot;100&quot;</span> <span class="attr">y</span>=<span class="string">&quot;0&quot;</span> <span class="attr">fill</span>=<span class="string">&quot;blue&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">use</span> <span class="attr">href</span>=<span class="string">&quot;#myCircle&quot;</span> <span class="attr">x</span>=<span class="string">&quot;200&quot;</span> <span class="attr">y</span>=<span class="string">&quot;0&quot;</span> <span class="attr">fill</span>=<span class="string">&quot;white&quot;</span> <span class="attr">stroke</span>=<span class="string">&quot;blue&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="lt-use-gt"><a href="#lt-use-gt" class="headerlink" title="&lt;use&gt;"></a><code>&lt;use&gt;</code></h3><p><code>&lt;use&gt;</code>标签用于复制一个形状。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 30 10&quot;</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">circle</span> <span class="attr">id</span>=<span class="string">&quot;myCircle&quot;</span> <span class="attr">cx</span>=<span class="string">&quot;5&quot;</span> <span class="attr">cy</span>=<span class="string">&quot;5&quot;</span> <span class="attr">r</span>=<span class="string">&quot;4&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">use</span> <span class="attr">href</span>=<span class="string">&quot;#myCircle&quot;</span> <span class="attr">x</span>=<span class="string">&quot;10&quot;</span> <span class="attr">y</span>=<span class="string">&quot;0&quot;</span> <span class="attr">fill</span>=<span class="string">&quot;blue&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">use</span> <span class="attr">href</span>=<span class="string">&quot;#myCircle&quot;</span> <span class="attr">x</span>=<span class="string">&quot;20&quot;</span> <span class="attr">y</span>=<span class="string">&quot;0&quot;</span> <span class="attr">fill</span>=<span class="string">&quot;white&quot;</span> <span class="attr">stroke</span>=<span class="string">&quot;blue&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>&lt;use&gt;</code>的 <code>href</code> 属性指定所要复制的节点，<code>x</code> 和 <code>y</code> 属性是 <code>&lt;use&gt;</code> 左上角的坐标。另外，还可以指定 <code>width</code> 和 <code>height</code> 坐标。</p><h3 id="lt-defs-gt"><a href="#lt-defs-gt" class="headerlink" title="&lt;defs&gt;"></a><code>&lt;defs&gt;</code></h3><p><code>&lt;defs&gt;</code>标签用于自定义形状，它内部的代码不会显示，仅供引用。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&quot;300&quot;</span> <span class="attr">height</span>=<span class="string">&quot;100&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">defs</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">g</span> <span class="attr">id</span>=<span class="string">&quot;myCircle&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">text</span> <span class="attr">x</span>=<span class="string">&quot;25&quot;</span> <span class="attr">y</span>=<span class="string">&quot;20&quot;</span>&gt;</span>圆形<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">circle</span> <span class="attr">cx</span>=<span class="string">&quot;50&quot;</span> <span class="attr">cy</span>=<span class="string">&quot;50&quot;</span> <span class="attr">r</span>=<span class="string">&quot;20&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">g</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">defs</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">use</span> <span class="attr">href</span>=<span class="string">&quot;#myCircle&quot;</span> <span class="attr">x</span>=<span class="string">&quot;0&quot;</span> <span class="attr">y</span>=<span class="string">&quot;0&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">use</span> <span class="attr">href</span>=<span class="string">&quot;#myCircle&quot;</span> <span class="attr">x</span>=<span class="string">&quot;100&quot;</span> <span class="attr">y</span>=<span class="string">&quot;0&quot;</span> <span class="attr">fill</span>=<span class="string">&quot;blue&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">use</span> <span class="attr">href</span>=<span class="string">&quot;#myCircle&quot;</span> <span class="attr">x</span>=<span class="string">&quot;200&quot;</span> <span class="attr">y</span>=<span class="string">&quot;0&quot;</span> <span class="attr">fill</span>=<span class="string">&quot;white&quot;</span> <span class="attr">stroke</span>=<span class="string">&quot;blue&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="lt-image-gt"><a href="#lt-image-gt" class="headerlink" title="&lt;image&gt;"></a><code>&lt;image&gt;</code></h3><p><code>&lt;image&gt;</code>标签用于插入图片文件。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 100 100&quot;</span> <span class="attr">width</span>=<span class="string">&quot;100&quot;</span> <span class="attr">height</span>=<span class="string">&quot;100&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">image</span> <span class="attr">xlink:href</span>=<span class="string">&quot;path/to/image.jpg&quot;</span> <span class="attr">href</span>=<span class="string">&quot;path/to/image.jpg&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">width</span>=<span class="string">&quot;50%&quot;</span> <span class="attr">height</span>=<span class="string">&quot;50%&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><p>上面代码中，<code>&lt;image&gt;</code>的<code>xlink:href</code>属性表示图像的来源。</p><h3 id="lt-pattern-gt"><a href="#lt-pattern-gt" class="headerlink" title="&lt;pattern&gt;"></a><code>&lt;pattern&gt;</code></h3><p><code>&lt;pattern&gt;</code>标签用于自定义一个形状，该形状可以被引用来平铺一个区域。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&quot;500&quot;</span> <span class="attr">height</span>=<span class="string">&quot;500&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">defs</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">pattern</span> <span class="attr">id</span>=<span class="string">&quot;dots&quot;</span> <span class="attr">x</span>=<span class="string">&quot;0&quot;</span> <span class="attr">y</span>=<span class="string">&quot;0&quot;</span> <span class="attr">width</span>=<span class="string">&quot;100&quot;</span> <span class="attr">height</span>=<span class="string">&quot;100&quot;</span> <span class="attr">patternUnits</span>=<span class="string">&quot;userSpaceOnUse&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">circle</span> <span class="attr">fill</span>=<span class="string">&quot;#bee9e8&quot;</span> <span class="attr">cx</span>=<span class="string">&quot;50&quot;</span> <span class="attr">cy</span>=<span class="string">&quot;50&quot;</span> <span class="attr">r</span>=<span class="string">&quot;35&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">defs</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">rect</span> <span class="attr">x</span>=<span class="string">&quot;0&quot;</span> <span class="attr">y</span>=<span class="string">&quot;0&quot;</span> <span class="attr">width</span>=<span class="string">&quot;100%&quot;</span> <span class="attr">height</span>=<span class="string">&quot;100%&quot;</span> <span class="attr">fill</span>=<span class="string">&quot;url(#dots)&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><p>上面代码中，<code>&lt;pattern&gt;</code>标签将一个圆形定义为<code>dots</code>模式。<code>patternUnits=&quot;userSpaceOnUse&quot;</code>表示<code>&lt;pattern&gt;</code>的宽度和长度是实际的像素值, 然后指定这个模式去填充下面的矩形。</p><h3 id="lt-animate-gt"><a href="#lt-animate-gt" class="headerlink" title="&lt;animate&gt;"></a><code>&lt;animate&gt;</code></h3><p><code>&lt;animate&gt;</code>标签用于产生动画效果。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&quot;500px&quot;</span> <span class="attr">height</span>=<span class="string">&quot;500px&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">rect</span> <span class="attr">x</span>=<span class="string">&quot;0&quot;</span> <span class="attr">y</span>=<span class="string">&quot;0&quot;</span> <span class="attr">width</span>=<span class="string">&quot;100&quot;</span> <span class="attr">height</span>=<span class="string">&quot;100&quot;</span> <span class="attr">fill</span>=<span class="string">&quot;#feac5e&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">animate</span> <span class="attr">attributeName</span>=<span class="string">&quot;x&quot;</span> <span class="attr">from</span>=<span class="string">&quot;0&quot;</span> <span class="attr">to</span>=<span class="string">&quot;500&quot;</span> <span class="attr">dur</span>=<span class="string">&quot;2s&quot;</span> <span class="attr">repeatCount</span>=<span class="string">&quot;indefinite&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">rect</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><p>上面代码中，矩形会不断移动，产生动画效果。</p><p><code>&lt;animate&gt;</code>的属性含义如下。</p><ul><li><code>attributeName</code>：发生动画效果的属性名。</li><li><code>from</code>：单次动画的初始值。</li><li><code>to</code>：单次动画的结束值。</li><li><code>dur</code>：单次动画的持续时间。</li><li><code>repeatCount</code>：动画的循环模式。</li></ul><p>可以在多个属性上面定义动画。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">animate</span> <span class="attr">attributeName</span>=<span class="string">&quot;x&quot;</span> <span class="attr">from</span>=<span class="string">&quot;0&quot;</span> <span class="attr">to</span>=<span class="string">&quot;500&quot;</span> <span class="attr">dur</span>=<span class="string">&quot;2s&quot;</span> <span class="attr">repeatCount</span>=<span class="string">&quot;indefinite&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">animate</span> <span class="attr">attributeName</span>=<span class="string">&quot;width&quot;</span> <span class="attr">to</span>=<span class="string">&quot;500&quot;</span> <span class="attr">dur</span>=<span class="string">&quot;2s&quot;</span> <span class="attr">repeatCount</span>=<span class="string">&quot;indefinite&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><h3 id="lt-animateTransform-gt"><a href="#lt-animateTransform-gt" class="headerlink" title="&lt;animateTransform&gt;"></a><code>&lt;animateTransform&gt;</code></h3><p><code>&lt;animate&gt;</code>标签对 CSS 的 <code>transform</code> 属性不起作用，如果需要变形，就要使用<code>&lt;animateTransform&gt;</code>标签。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&quot;500px&quot;</span> <span class="attr">height</span>=<span class="string">&quot;500px&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">rect</span> <span class="attr">x</span>=<span class="string">&quot;250&quot;</span> <span class="attr">y</span>=<span class="string">&quot;250&quot;</span> <span class="attr">width</span>=<span class="string">&quot;50&quot;</span> <span class="attr">height</span>=<span class="string">&quot;50&quot;</span> <span class="attr">fill</span>=<span class="string">&quot;#4bc0c8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">animateTransform</span> <span class="attr">attributeName</span>=<span class="string">&quot;transform&quot;</span> <span class="attr">type</span>=<span class="string">&quot;rotate&quot;</span> <span class="attr">begin</span>=<span class="string">&quot;0s&quot;</span> <span class="attr">dur</span>=<span class="string">&quot;10s&quot;</span> <span class="attr">from</span>=<span class="string">&quot;0 200 200&quot;</span> <span class="attr">to</span>=<span class="string">&quot;360 400 400&quot;</span> <span class="attr">repeatCount</span>=<span class="string">&quot;indefinite&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">rect</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><p>上面代码中，<code>&lt;animateTransform&gt;</code>的效果为旋转（rotate），这时 <code>from</code> 和 <code>to</code> 属性值有三个数字，第一个数字是角度值，第二个值和第三个值是旋转中心的坐标。<code>from=&quot;0 200 200&quot;</code>表示开始时，角度为 0，围绕(200, 200)开始旋转；<code>to=&quot;360 400 400&quot;</code>表示结束时，角度为 360，围绕(400, 400)旋转。</p><h2 id="交互"><a href="#交互" class="headerlink" title="交互"></a>交互</h2><h3 id="获取-DOM"><a href="#获取-DOM" class="headerlink" title="获取 DOM"></a>获取 DOM</h3><p>使用<code>&lt;object&gt;</code>、<code>&lt;iframe&gt;</code>、<code>&lt;embed&gt;</code>标签插入 SVG 文件，可以获取 SVG DOM。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> svgObject = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;object&#x27;</span>).contentDocument</span><br><span class="line"><span class="keyword">var</span> svgIframe = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;iframe&#x27;</span>).contentDocument</span><br><span class="line"><span class="keyword">var</span> svgEmbed = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;embed&#x27;</span>).getSVGDocument()</span><br></pre></td></tr></table></figure><p>注意，如果使用<code>&lt;img&gt;</code>标签插入 SVG 文件，就无法获取 SVG DOM。</p><h3 id="操作-DOM"><a href="#操作-DOM" class="headerlink" title="操作 DOM"></a>操作 DOM</h3><p>如果 SVG 代码直接写在 HTML 网页之中，它就成为网页 DOM 的一部分，可以直接用 DOM 操作。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span></span></span><br><span class="line"><span class="tag"><span class="attr">id</span>=<span class="string">&quot;mysvg&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">viewBox</span>=<span class="string">&quot;0 0 800 600&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">preserveAspectRatio</span>=<span class="string">&quot;xMidYMid meet&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">circle</span> <span class="attr">id</span>=<span class="string">&quot;mycircle&quot;</span> <span class="attr">cx</span>=<span class="string">&quot;400&quot;</span> <span class="attr">cy</span>=<span class="string">&quot;300&quot;</span> <span class="attr">r</span>=<span class="string">&quot;50&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>上面代码插入网页之后，就可以用 CSS 定制样式。</p></blockquote><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">circle</span> &#123;</span><br><span class="line">  <span class="attribute">stroke-width</span>: <span class="number">5</span>;</span><br><span class="line">  <span class="attribute">stroke</span>: <span class="number">#f00</span>;</span><br><span class="line">  <span class="attribute">fill</span>: <span class="number">#ff0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">circle</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">stroke</span>: <span class="number">#090</span>;</span><br><span class="line">  <span class="attribute">fill</span>: <span class="number">#fff</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后，可以用 JavaScript 代码操作 SVG。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> mycircle = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;mycircle&#x27;</span>)</span><br><span class="line"></span><br><span class="line">mycircle.addEventListener(</span><br><span class="line">  <span class="string">&#x27;click&#x27;</span>,</span><br><span class="line">  <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;circle clicked - enlarging&#x27;</span>)</span><br><span class="line">    mycircle.setAttribute(<span class="string">&#x27;r&#x27;</span>, <span class="number">60</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="literal">false</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>上面代码指定，如果点击图形就改写 <code>circle</code> 元素的 <code>r</code> 属性。</p><h3 id="读取-SVG"><a href="#读取-SVG" class="headerlink" title="读取 SVG"></a>读取 SVG</h3><p>由于 SVG 文件就是一段 XML 文本，因此可以通过读取 XML 代码的方式，读取 SVG 源码。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;svg-container&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">svg</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xlink</span>=<span class="string">&quot;http://www.w3.org/1999/xlink&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xml:space</span>=<span class="string">&quot;preserve&quot;</span> <span class="attr">width</span>=<span class="string">&quot;500&quot;</span> <span class="attr">height</span>=<span class="string">&quot;440&quot;</span></span></span><br><span class="line"><span class="tag">  &gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- svg code --&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>使用 XMLSerializer 实例的<code>serializeToString()</code>方法，获取 SVG 元素的代码。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> svgString = <span class="keyword">new</span> XMLSerializer().serializeToString(<span class="built_in">document</span>.querySelector(<span class="string">&#x27;svg&#x27;</span>))</span><br></pre></td></tr></table></figure><h3 id="SVG-转-Canvas"><a href="#SVG-转-Canvas" class="headerlink" title="SVG 转 Canvas"></a>SVG 转 Canvas</h3><p>首先，需要新建一个 Image 对象，将 SVG 图像指定到该 Image 对象的 <code>src</code> 属性。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> img = <span class="keyword">new</span> Image()</span><br><span class="line"><span class="keyword">var</span> svg = <span class="keyword">new</span> Blob([svgString], &#123; <span class="attr">type</span>: <span class="string">&#x27;image/svg+xml;charset=utf-8&#x27;</span> &#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> DOMURL = self.URL || self.webkitURL || self</span><br><span class="line"><span class="keyword">var</span> url = DOMURL.createObjectURL(svg)</span><br><span class="line"></span><br><span class="line">img.src = url</span><br></pre></td></tr></table></figure><p>然后，当图像加载完成后，再将它绘制到<code>&lt;canvas&gt;</code>元素。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">img.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> canvas = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;canvas&#x27;</span>)</span><br><span class="line">  <span class="keyword">var</span> ctx = canvas.getContext(<span class="string">&#x27;2d&#x27;</span>)</span><br><span class="line">  ctx.drawImage(img, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.nirongfei.site/blog-hexo/2018/06/01/frontend/180601/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/blog-hexo/images/avatar.png"><meta itemprop="name" content="阳明先生"><meta itemprop="description" content="知之真切笃实处即是行 行之明觉精察处即是知"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="阳明先生"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/blog-hexo/2018/06/01/frontend/180601/" class="post-title-link" itemprop="url">SVG入门学习</a></h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2018-06-01 00:00:00" itemprop="dateCreated datePublished" datetime="2018-06-01T00:00:00+08:00">2018-06-01</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2020-11-18 15:57:04" itemprop="dateModified" datetime="2020-11-18T15:57:04+08:00">2020-11-18</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/blog-hexo/categories/%E5%89%8D%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">前端</span></a></span></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>14k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>12 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><h2 id="SVG-简介"><a href="#SVG-简介" class="headerlink" title="SVG 简介"></a>SVG 简介</h2><p>SVG 指可伸缩矢量图形 (Scalable Vector Graphics)，是一种使用 XML 来描述二维图形和绘图程序的语言。SVG 可以简要概括为以下几点：</p><ul><li>SVG 指可伸缩矢量图形</li><li>SVG 用来定义网络的基于矢量的图形</li><li>SVG 使用 XML 格式定义图形</li><li>SVG 图像在放大或改变尺寸的情况下其图形质量不会有所损失</li><li>SVG 是万维网联盟的标准</li><li>SVG 与诸如 DOM 和 XSL 之类的 W3C 标准是一个整体</li></ul><p>浏览器对于 SVG 的兼容情况</p><p><img src="https://user-gold-cdn.xitu.io/2019/12/10/16eed27765d2c93b?imageView2/0/w/1280/h/960/format/webp/ignore-error/1"></p><p>SVG 与 Canvas 之间的对比</p><p><img src="https://user-gold-cdn.xitu.io/2019/12/10/16eed278c08595bb?imageView2/0/w/1280/h/960/format/webp/ignore-error/1"></p><h2 id="SVG-绘制"><a href="#SVG-绘制" class="headerlink" title="SVG 绘制"></a>SVG 绘制</h2><h3 id="基本结构"><a href="#基本结构" class="headerlink" title="基本结构"></a>基本结构</h3><p>SVG 的文档结构如下：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&#x27;140&#x27;</span> <span class="attr">height</span>=<span class="string">&#x27;170&#x27;</span> <span class="attr">xmlns</span>=<span class="string">&#x27;http://wwww.w3.org/2000/svg&#x27;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Cat<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">desc</span>&gt;</span>Stick Figure of Cat<span class="tag">&lt;/<span class="name">desc</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><p>根元素 <code>&lt;svg&gt;</code> 以像素为单位定义了整个图像的 <code>width</code> 和 <code>height</code>，还通过 <code>xmlns</code> 属性定义了 SVG 的命名空间。<code>&lt;title&gt;</code> 元素的内容可以被阅读器显示在标题栏上或者是作为鼠标指针指向图像时的提示， <code>&lt;desc&gt;</code> 元素允许咱们为图像定义完整的描述信息。</p><p>SVG 的基本图形如下:</p><p><code>&lt;line&gt;</code>、<code>&lt;rect&gt;</code>、<code>&lt;circle&gt;</code>、<code>&lt;ellipse&gt;</code>、<code>&lt;polygon&gt;</code>、<code>&lt;polyline&gt;</code></p><p>SVG 的基本属性如下:</p><p><code>fill</code>、<code>stroke</code>、<code>stroke-width</code>、<code>transform</code></p><h3 id="基本流程"><a href="#基本流程" class="headerlink" title="基本流程"></a>基本流程</h3><h4 id="绘制图形"><a href="#绘制图形" class="headerlink" title="绘制图形"></a>绘制图形</h4><p>咱们可以通过 <code>&lt;circle&gt;</code> 元素来绘制猫的脸部。元素属性的中心点 <code>x</code> 坐标和 <code>y</code> 坐标以为半径。点(0,0) 为图像左上角。水平向右移动时 <code>x</code> 坐标增大，垂直向下移动时 <code>y</code> 坐标增大。为了避免一些误会，API 语义就很明确了，点 <code>(cx, cy)</code> 就表示圆心的位置，<code>r</code> 表示圆的半径。<br>绘图的颜色是表现的一部分，表现信息包含在 <code>style</code> 属性中，这里的轮廓颜色为黑色，填充颜色为 <code>none</code> 以使猫的脸部透明。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&#x27;140&#x27;</span> <span class="attr">heiight</span>=<span class="string">&#x27;170&#x27;</span> <span class="attr">xmlns</span>=<span class="string">&#x27;http://wwww.w3.org/2000/svg&#x27;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Cat<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">desc</span>&gt;</span>Stick Figure of Cat<span class="tag">&lt;/<span class="name">desc</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">circle</span> <span class="attr">cx</span>=<span class="string">&#x27;70&#x27;</span> <span class="attr">cy</span>=<span class="string">&#x27;95&#x27;</span> <span class="attr">r</span>=<span class="string">&#x27;50&#x27;</span> <span class="attr">style</span>=<span class="string">&#x27;stroke:black; fill:none&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">circle</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://user-gold-cdn.xitu.io/2019/12/10/16eed286810de3de?imageView2/0/w/1280/h/960/format/webp/ignore-error/1"></p><h4 id="指定样式"><a href="#指定样式" class="headerlink" title="指定样式"></a>指定样式</h4><p>接着在添加两个圆表示两个眼睛。上面的 <code>stroke</code> 与 <code>fill</code> 是写在 <code>style</code> 里面的，但是 SVG 也允许咱们使用单独的属性，而不用全部写在 <code>style</code> 内，如下所示：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&#x27;140&#x27;</span> <span class="attr">heiight</span>=<span class="string">&#x27;170&#x27;</span> <span class="attr">xmlns</span>=<span class="string">&#x27;http://wwww.w3.org/2000/svg&#x27;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Cat<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">desc</span>&gt;</span>Stick Figure of Cat<span class="tag">&lt;/<span class="name">desc</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">circle</span> <span class="attr">cx</span>=<span class="string">&#x27;70&#x27;</span> <span class="attr">cy</span>=<span class="string">&#x27;95&#x27;</span> <span class="attr">r</span>=<span class="string">&#x27;50&#x27;</span> <span class="attr">style</span>=<span class="string">&#x27;stroke:black; fill:none&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">circle</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">circle</span> <span class="attr">cx</span>=<span class="string">&#x27;55&#x27;</span> <span class="attr">cy</span>=<span class="string">&#x27;80&#x27;</span> <span class="attr">r</span>=<span class="string">&#x27;5&#x27;</span> <span class="attr">stroke</span>=<span class="string">&#x27;black&#x27;</span> <span class="attr">fill</span>=<span class="string">&#x27;#3339933&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">circle</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">circle</span> <span class="attr">cx</span>=<span class="string">&#x27;85&#x27;</span> <span class="attr">cy</span>=<span class="string">&#x27;80&#x27;</span> <span class="attr">r</span>=<span class="string">&#x27;5&#x27;</span> <span class="attr">stroke</span>=<span class="string">&#x27;black&#x27;</span> <span class="attr">fill</span>=<span class="string">&#x27;#3339933&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">circle</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://user-gold-cdn.xitu.io/2019/12/10/16eed28862ce8167?imageView2/0/w/1280/h/960/format/webp/ignore-error/1"></p><h4 id="图形分组"><a href="#图形分组" class="headerlink" title="图形分组"></a>图形分组</h4><p>接着使用两个 <code>&lt;line&gt;</code> 元素在猫的右脸上添加胡须，这里我们需要把胡须作为一个部件，并包装在分组元素 <code>&lt;g&gt;</code> 里面，然后给下 <code>id</code> ，如下所示：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&#x27;140&#x27;</span> <span class="attr">heiight</span>=<span class="string">&#x27;170&#x27;</span> <span class="attr">xmlns</span>=<span class="string">&#x27;http://wwww.w3.org/2000/svg&#x27;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Cat<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">desc</span>&gt;</span>Stick Figure of Cat<span class="tag">&lt;/<span class="name">desc</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">circle</span> <span class="attr">cx</span>=<span class="string">&#x27;70&#x27;</span> <span class="attr">cy</span>=<span class="string">&#x27;95&#x27;</span> <span class="attr">r</span>=<span class="string">&#x27;50&#x27;</span> <span class="attr">style</span>=<span class="string">&#x27;stroke:black; fill:none&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">circle</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">circle</span> <span class="attr">cx</span>=<span class="string">&#x27;55&#x27;</span> <span class="attr">cy</span>=<span class="string">&#x27;80&#x27;</span> <span class="attr">r</span>=<span class="string">&#x27;5&#x27;</span> <span class="attr">stroke</span>=<span class="string">&#x27;black&#x27;</span> <span class="attr">fill</span>=<span class="string">&#x27;#3339933&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">circle</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">circle</span> <span class="attr">cx</span>=<span class="string">&#x27;85&#x27;</span> <span class="attr">cy</span>=<span class="string">&#x27;80&#x27;</span> <span class="attr">r</span>=<span class="string">&#x27;5&#x27;</span> <span class="attr">stroke</span>=<span class="string">&#x27;black&#x27;</span> <span class="attr">fill</span>=<span class="string">&#x27;#3339933&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">circle</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">g</span> <span class="attr">id</span>=<span class="string">&#x27;whiskers&#x27;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">line</span> <span class="attr">x1</span>=<span class="string">&#x27;75&#x27;</span> <span class="attr">y1</span>=<span class="string">&#x27;95&#x27;</span> <span class="attr">x2</span>=<span class="string">&#x27;135&#x27;</span> <span class="attr">y2</span>=<span class="string">&#x27;85&#x27;</span> <span class="attr">style</span>=<span class="string">&#x27;stroke:black&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">line</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">line</span> <span class="attr">x1</span>=<span class="string">&#x27;75&#x27;</span> <span class="attr">y1</span>=<span class="string">&#x27;95&#x27;</span> <span class="attr">x2</span>=<span class="string">&#x27;135&#x27;</span> <span class="attr">y2</span>=<span class="string">&#x27;105&#x27;</span> <span class="attr">style</span>=<span class="string">&#x27;stroke:black&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">line</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">g</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://user-gold-cdn.xitu.io/2019/12/10/16eed28b7dba6f69?imageView2/0/w/1280/h/960/format/webp/ignore-error/1"></p><p>接着使用 <code>&lt;use&gt;</code> 复用胡须分组并将它变换为左侧胡须，如下图所示，首先在 <code>scale</code> 变换中对 <code>x</code> 坐标乘以 -1，翻转坐标系统。这意味原始坐标系统中的点(75, 95) 现在位于 (-75, 95)。接着通过 <code>translate</code> 向左平移调整对应的位置。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&#x27;140&#x27;</span> <span class="attr">heiight</span>=<span class="string">&#x27;170&#x27;</span> <span class="attr">xmlns</span>=<span class="string">&#x27;http://wwww.w3.org/2000/svg&#x27;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Cat<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">desc</span>&gt;</span>Stick Figure of Cat<span class="tag">&lt;/<span class="name">desc</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">circle</span> <span class="attr">cx</span>=<span class="string">&#x27;70&#x27;</span> <span class="attr">cy</span>=<span class="string">&#x27;95&#x27;</span> <span class="attr">r</span>=<span class="string">&#x27;50&#x27;</span> <span class="attr">style</span>=<span class="string">&#x27;stroke:black; fill:none&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">circle</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">circle</span> <span class="attr">cx</span>=<span class="string">&#x27;55&#x27;</span> <span class="attr">cy</span>=<span class="string">&#x27;80&#x27;</span> <span class="attr">r</span>=<span class="string">&#x27;5&#x27;</span> <span class="attr">stroke</span>=<span class="string">&#x27;black&#x27;</span> <span class="attr">fill</span>=<span class="string">&#x27;#3339933&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">circle</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">circle</span> <span class="attr">cx</span>=<span class="string">&#x27;85&#x27;</span> <span class="attr">cy</span>=<span class="string">&#x27;80&#x27;</span> <span class="attr">r</span>=<span class="string">&#x27;5&#x27;</span> <span class="attr">stroke</span>=<span class="string">&#x27;black&#x27;</span> <span class="attr">fill</span>=<span class="string">&#x27;#3339933&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">circle</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">g</span> <span class="attr">id</span>=<span class="string">&#x27;whiskers&#x27;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">line</span> <span class="attr">x1</span>=<span class="string">&#x27;75&#x27;</span> <span class="attr">y1</span>=<span class="string">&#x27;95&#x27;</span> <span class="attr">x2</span>=<span class="string">&#x27;135&#x27;</span> <span class="attr">y2</span>=<span class="string">&#x27;85&#x27;</span> <span class="attr">style</span>=<span class="string">&#x27;stroke:black&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">line</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">line</span> <span class="attr">x1</span>=<span class="string">&#x27;75&#x27;</span> <span class="attr">y1</span>=<span class="string">&#x27;95&#x27;</span> <span class="attr">x2</span>=<span class="string">&#x27;135&#x27;</span> <span class="attr">y2</span>=<span class="string">&#x27;105&#x27;</span> <span class="attr">style</span>=<span class="string">&#x27;stroke:black&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">line</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">g</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">use</span> <span class="attr">xlink:href</span>=<span class="string">&quot;#whiskers&quot;</span> <span class="attr">transform</span>=<span class="string">&#x27;scale(-1 1) translate(-140 0)&#x27;</span> &gt;</span><span class="tag">&lt;/<span class="name">use</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://user-gold-cdn.xitu.io/2019/12/10/16eed28cfcc50cba?imageView2/0/w/1280/h/960/format/webp/ignore-error/1"></p><h4 id="其它图形"><a href="#其它图形" class="headerlink" title="其它图形"></a>其它图形</h4><p>如下图所示，咱们使用 <code>&lt;polyline&gt;</code> 元素构建嘴和耳朵，它接受一对 <code>x</code> 和 <code>y</code> 坐标为 <code>points</code> 属性的值。你可以使用空格或者逗号分隔这些数值。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&#x27;140&#x27;</span> <span class="attr">heiight</span>=<span class="string">&#x27;170&#x27;</span> <span class="attr">xmlns</span>=<span class="string">&#x27;http://wwww.w3.org/2000/svg&#x27;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Cat<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">desc</span>&gt;</span>Stick Figure of Cat<span class="tag">&lt;/<span class="name">desc</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">circle</span> <span class="attr">cx</span>=<span class="string">&#x27;70&#x27;</span> <span class="attr">cy</span>=<span class="string">&#x27;95&#x27;</span> <span class="attr">r</span>=<span class="string">&#x27;50&#x27;</span> <span class="attr">style</span>=<span class="string">&#x27;stroke:black; fill:none&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">circle</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">circle</span> <span class="attr">cx</span>=<span class="string">&#x27;55&#x27;</span> <span class="attr">cy</span>=<span class="string">&#x27;80&#x27;</span> <span class="attr">r</span>=<span class="string">&#x27;5&#x27;</span> <span class="attr">stroke</span>=<span class="string">&#x27;black&#x27;</span> <span class="attr">fill</span>=<span class="string">&#x27;#3339933&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">circle</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">circle</span> <span class="attr">cx</span>=<span class="string">&#x27;85&#x27;</span> <span class="attr">cy</span>=<span class="string">&#x27;80&#x27;</span> <span class="attr">r</span>=<span class="string">&#x27;5&#x27;</span> <span class="attr">stroke</span>=<span class="string">&#x27;black&#x27;</span> <span class="attr">fill</span>=<span class="string">&#x27;#3339933&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">circle</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">g</span> <span class="attr">id</span>=<span class="string">&#x27;whiskers&#x27;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">line</span> <span class="attr">x1</span>=<span class="string">&#x27;75&#x27;</span> <span class="attr">y1</span>=<span class="string">&#x27;95&#x27;</span> <span class="attr">x2</span>=<span class="string">&#x27;135&#x27;</span> <span class="attr">y2</span>=<span class="string">&#x27;85&#x27;</span> <span class="attr">style</span>=<span class="string">&#x27;stroke:black&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">line</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">line</span> <span class="attr">x1</span>=<span class="string">&#x27;75&#x27;</span> <span class="attr">y1</span>=<span class="string">&#x27;95&#x27;</span> <span class="attr">x2</span>=<span class="string">&#x27;135&#x27;</span> <span class="attr">y2</span>=<span class="string">&#x27;105&#x27;</span> <span class="attr">style</span>=<span class="string">&#x27;stroke:black&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">line</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">g</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">use</span> <span class="attr">xlink:href</span>=<span class="string">&quot;#whiskers&quot;</span> <span class="attr">transform</span>=<span class="string">&#x27;scale(-1 1) translate(-140 0)&#x27;</span> &gt;</span><span class="tag">&lt;/<span class="name">use</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 耳朵 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">polyline</span> <span class="attr">points</span>=<span class="string">&#x27;108 62,90 10, 70 45, 50, 10, 32, 62&#x27;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">style</span>=<span class="string">&#x27;stroke:black; fill:none&#x27;</span> /&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 嘴 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">polyline</span> <span class="attr">points</span>=<span class="string">&#x27;35 110,45 120, 95 120, 105, 110&#x27;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">style</span>=<span class="string">&#x27;stroke:black; fill:none&#x27;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://user-gold-cdn.xitu.io/2019/12/10/16eed28e769acd01?imageView2/0/w/1280/h/960/format/webp/ignore-error/1"></p><h4 id="绘制路径"><a href="#绘制路径" class="headerlink" title="绘制路径"></a>绘制路径</h4><p>所有的基本形状都是通用的 <code>&lt;path&gt;</code> 元素的快捷写法。接着使用 <code>&lt;path&gt;</code> 元素为猫添加鼻子。如下所示的代码，翻译过来就是 “移动到坐标(75, 90)。绘制一条到坐标(65,90) 的直线。然后以 <code>x</code> 半径为 5、<code>y</code> 半径为 10 绘制一个椭圆，最后回到坐标 (75, 90) 处”</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&#x27;140&#x27;</span> <span class="attr">heiight</span>=<span class="string">&#x27;170&#x27;</span> <span class="attr">xmlns</span>=<span class="string">&#x27;http://wwww.w3.org/2000/svg&#x27;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Cat<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">desc</span>&gt;</span>Stick Figure of Cat<span class="tag">&lt;/<span class="name">desc</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">circle</span> <span class="attr">cx</span>=<span class="string">&#x27;70&#x27;</span> <span class="attr">cy</span>=<span class="string">&#x27;95&#x27;</span> <span class="attr">r</span>=<span class="string">&#x27;50&#x27;</span> <span class="attr">style</span>=<span class="string">&#x27;stroke:black; fill:none&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">circle</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">circle</span> <span class="attr">cx</span>=<span class="string">&#x27;55&#x27;</span> <span class="attr">cy</span>=<span class="string">&#x27;80&#x27;</span> <span class="attr">r</span>=<span class="string">&#x27;5&#x27;</span> <span class="attr">stroke</span>=<span class="string">&#x27;black&#x27;</span> <span class="attr">fill</span>=<span class="string">&#x27;#3339933&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">circle</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">circle</span> <span class="attr">cx</span>=<span class="string">&#x27;85&#x27;</span> <span class="attr">cy</span>=<span class="string">&#x27;80&#x27;</span> <span class="attr">r</span>=<span class="string">&#x27;5&#x27;</span> <span class="attr">stroke</span>=<span class="string">&#x27;black&#x27;</span> <span class="attr">fill</span>=<span class="string">&#x27;#3339933&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">circle</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">g</span> <span class="attr">id</span>=<span class="string">&#x27;whiskers&#x27;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">line</span> <span class="attr">x1</span>=<span class="string">&#x27;75&#x27;</span> <span class="attr">y1</span>=<span class="string">&#x27;95&#x27;</span> <span class="attr">x2</span>=<span class="string">&#x27;135&#x27;</span> <span class="attr">y2</span>=<span class="string">&#x27;85&#x27;</span> <span class="attr">style</span>=<span class="string">&#x27;stroke:black&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">line</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">line</span> <span class="attr">x1</span>=<span class="string">&#x27;75&#x27;</span> <span class="attr">y1</span>=<span class="string">&#x27;95&#x27;</span> <span class="attr">x2</span>=<span class="string">&#x27;135&#x27;</span> <span class="attr">y2</span>=<span class="string">&#x27;105&#x27;</span> <span class="attr">style</span>=<span class="string">&#x27;stroke:black&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">line</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">g</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">use</span> <span class="attr">xlink:href</span>=<span class="string">&quot;#whiskers&quot;</span> <span class="attr">transform</span>=<span class="string">&#x27;scale(-1 1) translate(-140 0)&#x27;</span> &gt;</span><span class="tag">&lt;/<span class="name">use</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 耳朵 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">polyline</span> <span class="attr">points</span>=<span class="string">&#x27;108 62,90 10, 70 45, 50, 10, 32, 62&#x27;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">style</span>=<span class="string">&#x27;stroke:black; fill:none&#x27;</span> /&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 嘴 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">polyline</span> <span class="attr">points</span>=<span class="string">&#x27;35 110,45 120, 95 120, 105, 110&#x27;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">style</span>=<span class="string">&#x27;stroke:black; fill:none&#x27;</span>/&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 鼻子 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">path</span> <span class="attr">d</span>=<span class="string">&#x27;M 75 90 L 65 90 A 5 10 0 0 0 75 90&#x27;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">style</span>=<span class="string">&#x27;stroke:black; fill:#ffcccc&#x27;</span></span></span><br><span class="line"><span class="tag">  /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://user-gold-cdn.xitu.io/2019/12/10/16eed28ff8730118?imageView2/0/w/1280/h/960/format/webp/ignore-error/1"></p><p>由于这只是一个简单的图形，用户可能看不出这是一只猫，所以咱们可以使用 元素添加一些文本注释。在 元素中，<code>x</code> 和 <code>y</code> 属性用于指定文本的位置，如下所示：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&#x27;140&#x27;</span> <span class="attr">height</span>=<span class="string">&#x27;170&#x27;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns</span>=<span class="string">&#x27;http://wwww.w3.org/2000/svg&#x27;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:xlink</span>=<span class="string">&#x27;http://wwww.w3.org/1999/xlink&#x27;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Cat<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">desc</span>&gt;</span>Stick Figure of Cat<span class="tag">&lt;/<span class="name">desc</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">circle</span> <span class="attr">cx</span>=<span class="string">&#x27;70&#x27;</span> <span class="attr">cy</span>=<span class="string">&#x27;95&#x27;</span> <span class="attr">r</span>=<span class="string">&#x27;50&#x27;</span> <span class="attr">style</span>=<span class="string">&#x27;stroke:black; fill:none&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">circle</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">circle</span> <span class="attr">cx</span>=<span class="string">&#x27;55&#x27;</span> <span class="attr">cy</span>=<span class="string">&#x27;80&#x27;</span> <span class="attr">r</span>=<span class="string">&#x27;5&#x27;</span> <span class="attr">stroke</span>=<span class="string">&#x27;black&#x27;</span> <span class="attr">fill</span>=<span class="string">&#x27;#3339933&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">circle</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">circle</span> <span class="attr">cx</span>=<span class="string">&#x27;85&#x27;</span> <span class="attr">cy</span>=<span class="string">&#x27;80&#x27;</span> <span class="attr">r</span>=<span class="string">&#x27;5&#x27;</span> <span class="attr">stroke</span>=<span class="string">&#x27;black&#x27;</span> <span class="attr">fill</span>=<span class="string">&#x27;#3339933&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">circle</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">g</span> <span class="attr">id</span>=<span class="string">&#x27;whiskers&#x27;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">line</span> <span class="attr">x1</span>=<span class="string">&#x27;75&#x27;</span> <span class="attr">y1</span>=<span class="string">&#x27;95&#x27;</span> <span class="attr">x2</span>=<span class="string">&#x27;135&#x27;</span> <span class="attr">y2</span>=<span class="string">&#x27;85&#x27;</span> <span class="attr">style</span>=<span class="string">&#x27;stroke:black&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">line</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">line</span> <span class="attr">x1</span>=<span class="string">&#x27;75&#x27;</span> <span class="attr">y1</span>=<span class="string">&#x27;95&#x27;</span> <span class="attr">x2</span>=<span class="string">&#x27;135&#x27;</span> <span class="attr">y2</span>=<span class="string">&#x27;105&#x27;</span> <span class="attr">style</span>=<span class="string">&#x27;stroke:black&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">line</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">g</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">use</span> <span class="attr">xlink:href</span>=<span class="string">&quot;#whiskers&quot;</span> <span class="attr">transform</span>=<span class="string">&#x27;scale(-1 1) translate(-140 0)&#x27;</span> &gt;</span><span class="tag">&lt;/<span class="name">use</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 耳朵 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">polyline</span> <span class="attr">points</span>=<span class="string">&#x27;108 62,90 10, 70 45, 50, 10, 32, 62&#x27;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">style</span>=<span class="string">&#x27;stroke:black; fill:none&#x27;</span> /&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 嘴 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">polyline</span> <span class="attr">points</span>=<span class="string">&#x27;35 110,45 120, 95 120, 105, 110&#x27;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">style</span>=<span class="string">&#x27;stroke:black; fill:none&#x27;</span>/&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 鼻子 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">path</span> <span class="attr">d</span>=<span class="string">&#x27;M 75 90 L 65 90 A 5 10 0 0 0 75 90&#x27;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">style</span>=<span class="string">&#x27;stroke:black; fill:#ffcccc&#x27;</span></span></span><br><span class="line"><span class="tag">  /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">text</span> <span class="attr">x</span>=<span class="string">&quot;60&quot;</span> <span class="attr">y</span>=<span class="string">&quot;165&quot;</span> <span class="attr">style</span>=<span class="string">&#x27;font-family:sans-serif;font-size: 14pt;</span></span></span><br><span class="line"><span class="tag"><span class="string">    stroke:none; fill: black;</span></span></span><br><span class="line"><span class="tag"><span class="string">  &#x27;</span>&gt;</span>Cat<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://user-gold-cdn.xitu.io/2019/12/10/16eed291a099f5db?imageView2/0/w/1280/h/960/format/webp/ignore-error/1"></p><h2 id="SVG-使用"><a href="#SVG-使用" class="headerlink" title="SVG 使用"></a>SVG 使用</h2><p>SVG 是一种图像格式，因此可以使用与其他图像类型相同的方式包含在 HTML 页面中。具体可以采用两种方法：将图像包含在 <code>&lt;img&gt;</code> 元素内（当图像是页面的基本组成部分时，推荐这种方式）；或者将图像作为另一个元素的 CSS 样式属性插入(当图像主要用来装饰时，推荐这种方式)。</p><h3 id="在元素内引入-SVG"><a href="#在元素内引入-SVG" class="headerlink" title="在元素内引入 SVG"></a>在元素内引入 SVG</h3><p>在 <code>&lt;img&gt;</code> 元素内包含 SVG 图像非常简单，只需设置 <code>src</code> 指向 SVG 文件位置即可。如下:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;cat.svg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><h3 id="在标签内引入-SVG"><a href="#在标签内引入-SVG" class="headerlink" title="在标签内引入 SVG"></a>在标签内引入 SVG</h3><p>SVG 文件可通过以下标签嵌入 HTML 文档：<code>&lt;embed&gt;</code>、<code>&lt;object&gt;</code> 或者 <code>&lt;iframe&gt;</code>，如下所示：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">embed</span> <span class="attr">src</span>=<span class="string">&quot;cat.svg&quot;</span> <span class="attr">type</span>=<span class="string">&quot;image/svg+xml&quot;</span> <span class="attr">width</span>=<span class="string">&quot;100&quot;</span> <span class="attr">height</span>=<span class="string">&quot;100&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">object</span> <span class="attr">data</span>=<span class="string">&quot;cat.svg&quot;</span> <span class="attr">type</span>=<span class="string">&quot;image/svg+xml&quot;</span> <span class="attr">width</span>=<span class="string">&quot;100&quot;</span> <span class="attr">height</span>=<span class="string">&quot;100&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">object</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">&quot;cat.svg&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="在页面中引入-SVG"><a href="#在页面中引入-SVG" class="headerlink" title="在页面中引入 SVG"></a>在页面中引入 SVG</h3><p>大部分主流浏览器除了 Opera，都可以直接在 HTML 嵌入 SVG 代码，如下所示：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&#x27;140&#x27;</span> <span class="attr">heiight</span>=<span class="string">&#x27;170&#x27;</span> <span class="attr">xmlns</span>=<span class="string">&#x27;http://wwww.w3.org/2000/svg&#x27;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Cat<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">desc</span>&gt;</span>Stick Figure of Cat<span class="tag">&lt;/<span class="name">desc</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">circle</span> <span class="attr">cx</span>=<span class="string">&#x27;70&#x27;</span> <span class="attr">cy</span>=<span class="string">&#x27;95&#x27;</span> <span class="attr">r</span>=<span class="string">&#x27;50&#x27;</span> <span class="attr">style</span>=<span class="string">&#x27;stroke:black; fill:none&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">circle</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="SVG-元素"><a href="#SVG-元素" class="headerlink" title="SVG 元素"></a>SVG 元素</h2><h3 id="lt-line-gt"><a href="#lt-line-gt" class="headerlink" title="&lt;line&gt;"></a><code>&lt;line&gt;</code></h3><p>SVG 可以使用 元素画出一条直线，使用只需要指定线段的起 <code>(x1, y1)</code> 止 <code>(x2, y2)</code> 点。</p><p><img src="https://user-gold-cdn.xitu.io/2019/12/10/16eed29657c76845?imageView2/0/w/1280/h/960/format/webp/ignore-error/1"></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&#x27;140&#x27;</span> <span class="attr">height</span>=<span class="string">&#x27;170&#x27;</span> <span class="attr">xmlns</span>=<span class="string">&#x27;http://wwww.w3.org/2000/svg&#x27;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">line</span> <span class="attr">x1</span>=<span class="string">&#x27;0&#x27;</span> <span class="attr">y1</span>=<span class="string">&#x27;0&#x27;</span> <span class="attr">x2</span>=<span class="string">&#x27;100&#x27;</span> <span class="attr">y2</span>=<span class="string">&#x27;100&#x27;</span> <span class="attr">style</span>=<span class="string">&#x27;stroke:black&#x27;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="lt-rect-gt"><a href="#lt-rect-gt" class="headerlink" title="&lt;rect&gt;"></a><code>&lt;rect&gt;</code></h3><p><img src="https://user-gold-cdn.xitu.io/2019/12/10/16eed29f2e8b317f?imageView2/0/w/1280/h/960/format/webp/ignore-error/1"></p><p>矩形是最简单基本形状，只需要其左上角 <code>x</code> 和 <code>y</code> 坐标以及它的宽度和高度，如果想要指定圆角，可以指定 <code>rx</code>(x 方向的圆角半径)，该最大值是矩形宽度的一半，同理，<code>ry</code>(y 方向的圆角半径)，该最大值是矩形高度的一半。如果只指定了 <code>rx</code> 和 <code>ry</code> 中的一个值，则认为它们相等，矩形内部还可以使用 <code>fill</code> 属性来填充颜色，默认为黑色，用 <code>stroke</code> 来绘制边框，默认透明。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&#x27;300&#x27;</span> <span class="attr">height</span>=<span class="string">&#x27;500&#x27;</span> <span class="attr">xmlns</span>=<span class="string">&#x27;http://wwww.w3.org/2000/svg&#x27;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 内部填充为黑色，不绘制边框 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">rect</span> <span class="attr">x</span>=<span class="string">&#x27;10&#x27;</span> <span class="attr">y</span>=<span class="string">&#x27;10&#x27;</span> <span class="attr">width</span>=<span class="string">&#x27;30&#x27;</span> <span class="attr">height</span>=<span class="string">&#x27;50&#x27;</span>/&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 内部填充为蓝色，绘制较粗，半透明红色边框--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">rect</span> <span class="attr">x</span>=<span class="string">&#x27;50&#x27;</span> <span class="attr">y</span>=<span class="string">&#x27;10&#x27;</span> <span class="attr">width</span>=<span class="string">&#x27;30&#x27;</span> <span class="attr">height</span>=<span class="string">&#x27;50&#x27;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">style</span>=<span class="string">&#x27;fill: #0000ff;stroke: red;stroke-width: 7; stroke-opacity: .5&#x27;</span>/&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- rx 和 ry 相等，逐渐增大--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">rect</span> <span class="attr">x</span>=<span class="string">&#x27;10&#x27;</span> <span class="attr">y</span>=<span class="string">&#x27;70&#x27;</span> <span class="attr">rx</span>=<span class="string">&#x27;2&#x27;</span> <span class="attr">ry</span>=<span class="string">&#x27;2&#x27;</span> <span class="attr">width</span>=<span class="string">&#x27;20&#x27;</span> <span class="attr">height</span>=<span class="string">&#x27;40&#x27;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">style</span>=<span class="string">&#x27;stroke:black; fill:none&#x27;</span>/&gt;</span>ry5&#x27;</span><br><span class="line">  <span class="comment">&lt;!-- rx 和 ry 相等，逐渐增大--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">rect</span> <span class="attr">x</span>=<span class="string">&#x27;50&#x27;</span> <span class="attr">y</span>=<span class="string">&#x27;70&#x27;</span> <span class="attr">rx</span>=<span class="string">&#x27;5&#x27;</span>  <span class="attr">width</span>=<span class="string">&#x27;20&#x27;</span> <span class="attr">height</span>=<span class="string">&#x27;40&#x27;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">style</span>=<span class="string">&#x27;stroke:black; fill:none&#x27;</span> /&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- rx 和 ry 不相等 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">rect</span> <span class="attr">x</span>=<span class="string">&#x27;10&#x27;</span> <span class="attr">y</span>=<span class="string">&#x27;130&#x27;</span> <span class="attr">rx</span>=<span class="string">&#x27;10&#x27;</span> <span class="attr">ry</span>=<span class="string">&#x27;5&#x27;</span> <span class="attr">width</span>=<span class="string">&#x27;20&#x27;</span> <span class="attr">height</span>=<span class="string">&#x27;40&#x27;</span> <span class="attr">style</span>=<span class="string">&#x27;stroke:black; fill:none&#x27;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">rect</span> <span class="attr">x</span>=<span class="string">&#x27;50&#x27;</span> <span class="attr">y</span>=<span class="string">&#x27;130&#x27;</span> <span class="attr">rx</span>=<span class="string">&#x27;10&#x27;</span> <span class="attr">ry</span>=<span class="string">&#x27;5&#x27;</span> <span class="attr">width</span>=<span class="string">&#x27;10&#x27;</span> <span class="attr">height</span>=<span class="string">&#x27;40&#x27;</span> <span class="attr">style</span>=<span class="string">&#x27;stroke:black; fill:none&#x27;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="lt-circle-gt"><a href="#lt-circle-gt" class="headerlink" title="&lt;circle&gt;"></a><code>&lt;circle&gt;</code></h3><p><img src="https://user-gold-cdn.xitu.io/2019/12/10/16eed2a2d8a6dc87?imageView2/0/w/1280/h/960/format/webp/ignore-error/1"></p><p>画一个圆，需要使用 <code>&lt;circle&gt;</code> 元素，并指定圆心的 <code>x</code> 和 <code>y</code> 坐标以及半径和矩形一样，不指定 <code>fill</code> 和 <code>stroke</code> 时，圆会使用黑色填充并且没有轮廓线。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&#x27;300&#x27;</span> <span class="attr">height</span>=<span class="string">&#x27;500&#x27;</span> <span class="attr">xmlns</span>=<span class="string">&#x27;http://wwww.w3.org/2000/svg&#x27;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">circle</span> <span class="attr">cx</span>=<span class="string">&#x27;30&#x27;</span> <span class="attr">cy</span>=<span class="string">&#x27;30&#x27;</span> <span class="attr">r</span>=<span class="string">&#x27;20&#x27;</span> <span class="attr">style</span>=<span class="string">&#x27;stroke:black; fill:none&#x27;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">circle</span> <span class="attr">cx</span>=<span class="string">&#x27;80&#x27;</span> <span class="attr">cy</span>=<span class="string">&#x27;30&#x27;</span> <span class="attr">r</span>=<span class="string">&#x27;20&#x27;</span> <span class="attr">style</span>=<span class="string">&#x27;stroke-width:5;stroke:black; fill:none&#x27;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="lt-ellipse-gt"><a href="#lt-ellipse-gt" class="headerlink" title="&lt;ellipse&gt;"></a><code>&lt;ellipse&gt;</code></h3><p><img src="https://user-gold-cdn.xitu.io/2019/12/10/16eed2a428829678?imageView2/0/w/1280/h/960/format/webp/ignore-error/1"></p><p>对于椭圆来说，除了指定圆心和坐标外，还需要同时指定 <code>x</code> 方向的半径和 <code>y</code> 方向的半径，属性分为是 <code>rx</code> 和 <code>ry</code>。对于圆和椭圆来说，如果省略 <code>cx</code> 或者 <code>cy</code> ，则默认为 0，如果半径为 0，则不会显示图形，如果半径为负数，则会报错。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&#x27;300&#x27;</span> <span class="attr">height</span>=<span class="string">&#x27;500&#x27;</span> <span class="attr">xmlns</span>=<span class="string">&#x27;http://wwww.w3.org/2000/svg&#x27;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ellipse</span> <span class="attr">cx</span>=<span class="string">&#x27;30&#x27;</span> <span class="attr">cy</span>=<span class="string">&#x27;80&#x27;</span> <span class="attr">rx</span>=<span class="string">&#x27;10&#x27;</span> <span class="attr">ry</span>=<span class="string">&#x27;20&#x27;</span> <span class="attr">style</span>=<span class="string">&#x27;stroke:black; fill:none&#x27;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ellipse</span> <span class="attr">cx</span>=<span class="string">&#x27;80&#x27;</span> <span class="attr">cy</span>=<span class="string">&#x27;80&#x27;</span> <span class="attr">rx</span>=<span class="string">&#x27;20&#x27;</span> <span class="attr">ry</span>=<span class="string">&#x27;10&#x27;</span> <span class="attr">style</span>=<span class="string">&#x27;stroke:black; fill:none&#x27;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="lt-polygon-gt"><a href="#lt-polygon-gt" class="headerlink" title="&lt;polygon&gt;"></a><code>&lt;polygon&gt;</code></h3><p><img src="https://user-gold-cdn.xitu.io/2019/12/10/16eed2a6ec3d3c50?imageView2/0/w/1280/h/960/format/webp/ignore-error/1"></p><p>咱们可以使用 <code>&lt;polygon&gt;</code> 元素绘制多边形，使用 <code>points</code> 属性指定一系列的 <code>(x, y)</code> 坐标对，并用逗号或者空格分隔坐标个数必须是偶数。指定坐标不需要在最后指定返回起始坐标， <code>&lt;polygon&gt;</code> 元素会自动回到起始坐标。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&#x27;200&#x27;</span> <span class="attr">height</span>=<span class="string">&#x27;200&#x27;</span> <span class="attr">xmlns</span>=<span class="string">&#x27;http://wwww.w3.org/2000/svg&#x27;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--平等四边形--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">polygon</span> <span class="attr">points</span>=<span class="string">&#x27;15,10 55,10 45,20 5,20&#x27;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">style</span>=<span class="string">&#x27;fill:red; stroke: black;&#x27;</span></span></span><br><span class="line"><span class="tag">  /&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--五角星--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">polygon</span> <span class="attr">points</span>=<span class="string">&#x27;35,37.5 37.9,46.1 46.9,46.1 39.7,51.5</span></span></span><br><span class="line"><span class="tag"><span class="string">    42.3,60.1 35,55 27.7,60.1 30.3,51.5 23.1,46.1 32.1,46.1&#x27;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">style</span>=<span class="string">&#x27;fill: #ccffcc; stroke: green;&#x27;</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--不规则图形--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">polygon</span> <span class="attr">points</span>=<span class="string">&#x27;60 60, 65,72 80 60, 90,90 72,85 50,95&#x27;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">style</span>=<span class="string">&quot;fill: yellow; fill-opacity:.5; stroke:black&quot;</span></span></span><br><span class="line"><span class="tag">  /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><p>从上面很容易看出多边形都很容易填充，因为多边形的各边都没有交叉，很容易区分出多边形的内部区域和外部区域。但是，当多边形彼此交叉的时候，要区分哪些区域是图形内部并不容易。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&#x27;200&#x27;</span> <span class="attr">height</span>=<span class="string">&#x27;200&#x27;</span> <span class="attr">xmlns</span>=<span class="string">&#x27;http://wwww.w3.org/2000/svg&#x27;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">polygon</span> <span class="attr">points</span>=<span class="string">&#x27;48,16 16,96 96,48 0,48 80,96&#x27;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">style</span>=<span class="string">&#x27;fill:none; stroke: black;&#x27;</span></span></span><br><span class="line"><span class="tag">  /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><p>SVG 有两种判断某个点是否在多边形中的规则。分别对应 <code>fill-true</code> 属性的 <code>nonezero</code>（默认值）和 <code>evenodd</code>。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">style</span>=<span class="string">&quot;padding: 100px 0 0 200px&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&quot;200&quot;</span> <span class="attr">height</span>=<span class="string">&quot;200&quot;</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://wwww.w3.org/2000/svg&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">polygon</span> <span class="attr">points</span>=<span class="string">&quot;48,16 16,96 96,48 0,48 80,96&quot;</span> <span class="attr">style</span>=<span class="string">&quot;fill-rule: nonzero; fill:yellow; stroke: black;&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">polygon</span> <span class="attr">points</span>=<span class="string">&quot;148,16 116,96 196,48 100,48 180,96&quot;</span> <span class="attr">style</span>=<span class="string">&quot;fill-rule: evenodd; fill:red; stroke: black;&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="lt-polyline-gt"><a href="#lt-polyline-gt" class="headerlink" title="&lt;polyline&gt;"></a><code>&lt;polyline&gt;</code></h3><p><img src="https://user-gold-cdn.xitu.io/2019/12/10/16eed2accb6ed782?imageView2/0/w/1280/h/960/format/webp/ignore-error/1"></p><p><code>&lt;polyline&gt;</code> 元素与 有相同的属性，不同之处在于图形并不封闭：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&#x27;200&#x27;</span> <span class="attr">height</span>=<span class="string">&#x27;200&#x27;</span> <span class="attr">xmlns</span>=<span class="string">&#x27;http://wwww.w3.org/2000/svg&#x27;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">polyline</span> <span class="attr">points</span>=<span class="string">&quot;5,20 20,20 25,10 35,30 45,10</span></span></span><br><span class="line"><span class="tag"><span class="string">    55,30 65,10 74,30 80,20 95,20&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">style</span>=<span class="string">&quot;stroke:black; stroke-width:3; fill:none&quot;</span></span></span><br><span class="line"><span class="tag">  /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure></div><footer class="post-footer"><div class="post-eof"></div></footer></article><nav class="pagination"><span class="page-number current">1</span><a class="page-number" href="/blog-hexo/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/blog-hexo/page/7/">7</a><a class="extend next" rel="next" href="/blog-hexo/page/2/"><i class="fa fa-angle-right" aria-label="下一页"></i></a></nav></div><script>window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><div class="post-toc-wrap sidebar-panel"></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="阳明先生" src="/blog-hexo/images/avatar.png"><p class="site-author-name" itemprop="name">阳明先生</p><div class="site-description" itemprop="description">知之真切笃实处即是行 行之明觉精察处即是知</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/blog-hexo/archives/"><span class="site-state-item-count">63</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/blog-hexo/categories/"><span class="site-state-item-count">3</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/blog-hexo/tags/"><span class="site-state-item-count">25</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/NiRongFei" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;NiRongFei" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a></span></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2020</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">阳明先生</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-chart-area"></i> </span><span title="站点总字数">442k</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span title="站点阅读时长">6:42</span></div><div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动</div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-user"></i> </span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span> </span></span><span class="post-meta-divider">|</span> <span class="post-meta-item" id="busuanzi_container_site_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div></div></footer></div><script src="/blog-hexo/lib/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script><script src="/blog-hexo/lib/velocity/velocity.min.js"></script><script src="/blog-hexo/lib/velocity/velocity.ui.min.js"></script><script src="/blog-hexo/js/utils.js"></script><script src="/blog-hexo/js/motion.js"></script><script src="/blog-hexo/js/schemes/pisces.js"></script><script src="/blog-hexo/js/next-boot.js"></script><script async src="/js/typing.js"></script><script>POWERMODE.colorful=!0,POWERMODE.shake=!1,document.body.addEventListener("input",POWERMODE)</script></body></html>